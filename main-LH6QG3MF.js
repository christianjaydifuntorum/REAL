import{A as _0,B as Tn,C as gi,D as uh,E as ru,F as wy,G as v0,H as w0,I as oe,J as tn,K as gt,L as Ey,M as E0,N as iu,O as we,P as dn,Q as ch,R as Iy,S as bn,T as mi,U as go,V as dh,W as I0,X as $n,Y as Tt,a as $,b as pe,c as yy,d as x,e as u0,f as ih,g as c0,h as d0,i as L,j as Ns,k as oh,l as h0,m as f0,n as Et,o as sh,p as nu,q as _y,r as p0,s as or,t as vy,u as ah,v as g0,w as m0,x as lh,y as ut,z as y0}from"./chunk-TFNTWWHP.js";function by(n,e){return Object.is(n,e)}var mt=null,hh=!1,Sy=1,hn=Symbol("SIGNAL");function be(n){let e=mt;return mt=n,e}function C0(){return mt}var su={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function ph(n){if(hh)throw new Error("");if(mt===null)return;mt.consumerOnSignalRead(n);let e=mt.nextProducerIndex++;if(yh(mt),e<mt.producerNode.length&&mt.producerNode[e]!==n&&ou(mt)){let t=mt.producerNode[e];mh(t,mt.producerIndexOfThis[e])}mt.producerNode[e]!==n&&(mt.producerNode[e]=n,mt.producerIndexOfThis[e]=ou(mt)?b0(n,mt,e):0),mt.producerLastReadVersion[e]=n.version}function HV(){Sy++}function Ay(n){if(!(ou(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Sy)){if(!n.producerMustRecompute(n)&&!Ry(n)){Ty(n);return}n.producerRecomputeValue(n),Ty(n)}}function D0(n){if(n.liveConsumerNode===void 0)return;let e=hh;hh=!0;try{for(let t of n.liveConsumerNode)t.dirty||qV(t)}finally{hh=e}}function T0(){return mt?.consumerAllowSignalWrites!==!1}function qV(n){n.dirty=!0,D0(n),n.consumerMarkedDirty?.(n)}function Ty(n){n.dirty=!1,n.lastCleanEpoch=Sy}function gh(n){return n&&(n.nextProducerIndex=0),be(n)}function My(n,e){if(be(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(ou(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)mh(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Ry(n){yh(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(Ay(t),r!==t.version))return!0}return!1}function xy(n){if(yh(n),ou(n))for(let e=0;e<n.producerNode.length;e++)mh(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function b0(n,e,t){if(S0(n),n.liveConsumerNode.length===0&&A0(n))for(let r=0;r<n.producerNode.length;r++)n.producerIndexOfThis[r]=b0(n.producerNode[r],n,r);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function mh(n,e){if(S0(n),n.liveConsumerNode.length===1&&A0(n))for(let r=0;r<n.producerNode.length;r++)mh(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];yh(i),i.producerIndexOfThis[r]=e}}function ou(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function yh(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function S0(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function A0(n){return n.producerNode!==void 0}function M0(n){let e=Object.create(GV);e.computation=n;let t=()=>{if(Ay(e),ph(e),e.value===fh)throw e.error;return e.value};return t[hn]=e,t}var Cy=Symbol("UNSET"),Dy=Symbol("COMPUTING"),fh=Symbol("ERRORED"),GV=pe($({},su),{value:Cy,dirty:!0,error:null,equal:by,kind:"computed",producerMustRecompute(n){return n.value===Cy||n.value===Dy},producerRecomputeValue(n){if(n.value===Dy)throw new Error("Detected cycle in computations.");let e=n.value;n.value=Dy;let t=gh(n),r,i=!1;try{r=n.computation(),be(null),i=e!==Cy&&e!==fh&&r!==fh&&n.equal(e,r)}catch(o){r=fh,n.error=o}finally{My(n,t)}if(i){n.value=e;return}n.value=r,n.version++}});function zV(){throw new Error}var R0=zV;function x0(){R0()}function N0(n){R0=n}var WV=null;function P0(n){let e=Object.create(Ny);e.value=n;let t=()=>(ph(e),e.value);return t[hn]=e,t}function _h(n,e){T0()||x0(),n.equal(n.value,e)||(n.value=e,KV(n))}function k0(n,e){T0()||x0(),_h(n,e(n.value))}var Ny=pe($({},su),{equal:by,value:void 0,kind:"signal"});function KV(n){n.version++,HV(),D0(n),WV?.()}function se(n){return typeof n=="function"}function Ps(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var vh=Ps(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function mo(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var tt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(se(r))try{r()}catch(o){e=o instanceof vh?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{O0(o)}catch(s){e=e??[],s instanceof vh?e=[...e,...s.errors]:e.push(s)}}if(e)throw new vh(e)}}add(e){var t;if(e&&e!==this)if(this.closed)O0(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&mo(t,e)}remove(e){let{_finalizers:t}=this;t&&mo(t,e),e instanceof n&&e._removeParent(this)}};tt.EMPTY=(()=>{let n=new tt;return n.closed=!0,n})();var Py=tt.EMPTY;function wh(n){return n instanceof tt||n&&"closed"in n&&se(n.remove)&&se(n.add)&&se(n.unsubscribe)}function O0(n){se(n)?n():n.unsubscribe()}var Hn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var ks={setTimeout(n,e,...t){let{delegate:r}=ks;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=ks;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Eh(n){ks.setTimeout(()=>{let{onUnhandledError:e}=Hn;if(e)e(n);else throw n})}function yo(){}var F0=ky("C",void 0,void 0);function V0(n){return ky("E",void 0,n)}function L0(n){return ky("N",n,void 0)}function ky(n,e,t){return{kind:n,value:e,error:t}}var _o=null;function Os(n){if(Hn.useDeprecatedSynchronousErrorHandling){let e=!_o;if(e&&(_o={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=_o;if(_o=null,t)throw r}}else n()}function j0(n){Hn.useDeprecatedSynchronousErrorHandling&&_o&&(_o.errorThrown=!0,_o.error=n)}var vo=class extends tt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,wh(e)&&e.add(this)):this.destination=ZV}static create(e,t,r){return new kr(e,t,r)}next(e){this.isStopped?Fy(L0(e),this):this._next(e)}error(e){this.isStopped?Fy(V0(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Fy(F0,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},QV=Function.prototype.bind;function Oy(n,e){return QV.call(n,e)}var Vy=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Ih(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Ih(r)}else Ih(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Ih(t)}}},kr=class extends vo{constructor(e,t,r){super();let i;if(se(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&Hn.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Oy(e.next,o),error:e.error&&Oy(e.error,o),complete:e.complete&&Oy(e.complete,o)}):i=e}this.destination=new Vy(i)}};function Ih(n){Hn.useDeprecatedSynchronousErrorHandling?j0(n):Eh(n)}function YV(n){throw n}function Fy(n,e){let{onStoppedNotification:t}=Hn;t&&ks.setTimeout(()=>t(n,e))}var ZV={closed:!0,next:yo,error:YV,complete:yo};var Fs=typeof Symbol=="function"&&Symbol.observable||"@@observable";function bt(n){return n}function Ly(...n){return jy(n)}function jy(n){return n.length===0?bt:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var de=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=XV(t)?t:new kr(t,r,i);return Os(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=B0(r),new r((i,o)=>{let s=new kr({next:a=>{try{t(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Fs](){return this}pipe(...t){return jy(t)(this)}toPromise(t){return t=B0(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return n.create=e=>new n(e),n})();function B0(n){var e;return(e=n??Hn.Promise)!==null&&e!==void 0?e:Promise}function JV(n){return n&&se(n.next)&&se(n.error)&&se(n.complete)}function XV(n){return n&&n instanceof vo||JV(n)&&wh(n)}function By(n){return se(n?.lift)}function ue(n){return e=>{if(By(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ae(n,e,t,r,i){return new Uy(n,e,t,r,i)}var Uy=class extends vo{constructor(e,t,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=i?function(a){try{i(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Vs(){return ue((n,e)=>{let t=null;n._refCount++;let r=ae(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,o=t;t=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var Ls=class extends de{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,By(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new tt;let t=this.getSubject();e.add(this.source.subscribe(ae(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=tt.EMPTY)}return e}refCount(){return Vs()(this)}};var U0=Ps(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ze=(()=>{class n extends de{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new Ch(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new U0}next(t){Os(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Os(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Os(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?Py:(this.currentObservers=null,o.push(t),new tt(()=>{this.currentObservers=null,mo(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new de;return t.source=this,t}}return n.create=(e,t)=>new Ch(e,t),n})(),Ch=class extends ze{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Py}};var St=class extends ze{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var au={now(){return(au.delegate||Date).now()},delegate:void 0};var lu=class extends ze{constructor(e=1/0,t=1/0,r=au){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:s}=this;t||(r.push(e),!i&&r.push(o.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,o=i.slice();for(let s=0;s<o.length&&!e.closed;s+=r?1:2)e.next(o[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,o=(i?1:2)*e;if(e<1/0&&o<r.length&&r.splice(0,r.length-o),!i){let s=t.now(),a=0;for(let l=1;l<r.length&&r[l]<=s;l+=2)a=l;a&&r.splice(0,a+1)}}};var Dh=class extends tt{constructor(e,t){super()}schedule(e,t=0){return this}};var uu={setInterval(n,e,...t){let{delegate:r}=uu;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=uu;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var js=class extends Dh{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,r=0){return uu.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&uu.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,mo(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Bs=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};Bs.now=au.now;var Us=class extends Bs{constructor(e,t=Bs.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var wo=new Us(js);var Th=class extends js{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var bh=class extends Us{};var $y=new bh(Th);var qt=new de(n=>n.complete());function $0(n){return n&&se(n.schedule)}function Hy(n){return n[n.length-1]}function $s(n){return se(Hy(n))?n.pop():void 0}function sr(n){return $0(Hy(n))?n.pop():void 0}function H0(n,e){return typeof Hy(n)=="number"?n.pop():e}var Sh=n=>n&&typeof n.length=="number"&&typeof n!="function";function Ah(n){return se(n?.then)}function Mh(n){return se(n[Fs])}function Rh(n){return Symbol.asyncIterator&&se(n?.[Symbol.asyncIterator])}function xh(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function eL(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Nh=eL();function Ph(n){return se(n?.[Nh])}function kh(n){return c0(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield ih(t.read());if(i)return yield ih(void 0);yield yield ih(r)}}finally{t.releaseLock()}})}function Oh(n){return se(n?.getReader)}function je(n){if(n instanceof de)return n;if(n!=null){if(Mh(n))return tL(n);if(Sh(n))return nL(n);if(Ah(n))return rL(n);if(Rh(n))return q0(n);if(Ph(n))return iL(n);if(Oh(n))return oL(n)}throw xh(n)}function tL(n){return new de(e=>{let t=n[Fs]();if(se(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function nL(n){return new de(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function rL(n){return new de(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Eh)})}function iL(n){return new de(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function q0(n){return new de(e=>{sL(n,e).catch(t=>e.error(t))})}function oL(n){return q0(kh(n))}function sL(n,e){var t,r,i,o;return u0(this,void 0,void 0,function*(){try{for(t=d0(n);r=yield t.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})}function nn(n,e,t,r=0,i=!1){let o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function ar(n,e=0){return ue((t,r)=>{t.subscribe(ae(r,i=>nn(r,n,()=>r.next(i),e),()=>nn(r,n,()=>r.complete(),e),i=>nn(r,n,()=>r.error(i),e)))})}function Or(n,e=0){return ue((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function G0(n,e){return je(n).pipe(Or(e),ar(e))}function z0(n,e){return je(n).pipe(Or(e),ar(e))}function W0(n,e){return new de(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function K0(n,e){return new de(t=>{let r;return nn(t,e,()=>{r=n[Nh](),nn(t,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){t.error(s);return}o?t.complete():t.next(i)},0,!0)}),()=>se(r?.return)&&r.return()})}function Fh(n,e){if(!n)throw new Error("Iterable cannot be null");return new de(t=>{nn(t,e,()=>{let r=n[Symbol.asyncIterator]();nn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function Q0(n,e){return Fh(kh(n),e)}function Y0(n,e){if(n!=null){if(Mh(n))return G0(n,e);if(Sh(n))return W0(n,e);if(Ah(n))return z0(n,e);if(Rh(n))return Fh(n,e);if(Ph(n))return K0(n,e);if(Oh(n))return Q0(n,e)}throw xh(n)}function ke(n,e){return e?Y0(n,e):je(n)}function re(...n){let e=sr(n);return ke(n,e)}function Hs(n,e){let t=se(n)?n:()=>n,r=i=>i.error(t());return new de(e?i=>e.schedule(r,0,i):r)}function qy(n){return!!n&&(n instanceof de||se(n.lift)&&se(n.subscribe))}var Fr=Ps(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function J(n,e){return ue((t,r)=>{let i=0;t.subscribe(ae(r,o=>{r.next(n.call(e,o,i++))}))})}var{isArray:aL}=Array;function lL(n,e){return aL(e)?n(...e):n(e)}function Vh(n){return J(e=>lL(n,e))}var{isArray:uL}=Array,{getPrototypeOf:cL,prototype:dL,keys:hL}=Object;function Lh(n){if(n.length===1){let e=n[0];if(uL(e))return{args:e,keys:null};if(fL(e)){let t=hL(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function fL(n){return n&&typeof n=="object"&&cL(n)===dL}function jh(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Bh(...n){let e=sr(n),t=$s(n),{args:r,keys:i}=Lh(n);if(r.length===0)return ke([],e);let o=new de(pL(r,e,i?s=>jh(i,s):bt));return t?o.pipe(Vh(t)):o}function pL(n,e,t=bt){return r=>{Z0(e,()=>{let{length:i}=n,o=new Array(i),s=i,a=i;for(let l=0;l<i;l++)Z0(e,()=>{let c=ke(n[l],e),d=!1;c.subscribe(ae(r,h=>{o[l]=h,d||(d=!0,a--),a||r.next(t(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}function Z0(n,e,t){n?nn(t,n,e):e()}function J0(n,e,t,r,i,o,s,a){let l=[],c=0,d=0,h=!1,g=()=>{h&&!l.length&&!c&&e.complete()},m=D=>c<r?v(D):l.push(D),v=D=>{o&&e.next(D),c++;let S=!1;je(t(D,d++)).subscribe(ae(e,P=>{i?.(P),o?m(P):e.next(P)},()=>{S=!0},void 0,()=>{if(S)try{for(c--;l.length&&c<r;){let P=l.shift();s?nn(e,s,()=>v(P)):v(P)}g()}catch(P){e.error(P)}}))};return n.subscribe(ae(e,m,()=>{h=!0,g()})),()=>{a?.()}}function yt(n,e,t=1/0){return se(e)?yt((r,i)=>J((o,s)=>e(r,o,i,s))(je(n(r,i))),t):(typeof e=="number"&&(t=e),ue((r,i)=>J0(r,i,n,t)))}function cu(n=1/0){return yt(bt,n)}function X0(){return cu(1)}function qs(...n){return X0()(ke(n,sr(n)))}function Uh(n){return new de(e=>{je(n()).subscribe(e)})}function Gy(...n){let e=$s(n),{args:t,keys:r}=Lh(n),i=new de(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),l=s,c=s;for(let d=0;d<s;d++){let h=!1;je(t[d]).subscribe(ae(o,g=>{h||(h=!0,c--),a[d]=g},()=>l--,void 0,()=>{(!l||!h)&&(c||o.next(r?jh(r,a):a),o.complete())}))}});return e?i.pipe(Vh(e)):i}function Gs(...n){let e=sr(n),t=H0(n,1/0),r=n;return r.length?r.length===1?je(r[0]):cu(t)(ke(r,e)):qt}function Vt(n,e){return ue((t,r)=>{let i=0;t.subscribe(ae(r,o=>n.call(e,o,i++)&&r.next(o)))})}function yi(n){return ue((e,t)=>{let r=null,i=!1,o;r=e.subscribe(ae(t,void 0,void 0,s=>{o=je(n(s,yi(n)(e))),r?(r.unsubscribe(),r=null,o.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(t))})}function eS(n,e,t,r,i){return(o,s)=>{let a=t,l=e,c=0;o.subscribe(ae(s,d=>{let h=c++;l=a?n(l,d,h):(a=!0,d),r&&s.next(l)},i&&(()=>{a&&s.next(l),s.complete()})))}}function zs(n,e){return se(e)?yt(n,e,1):yt(n,1)}function _i(n){return ue((e,t)=>{let r=!1;e.subscribe(ae(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Vr(n){return n<=0?()=>qt:ue((e,t)=>{let r=0;e.subscribe(ae(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function du(n,e=bt){return n=n??gL,ue((t,r)=>{let i,o=!0;t.subscribe(ae(r,s=>{let a=e(s);(o||!n(i,a))&&(o=!1,i=a,r.next(s))}))})}function gL(n,e){return n===e}function $h(n=mL){return ue((e,t)=>{let r=!1;e.subscribe(ae(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function mL(){return new Fr}function hu(n){return ue((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function qn(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Vt((i,o)=>n(i,o,r)):bt,Vr(1),t?_i(e):$h(()=>new Fr))}function Ws(n){return n<=0?()=>qt:ue((e,t)=>{let r=[];e.subscribe(ae(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function zy(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Vt((i,o)=>n(i,o,r)):bt,Ws(1),t?_i(e):$h(()=>new Fr))}function fu(){return ue((n,e)=>{let t,r=!1;n.subscribe(ae(e,i=>{let o=t;t=i,r&&e.next([o,i]),r=!0}))})}function lr(n,e){return ue(eS(n,e,arguments.length>=2,!0))}function pu(n={}){let{connector:e=()=>new ze,resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return o=>{let s,a,l,c=0,d=!1,h=!1,g=()=>{a?.unsubscribe(),a=void 0},m=()=>{g(),s=l=void 0,d=h=!1},v=()=>{let D=s;m(),D?.unsubscribe()};return ue((D,S)=>{c++,!h&&!d&&g();let P=l=l??e();S.add(()=>{c--,c===0&&!h&&!d&&(a=Wy(v,i))}),P.subscribe(S),!s&&c>0&&(s=new kr({next:j=>P.next(j),error:j=>{h=!0,g(),a=Wy(m,t,j),P.error(j)},complete:()=>{d=!0,g(),a=Wy(m,r),P.complete()}}),je(D).subscribe(s))})(o)}}function Wy(n,e,...t){if(e===!0){n();return}if(e===!1)return;let r=new kr({next:()=>{r.unsubscribe(),n()}});return je(e(...t)).subscribe(r)}function Hh(n,e,t){let r,i=!1;return n&&typeof n=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n:r=n??1/0,pu({connector:()=>new lu(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function Ky(n){return ue((e,t)=>{let r=!1,i=0;e.subscribe(ae(t,o=>(r||(r=!n(o,i++)))&&t.next(o)))})}function Eo(...n){let e=sr(n);return ue((t,r)=>{(e?qs(n,t,e):qs(n,t)).subscribe(r)})}function Ye(n,e){return ue((t,r)=>{let i=null,o=0,s=!1,a=()=>s&&!i&&r.complete();t.subscribe(ae(r,l=>{i?.unsubscribe();let c=0,d=o++;je(n(l,d)).subscribe(i=ae(r,h=>r.next(e?e(l,h,d,c++):h),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function qh(n,e){return se(e)?Ye(()=>n,e):Ye(()=>n)}function Qy(n){return ue((e,t)=>{je(n).subscribe(ae(t,()=>t.complete(),yo)),!t.closed&&e.subscribe(t)})}function At(n,e,t){let r=se(n)||e||t?{next:n,error:e,complete:t}:n;return r?ue((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(ae(o,l=>{var c;(c=r.next)===null||c===void 0||c.call(r,l),o.next(l)},()=>{var l;a=!1,(l=r.complete)===null||l===void 0||l.call(r),o.complete()},l=>{var c;a=!1,(c=r.error)===null||c===void 0||c.call(r,l),o.error(l)},()=>{var l,c;a&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):bt}function Yy(...n){let e=$s(n);return ue((t,r)=>{let i=n.length,o=new Array(i),s=n.map(()=>!1),a=!1;for(let l=0;l<i;l++)je(n[l]).subscribe(ae(r,c=>{o[l]=c,!a&&!s[l]&&(s[l]=!0,(a=s.every(bt))&&(s=null))},yo));t.subscribe(ae(r,l=>{if(a){let c=[l,...o];r.next(e?e(...c):c)}}))})}var yL="https://g.co/ng/security#xss",ne=class extends Error{code;constructor(e,t){super(ev(e,t)),this.code=e}};function ev(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}var US=Symbol("InputSignalNode#UNSET"),_L=pe($({},Ny),{transformFn:void 0,applyValueToInputSignal(n,e){_h(n,e)}});function $S(n,e){let t=Object.create(_L);t.value=n,t.transformFn=e?.transform;function r(){if(ph(t),t.value===US)throw new ne(-950,!1);return t.value}return r[hn]=t,r}function bu(n){return{toString:n}.toString()}var Gh="__parameters__";function vL(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function HS(n,e,t){return bu(()=>{let r=vL(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;let s=new i(...o);return a.annotation=s,a;function a(l,c,d){let h=l.hasOwnProperty(Gh)?l[Gh]:Object.defineProperty(l,Gh,{value:[]})[Gh];for(;h.length<=d;)h.push(null);return(h[d]=h[d]||[]).push(s),l}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var mu=globalThis;function Be(n){for(let e in n)if(n[e]===Be)return e;throw Error("Could not find renamed property on target object.")}function wL(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function zt(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(zt).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function tS(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var EL=Be({__forward_ref__:Be});function Br(n){return n.__forward_ref__=Br,n.toString=function(){return zt(this())},n}function Gt(n){return qS(n)?n():n}function qS(n){return typeof n=="function"&&n.hasOwnProperty(EL)&&n.__forward_ref__===Br}function te(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function gn(n){return{providers:n.providers||[],imports:n.imports||[]}}function Df(n){return nS(n,zS)||nS(n,WS)}function GS(n){return Df(n)!==null}function nS(n,e){return n.hasOwnProperty(e)?n[e]:null}function IL(n){let e=n&&(n[zS]||n[WS]);return e||null}function rS(n){return n&&(n.hasOwnProperty(iS)||n.hasOwnProperty(CL))?n[iS]:null}var zS=Be({\u0275prov:Be}),iS=Be({\u0275inj:Be}),WS=Be({ngInjectableDef:Be}),CL=Be({ngInjectorDef:Be}),Q=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=te({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function KS(n){return n&&!!n.\u0275providers}var DL=Be({\u0275cmp:Be}),TL=Be({\u0275dir:Be}),bL=Be({\u0275pipe:Be}),SL=Be({\u0275mod:Be}),Xh=Be({\u0275fac:Be}),vu=Be({__NG_ELEMENT_ID__:Be}),oS=Be({__NG_ENV_ID__:Be});function tv(n){return typeof n=="string"?n:n==null?"":String(n)}function AL(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():tv(n)}function ML(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new ne(-200,n)}function nv(n,e){throw new ne(-201,!1)}var me=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(me||{}),c_;function QS(){return c_}function rn(n){let e=c_;return c_=n,e}function YS(n,e,t){let r=Df(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&me.Optional)return null;if(e!==void 0)return e;nv(n,"Injector")}var RL={},wu=RL,d_="__NG_DI_FLAG__",ef="ngTempTokenPath",xL="ngTokenPath",NL=/\n/gm,PL="\u0275",sS="__source",Zs;function kL(){return Zs}function vi(n){let e=Zs;return Zs=n,e}function OL(n,e=me.Default){if(Zs===void 0)throw new ne(-203,!1);return Zs===null?YS(n,void 0,e):Zs.get(n,e&me.Optional?null:void 0,e)}function B(n,e=me.Default){return(QS()||OL)(Gt(n),e)}function V(n,e=me.Default){return B(n,Tf(e))}function Tf(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function h_(n){let e=[];for(let t=0;t<n.length;t++){let r=Gt(n[t]);if(Array.isArray(r)){if(r.length===0)throw new ne(900,!1);let i,o=me.Default;for(let s=0;s<r.length;s++){let a=r[s],l=FL(a);typeof l=="number"?l===-1?i=a.token:o|=l:i=a}e.push(B(i,o))}else e.push(B(r))}return e}function ZS(n,e){return n[d_]=e,n.prototype[d_]=e,n}function FL(n){return n[d_]}function VL(n,e,t,r){let i=n[ef];throw e[sS]&&i.unshift(e[sS]),n.message=LL(`
`+n.message,i,t,r),n[xL]=i,n[ef]=null,n}function LL(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==PL?n.slice(2):n;let i=zt(e);if(Array.isArray(e))i=e.map(zt).join(" -> ");else if(typeof e=="object"){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+(typeof a=="string"?JSON.stringify(a):zt(a)))}i=`{${o.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(NL,`
  `)}`}var bf=ZS(HS("Optional"),8);var jL=ZS(HS("SkipSelf"),4);function Do(n,e){let t=n.hasOwnProperty(Xh);return t?n[Xh]:null}function rv(n,e){n.forEach(t=>Array.isArray(t)?rv(t,e):e(t))}function JS(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function tf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function BL(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let o=i-2;n[i]=n[o],i--}n[e]=t,n[e+1]=r}}function UL(n,e,t){let r=Su(n,e);return r>=0?n[r|1]=t:(r=~r,BL(n,r,e,t)),r}function Zy(n,e){let t=Su(n,e);if(t>=0)return n[t|1]}function Su(n,e){return $L(n,e,1)}function $L(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let o=r+(i-r>>1),s=n[o<<t];if(e===s)return o<<t;s>e?i=o:r=o+1}return~(i<<t)}var Xs={},Sn=[],ea=new Q(""),XS=new Q("",-1),eA=new Q(""),nf=class{get(e,t=wu){if(t===wu){let r=new Error(`NullInjectorError: No provider for ${zt(e)}!`);throw r.name="NullInjectorError",r}return t}};function tA(n,e){let t=n[SL]||null;if(!t&&e===!0)throw new Error(`Type ${zt(n)} does not have '\u0275mod' property.`);return t}function To(n){return n[DL]||null}function nA(n){return n[TL]||null}function rA(n){return n[bL]||null}function iA(n){let e=To(n)||nA(n)||rA(n);return e!==null&&e.standalone}function iv(n){return{\u0275providers:n}}function ov(...n){return{\u0275providers:oA(!0,n),\u0275fromNgModule:!0}}function oA(n,...e){let t=[],r=new Set,i,o=s=>{t.push(s)};return rv(e,s=>{let a=s;f_(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&sA(i,o),t}function sA(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];sv(i,o=>{e(o,r)})}}function f_(n,e,t,r){if(n=Gt(n),!n)return!1;let i=null,o=rS(n),s=!o&&To(n);if(!o&&!s){let l=n.ngModule;if(o=rS(l),o)i=l;else return!1}else{if(s&&!s.standalone)return!1;i=n}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let l=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let c of l)f_(c,e,t,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let c;try{rv(o.imports,d=>{f_(d,e,t,r)&&(c||=[],c.push(d))})}finally{}c!==void 0&&sA(c,e)}if(!a){let c=Do(i)||(()=>new i);e({provide:i,useFactory:c,deps:Sn},i),e({provide:eA,useValue:i,multi:!0},i),e({provide:ea,useValue:()=>B(i),multi:!0},i)}let l=o.providers;if(l!=null&&!a){let c=n;sv(l,d=>{e(d,c)})}}else return!1;return i!==n&&n.providers!==void 0}function sv(n,e){for(let t of n)KS(t)&&(t=t.\u0275providers),Array.isArray(t)?sv(t,e):e(t)}var HL=Be({provide:String,useValue:Be});function aA(n){return n!==null&&typeof n=="object"&&HL in n}function qL(n){return!!(n&&n.useExisting)}function GL(n){return!!(n&&n.useFactory)}function ta(n){return typeof n=="function"}function zL(n){return!!n.useClass}var Sf=new Q(""),Kh={},WL={},Jy;function av(){return Jy===void 0&&(Jy=new nf),Jy}var it=class{},Eu=class extends it{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,g_(e,s=>this.processProvider(s)),this.records.set(XS,Ks(void 0,this)),i.has("environment")&&this.records.set(it,Ks(void 0,this));let o=this.records.get(Sf);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(eA,Sn,me.Self))}destroy(){yu(this),this._destroyed=!0;let e=be(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),be(e)}}onDestroy(e){return yu(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){yu(this);let t=vi(this),r=rn(void 0),i;try{return e()}finally{vi(t),rn(r)}}get(e,t=wu,r=me.Default){if(yu(this),e.hasOwnProperty(oS))return e[oS](this);r=Tf(r);let i,o=vi(this),s=rn(void 0);try{if(!(r&me.SkipSelf)){let l=this.records.get(e);if(l===void 0){let c=JL(e)&&Df(e);c&&this.injectableDefInScope(c)?l=Ks(p_(e),Kh):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l)}let a=r&me.Self?av():this.parent;return t=r&me.Optional&&t===wu?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[ef]=a[ef]||[]).unshift(zt(e)),o)throw a;return VL(a,e,"R3InjectorError",this.source)}else throw a}finally{rn(s),vi(o)}}resolveInjectorInitializers(){let e=be(null),t=vi(this),r=rn(void 0),i;try{let o=this.get(ea,Sn,me.Self);for(let s of o)s()}finally{vi(t),rn(r),be(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(zt(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=Gt(e);let t=ta(e)?e:Gt(e&&e.provide),r=QL(e);if(!ta(e)&&e.multi===!0){let i=this.records.get(t);i||(i=Ks(void 0,Kh,!0),i.factory=()=>h_(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=be(null);try{return t.value===Kh&&(t.value=WL,t.value=t.factory()),typeof t.value=="object"&&t.value&&ZL(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{be(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Gt(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function p_(n){let e=Df(n),t=e!==null?e.factory:Do(n);if(t!==null)return t;if(n instanceof Q)throw new ne(204,!1);if(n instanceof Function)return KL(n);throw new ne(204,!1)}function KL(n){if(n.length>0)throw new ne(204,!1);let t=IL(n);return t!==null?()=>t.factory(n):()=>new n}function QL(n){if(aA(n))return Ks(void 0,n.useValue);{let e=lA(n);return Ks(e,Kh)}}function lA(n,e,t){let r;if(ta(n)){let i=Gt(n);return Do(i)||p_(i)}else if(aA(n))r=()=>Gt(n.useValue);else if(GL(n))r=()=>n.useFactory(...h_(n.deps||[]));else if(qL(n))r=()=>B(Gt(n.useExisting));else{let i=Gt(n&&(n.useClass||n.provide));if(YL(n))r=()=>new i(...h_(n.deps));else return Do(i)||p_(i)}return r}function yu(n){if(n.destroyed)throw new ne(205,!1)}function Ks(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function YL(n){return!!n.deps}function ZL(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function JL(n){return typeof n=="function"||typeof n=="object"&&n instanceof Q}function g_(n,e){for(let t of n)Array.isArray(t)?g_(t,e):t&&KS(t)?g_(t.\u0275providers,e):e(t)}function Rn(n,e){n instanceof Eu&&yu(n);let t,r=vi(n),i=rn(void 0);try{return e()}finally{vi(r),rn(i)}}function uA(){return QS()!==void 0||kL()!=null}function cA(n){if(!uA())throw new ne(-203,!1)}function XL(n){return typeof n=="function"}var Ur=0,Ee=1,ce=2,Wt=3,zn=4,Kn=5,rf=6,of=7,cr=8,na=9,Ii=10,ct=11,Iu=12,aS=13,da=14,dr=15,ra=16,Qs=17,ia=18,Af=19,dA=20,wi=21,Xy=22,sf=23,fn=24,Wn=25,hA=1;var bo=7,af=8,lf=9,Mn=10;function Ei(n){return Array.isArray(n)&&typeof n[hA]=="object"}function $r(n){return Array.isArray(n)&&n[hA]===!0}function fA(n){return(n.flags&4)!==0}function Mf(n){return n.componentOffset>-1}function lv(n){return(n.flags&1)===1}function Ci(n){return!!n.template}function m_(n){return(n[ce]&512)!==0}function Au(n){return(n[ce]&256)===256}var y_=class{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function pA(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}var ha=(()=>{let n=()=>gA;return n.ngInherit=!0,n})();function gA(n){return n.type.prototype.ngOnChanges&&(n.setInput=tj),ej}function ej(){let n=yA(this),e=n?.current;if(e){let t=n.previous;if(t===Xs)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function tj(n,e,t,r,i){let o=this.declaredInputs[r],s=yA(n)||nj(n,{previous:Xs,current:null}),a=s.current||(s.current={}),l=s.previous,c=l[o];a[o]=new y_(c&&c.currentValue,t,l===Xs),pA(n,e,i,t)}var mA="__ngSimpleChanges__";function yA(n){return n[mA]||null}function nj(n,e){return n[mA]=e}var lS=null;var An=function(n,e,t){lS?.(n,e,t)},rj="svg",ij="math";function hr(n){for(;Array.isArray(n);)n=n[Ur];return n}function _A(n,e){return hr(e[n])}function xn(n,e){return hr(e[n.index])}function vA(n,e){return n.data[e]}function oj(n,e){return n[e]}function Ai(n,e){let t=e[n];return Ei(t)?t:t[Ur]}function uv(n){return(n[ce]&128)===128}function sj(n){return $r(n[Wt])}function uf(n,e){return e==null?null:n[e]}function wA(n){n[Qs]=0}function cv(n){n[ce]&1024||(n[ce]|=1024,uv(n)&&xf(n))}function aj(n,e){for(;n>0;)e=e[da],n--;return e}function Rf(n){return!!(n[ce]&9216||n[fn]?.dirty)}function __(n){n[Ii].changeDetectionScheduler?.notify(9),n[ce]&64&&(n[ce]|=1024),Rf(n)&&xf(n)}function xf(n){n[Ii].changeDetectionScheduler?.notify(0);let e=So(n);for(;e!==null&&!(e[ce]&8192||(e[ce]|=8192,!uv(e)));)e=So(e)}function EA(n,e){if(Au(n))throw new ne(911,!1);n[wi]===null&&(n[wi]=[]),n[wi].push(e)}function lj(n,e){if(n[wi]===null)return;let t=n[wi].indexOf(e);t!==-1&&n[wi].splice(t,1)}function So(n){let e=n[Wt];return $r(e)?e[Wt]:e}function uj(n){return n[of]??=[]}function cj(n){return n.cleanup??=[]}var Ce={lFrame:MA(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var v_=!1;function dj(){return Ce.lFrame.elementDepthCount}function hj(){Ce.lFrame.elementDepthCount++}function fj(){Ce.lFrame.elementDepthCount--}function IA(){return Ce.bindingsEnabled}function pj(){return Ce.skipHydrationRootTNode!==null}function gj(n){return Ce.skipHydrationRootTNode===n}function mj(){Ce.skipHydrationRootTNode=null}function $e(){return Ce.lFrame.lView}function Kt(){return Ce.lFrame.tView}function on(){let n=CA();for(;n!==null&&n.type===64;)n=n.parent;return n}function CA(){return Ce.lFrame.currentTNode}function yj(){let n=Ce.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Mu(n,e){let t=Ce.lFrame;t.currentTNode=n,t.isParent=e}function DA(){return Ce.lFrame.isParent}function _j(){Ce.lFrame.isParent=!1}function TA(){return v_}function uS(n){let e=v_;return v_=n,e}function vj(){let n=Ce.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function wj(n){return Ce.lFrame.bindingIndex=n}function Nf(){return Ce.lFrame.bindingIndex++}function Ej(n){let e=Ce.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function Ij(){return Ce.lFrame.inI18n}function Cj(n,e){let t=Ce.lFrame;t.bindingIndex=t.bindingRootIndex=n,w_(e)}function Dj(){return Ce.lFrame.currentDirectiveIndex}function w_(n){Ce.lFrame.currentDirectiveIndex=n}function Tj(n){let e=Ce.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function bA(n){Ce.lFrame.currentQueryIndex=n}function bj(n){let e=n[Ee];return e.type===2?e.declTNode:e.type===1?n[Kn]:null}function SA(n,e,t){if(t&me.SkipSelf){let i=e,o=n;for(;i=i.parent,i===null&&!(t&me.Host);)if(i=bj(o),i===null||(o=o[da],i.type&10))break;if(i===null)return!1;e=i,n=o}let r=Ce.lFrame=AA();return r.currentTNode=e,r.lView=n,!0}function dv(n){let e=AA(),t=n[Ee];Ce.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function AA(){let n=Ce.lFrame,e=n===null?null:n.child;return e===null?MA(n):e}function MA(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function RA(){let n=Ce.lFrame;return Ce.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var xA=RA;function hv(){let n=RA();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Sj(n){return(Ce.lFrame.contextLView=aj(n,Ce.lFrame.contextLView))[cr]}function fa(){return Ce.lFrame.selectedIndex}function Ao(n){Ce.lFrame.selectedIndex=n}function Pf(){let n=Ce.lFrame;return vA(n.tView,n.selectedIndex)}function Aj(){return Ce.lFrame.currentNamespace}var NA=!0;function fv(){return NA}function pv(n){NA=n}function Mj(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=gA(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}i&&(t.preOrderHooks??=[]).push(0-n,i),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function gv(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:d}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),c&&((n.viewHooks??=[]).push(t,c),(n.viewCheckHooks??=[]).push(t,c)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function Qh(n,e,t){PA(n,e,3,t)}function Yh(n,e,t,r){(n[ce]&3)===t&&PA(n,e,t,r)}function e_(n,e){let t=n[ce];(t&3)===e&&(t&=16383,t+=1,n[ce]=t)}function PA(n,e,t,r){let i=r!==void 0?n[Qs]&65535:0,o=r??-1,s=e.length-1,a=0;for(let l=i;l<s;l++)if(typeof e[l+1]=="number"){if(a=e[l],r!=null&&a>=r)break}else e[l]<0&&(n[Qs]+=65536),(a<o||o==-1)&&(Rj(n,t,e,l),n[Qs]=(n[Qs]&4294901760)+l+2),l++}function cS(n,e){An(4,n,e);let t=be(null);try{e.call(n)}finally{be(t),An(5,n,e)}}function Rj(n,e,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],a=n[s];i?n[ce]>>14<n[Qs]>>16&&(n[ce]&3)===e&&(n[ce]+=16384,cS(a,o)):cS(a,o)}var Js=-1,Mo=class{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r){this.factory=e,this.canSeeViewProviders=t,this.injectImpl=r}};function xj(n){return n instanceof Mo}function Nj(n){return(n.flags&8)!==0}function Pj(n){return(n.flags&16)!==0}function kj(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],a=t[r++];n.setAttribute(e,s,a,o)}else{let o=i,s=t[++r];Fj(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),r++}}return r}function Oj(n){return n===3||n===4||n===6}function Fj(n){return n.charCodeAt(0)===64}function oa(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?dS(n,t,i,null,e[++r]):dS(n,t,i,null,null))}}return n}function dS(n,e,t,r,i){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[o+1]=i);return}else if(r===n[o+1]){n[o+2]=i;return}}o++,r!==null&&o++,i!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r),i!==null&&n.splice(o++,0,i)}var t_={},E_=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=Tf(r);let i=this.injector.get(e,t_,r);return i!==t_||t===t_?i:this.parentInjector.get(e,t,r)}};function kA(n){return n!==Js}function cf(n){return n&32767}function Vj(n){return n>>16}function df(n,e){let t=Vj(n),r=e;for(;t>0;)r=r[da],t--;return r}var I_=!0;function hf(n){let e=I_;return I_=n,e}var Lj=256,OA=Lj-1,FA=5,jj=0,ur={};function Bj(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(vu)&&(r=t[vu]),r==null&&(r=t[vu]=jj++);let i=r&OA,o=1<<i;e.data[n+(i>>FA)]|=o}function ff(n,e){let t=VA(n,e);if(t!==-1)return t;let r=e[Ee];r.firstCreatePass&&(n.injectorIndex=e.length,n_(r.data,n),n_(e,null),n_(r.blueprint,null));let i=mv(n,e),o=n.injectorIndex;if(kA(i)){let s=cf(i),a=df(i,e),l=a[Ee].data;for(let c=0;c<8;c++)e[o+c]=a[s+c]|l[s+c]}return e[o+8]=i,o}function n_(n,e){n.push(0,0,0,0,0,0,0,0,e)}function VA(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function mv(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=$A(i),r===null)return Js;if(t++,i=i[da],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Js}function C_(n,e,t){Bj(n,e,t)}function LA(n,e,t){if(t&me.Optional||n!==void 0)return n;nv(e,"NodeInjector")}function jA(n,e,t,r){if(t&me.Optional&&r===void 0&&(r=null),!(t&(me.Self|me.Host))){let i=n[na],o=rn(void 0);try{return i?i.get(e,r,t&me.Optional):YS(e,r,t&me.Optional)}finally{rn(o)}}return LA(r,e,t)}function BA(n,e,t,r=me.Default,i){if(n!==null){if(e[ce]&2048&&!(r&me.Self)){let s=Gj(n,e,t,r,ur);if(s!==ur)return s}let o=UA(n,e,t,r,ur);if(o!==ur)return o}return jA(e,t,r,i)}function UA(n,e,t,r,i){let o=Hj(t);if(typeof o=="function"){if(!SA(e,n,r))return r&me.Host?LA(i,t,r):jA(e,t,r,i);try{let s;if(s=o(r),s==null&&!(r&me.Optional))nv(t);else return s}finally{xA()}}else if(typeof o=="number"){let s=null,a=VA(n,e),l=Js,c=r&me.Host?e[dr][Kn]:null;for((a===-1||r&me.SkipSelf)&&(l=a===-1?mv(n,e):e[a+8],l===Js||!fS(r,!1)?a=-1:(s=e[Ee],a=cf(l),e=df(l,e)));a!==-1;){let d=e[Ee];if(hS(o,a,d.data)){let h=Uj(a,e,t,s,r,c);if(h!==ur)return h}l=e[a+8],l!==Js&&fS(r,e[Ee].data[a+8]===c)&&hS(o,a,e)?(s=d,a=cf(l),e=df(l,e)):a=-1}}return i}function Uj(n,e,t,r,i,o){let s=e[Ee],a=s.data[n+8],l=r==null?Mf(a)&&I_:r!=s&&(a.type&3)!==0,c=i&me.Host&&o===a,d=$j(a,s,t,l,c);return d!==null?sa(e,s,d,a):ur}function $j(n,e,t,r,i){let o=n.providerIndexes,s=e.data,a=o&1048575,l=n.directiveStart,c=n.directiveEnd,d=o>>20,h=r?a:a+d,g=i?a+d:c;for(let m=h;m<g;m++){let v=s[m];if(m<l&&t===v||m>=l&&v.type===t)return m}if(i){let m=s[l];if(m&&Ci(m)&&m.type===t)return l}return null}function sa(n,e,t,r){let i=n[t],o=e.data;if(xj(i)){let s=i;s.resolving&&ML(AL(o[t]));let a=hf(s.canSeeViewProviders);s.resolving=!0;let l,c=s.injectImpl?rn(s.injectImpl):null,d=SA(n,r,me.Default);try{i=n[t]=s.factory(void 0,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&Mj(t,o[t],e)}finally{c!==null&&rn(c),hf(a),s.resolving=!1,xA()}}return i}function Hj(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(vu)?n[vu]:void 0;return typeof e=="number"?e>=0?e&OA:qj:e}function hS(n,e,t){let r=1<<n;return!!(t[e+(n>>FA)]&r)}function fS(n,e){return!(n&me.Self)&&!(n&me.Host&&e)}var Co=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return BA(this._tNode,this._lView,e,Tf(r),t)}};function qj(){return new Co(on(),$e())}function Hr(n){return bu(()=>{let e=n.prototype.constructor,t=e[Xh]||D_(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let o=i[Xh]||D_(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function D_(n){return qS(n)?()=>{let e=D_(Gt(n));return e&&e()}:Do(n)}function Gj(n,e,t,r,i){let o=n,s=e;for(;o!==null&&s!==null&&s[ce]&2048&&!(s[ce]&512);){let a=UA(o,s,t,r|me.Self,ur);if(a!==ur)return a;let l=o.parent;if(!l){let c=s[dA];if(c){let d=c.get(t,ur,r);if(d!==ur)return d}l=$A(s),s=s[da]}o=l}return i}function $A(n){let e=n[Ee],t=e.type;return t===2?e.declTNode:t===1?n[Kn]:null}function pS(n,e=null,t=null,r){let i=HA(n,e,t,r);return i.resolveInjectorInitializers(),i}function HA(n,e=null,t=null,r,i=new Set){let o=[t||Sn,ov(n)];return r=r||(typeof n=="object"?void 0:zt(n)),new Eu(o,e||av(),r||null,i)}var pn=class n{static THROW_IF_NOT_FOUND=wu;static NULL=new nf;static create(e,t){if(Array.isArray(e))return pS({name:""},t,e,"");{let r=e.name??"";return pS({name:r},e.parent,e.providers,r)}}static \u0275prov=te({token:n,providedIn:"any",factory:()=>B(XS)});static __NG_ELEMENT_ID__=-1};var zj=new Q("");zj.__NG_ELEMENT_ID__=n=>{let e=on();if(e===null)throw new ne(204,!1);if(e.type&2)return e.value;if(n&me.Optional)return null;throw new ne(204,!1)};var qA=!1,yv=(()=>{class n{static __NG_ELEMENT_ID__=Wj;static __NG_ENV_ID__=t=>t}return n})(),T_=class extends yv{_lView;constructor(e){super(),this._lView=e}onDestroy(e){return EA(this._lView,e),()=>lj(this._lView,e)}};function Wj(){return new T_($e())}var aa=class{},_v=new Q("",{providedIn:"root",factory:()=>!1});var GA=new Q(""),zA=new Q(""),ko=(()=>{class n{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new St(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=te({token:n,providedIn:"root",factory:()=>new n})}return n})(),vv=(()=>{class n{internalPendingTasks=V(ko);scheduler=V(aa);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(12),this.internalPendingTasks.remove(t))}}run(t){return x(this,null,function*(){let r=this.add();try{return yield t()}finally{r()}})}static \u0275prov=te({token:n,providedIn:"root",factory:()=>new n})}return n})(),b_=class extends ze{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,uA()&&(this.destroyRef=V(yv,{optional:!0})??void 0,this.pendingTasks=V(ko,{optional:!0})??void 0)}emit(e){let t=be(null);try{super.next(e)}finally{be(t)}}subscribe(e,t,r){let i=e,o=t||(()=>null),s=r;if(e&&typeof e=="object"){let l=e;i=l.next?.bind(l),o=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:i,error:o,complete:s});return e instanceof tt&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{e(t),r!==void 0&&this.pendingTasks?.remove(r)})}}},Mt=b_;function pf(...n){}function WA(n){let e,t;function r(){n=pf;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function gS(n){return queueMicrotask(()=>n()),()=>{n=pf}}var wv="isAngularZone",gf=wv+"_ID",Kj=0,Se=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new Mt(!1);onMicrotaskEmpty=new Mt(!1);onStable=new Mt(!1);onError=new Mt(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=qA}=e;if(typeof Zone>"u")throw new ne(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,Zj(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(wv)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new ne(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new ne(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,Qj,pf,pf);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},Qj={};function Ev(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Yj(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){WA(()=>{n.callbackScheduled=!1,S_(n),n.isCheckStableRunning=!0,Ev(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),S_(n)}function Zj(n){let e=()=>{Yj(n)},t=Kj++;n._inner=n._inner.fork({name:"angular",properties:{[wv]:!0,[gf]:t,[gf+t]:!0},onInvokeTask:(r,i,o,s,a,l)=>{if(Jj(l))return r.invokeTask(o,s,a,l);try{return mS(n),r.invokeTask(o,s,a,l)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),yS(n)}},onInvoke:(r,i,o,s,a,l,c)=>{try{return mS(n),r.invoke(o,s,a,l,c)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!Xj(l)&&e(),yS(n)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,S_(n),Ev(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function S_(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function mS(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function yS(n){n._nesting--,Ev(n)}var A_=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new Mt;onMicrotaskEmpty=new Mt;onStable=new Mt;onError=new Mt;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function Jj(n){return KA(n,"__ignore_ng_zone__")}function Xj(n){return KA(n,"__scheduler_tick__")}function KA(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var Di=class{_console=console;handleError(e){this._console.error("ERROR",e)}},e2=new Q("",{providedIn:"root",factory:()=>{let n=V(Se),e=V(Di);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function _S(n,e){return $S(n,e)}function t2(n){return $S(US,n)}var QA=(_S.required=t2,_S);function n2(){return kf(on(),$e())}function kf(n,e){return new pr(xn(n,e))}var pr=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=n2}return n})();var vS=new Set;function Of(n){vS.has(n)||(vS.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function r2(n){return typeof n=="function"&&n[hn]!==void 0}function Ru(n,e){Of("NgSignals");let t=P0(n),r=t[hn];return e?.equal&&(r.equal=e.equal),t.set=i=>_h(r,i),t.update=i=>k0(r,i),t.asReadonly=i2.bind(t),t}function i2(){let n=this[hn];if(n.readonlyFn===void 0){let e=()=>this();e[hn]=n,n.readonlyFn=e}return n.readonlyFn}function YA(n){return r2(n)&&typeof n.set=="function"}function ZA(n){return(n.flags&128)===128}var JA=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(JA||{}),XA=new Map,o2=0;function s2(){return o2++}function a2(n){XA.set(n[Af],n)}function M_(n){XA.delete(n[Af])}var wS="__ngContext__";function Ro(n,e){Ei(e)?(n[wS]=e[Af],a2(e)):n[wS]=e}function eM(n){return nM(n[Iu])}function tM(n){return nM(n[zn])}function nM(n){for(;n!==null&&!$r(n);)n=n[zn];return n}var R_;function rM(n){R_=n}function l2(){if(R_!==void 0)return R_;if(typeof document<"u")return document;throw new ne(210,!1)}var Iv=new Q("",{providedIn:"root",factory:()=>u2}),u2="ng",Cv=new Q(""),sn=new Q("",{providedIn:"platform",factory:()=>"unknown"});var Dv=new Q("",{providedIn:"root",factory:()=>l2().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var c2="h",d2="b";var iM=!1,h2=new Q("",{providedIn:"root",factory:()=>iM});var oM=function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n}(oM||{}),Ff=new Q("");var f2=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=te({token:n,providedIn:"root",factory:()=>new n})}return n})();var p2=()=>null;function Tv(n,e,t=!1){return p2(n,e,t)}function sM(n,e){let t=n.contentQueries;if(t!==null){let r=be(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let a=n.data[s];bA(o),a.contentQueries(2,e[s],s)}}}finally{be(r)}}}function x_(n,e,t){bA(0);let r=be(null);try{e(n,t)}finally{be(r)}}function aM(n,e,t){if(fA(e)){let r=be(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let a=n.data[s];if(a.contentQueries){let l=t[s];a.contentQueries(1,l,s)}}}finally{be(r)}}}var fr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(fr||{});var N_=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${yL})`}};function bv(n){return n instanceof N_?n.changingThisBreaksApplicationSecurity:n}function lM(n){return n instanceof Function?n():n}var Ti=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(Ti||{});function g2(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}var uM="ng-template";function m2(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&g2(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(Sv(n))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function Sv(n){return n.type===4&&n.value!==uM}function y2(n,e,t){let r=n.type===4&&!t?uM:n.value;return e===r}function _2(n,e,t){let r=4,i=n.attrs,o=i!==null?E2(i):0,s=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!s&&!Gn(r)&&!Gn(l))return!1;if(s&&Gn(l))continue;s=!1,r=l|r&1;continue}if(!s)if(r&4){if(r=2|r&1,l!==""&&!y2(n,l,t)||l===""&&e.length===1){if(Gn(r))return!1;s=!0}}else if(r&8){if(i===null||!m2(n,i,l,t)){if(Gn(r))return!1;s=!0}}else{let c=e[++a],d=v2(l,i,Sv(n),t);if(d===-1){if(Gn(r))return!1;s=!0;continue}if(c!==""){let h;if(d>o?h="":h=i[d+1].toLowerCase(),r&2&&c!==h){if(Gn(r))return!1;s=!0}}}}return Gn(r)||s}function Gn(n){return(n&1)===0}function v2(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){let s=e[i];if(s===n)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return I2(e,n)}function w2(n,e,t=!1){for(let r=0;r<e.length;r++)if(_2(n,e[r],t))return!0;return!1}function E2(n){for(let e=0;e<n.length;e++){let t=n[e];if(Oj(t))return e}return n.length}function I2(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function ES(n,e){return n?":not("+e.trim()+")":e}function C2(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let a=n[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!Gn(s)&&(e+=ES(o,i),i=""),r=s,o=o||!Gn(r);t++}return i!==""&&(e+=ES(o,i)),e}function D2(n){return n.map(C2).join(",")}function T2(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let o=n[r];if(typeof o=="string")i===2?o!==""&&e.push(o,n[++r]):i===8&&t.push(o);else{if(!Gn(i))break;i=o}r++}return{attrs:e,classes:t}}var Mi={};function De(n=1){cM(Kt(),$e(),fa()+n,!1)}function cM(n,e,t,r){if(!r)if((e[ce]&3)===3){let o=n.preOrderCheckHooks;o!==null&&Qh(e,o,t)}else{let o=n.preOrderHooks;o!==null&&Yh(e,o,0,t)}Ao(t)}function Te(n,e=me.Default){let t=$e();if(t===null)return B(n,e);let r=on();return BA(r,t,Gt(n),e)}function dM(n,e,t,r,i,o){let s=be(null);try{let a=null;i&Ti.SignalBased&&(a=e[r][hn]),a!==null&&a.transformFn!==void 0&&(o=a.transformFn(o)),i&Ti.HasDecoratorInputTransform&&(o=n.inputTransforms[r].call(e,o)),n.setInput!==null?n.setInput(e,a,o,t,r):pA(e,a,r,o)}finally{be(s)}}function b2(n,e){return n.createText(e)}function S2(n,e,t){n.setValue(e,t)}function hM(n,e,t){return n.createElement(e,t)}function mf(n,e,t,r,i){n.insertBefore(e,t,r,i)}function fM(n,e,t){n.appendChild(e,t)}function IS(n,e,t,r,i){r!==null?mf(n,e,t,r,i):fM(n,e,t)}function A2(n,e,t){n.removeChild(null,e,t)}function M2(n,e,t){n.setAttribute(e,"style",t)}function R2(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function pM(n,e,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&kj(n,e,r),i!==null&&R2(n,e,i),o!==null&&M2(n,e,o)}function Vf(n,e,t,r,i,o,s,a,l,c,d){let h=e.blueprint.slice();return h[Ur]=i,h[ce]=r|4|128|8|64|1024,(c!==null||n&&n[ce]&2048)&&(h[ce]|=2048),wA(h),h[Wt]=h[da]=n,h[cr]=t,h[Ii]=s||n&&n[Ii],h[ct]=a||n&&n[ct],h[na]=l||n&&n[na]||null,h[Kn]=o,h[Af]=s2(),h[rf]=d,h[dA]=c,h[dr]=e.type==2?n[dr]:h,h}function gM(n,e,t,r){if(t===0)return-1;let i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function mM(n,e,t,r,i){let o=fa(),s=r&2;try{Ao(-1),s&&e.length>Wn&&cM(n,e,Wn,!1),An(s?2:0,i),t(r,i)}finally{Ao(o),An(s?3:1,i)}}function yM(n,e,t){IA()&&(B2(n,e,t,xn(t,e)),(t.flags&64)===64&&IM(n,e,t))}function _M(n,e,t=xn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?t(e,n):n[s];n[i++]=a}}}function vM(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=Av(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function Av(n,e,t,r,i,o,s,a,l,c,d){let h=Wn+r,g=h+i,m=x2(h,g),v=typeof c=="function"?c():c;return m[Ee]={type:n,blueprint:m,template:t,queries:null,viewQuery:a,declTNode:e,data:m.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:g,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:l,consts:v,incompleteFirstPass:!1,ssrId:d}}function x2(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Mi);return t}function N2(n,e,t,r){let o=r.get(h2,iM)||t===fr.ShadowDom,s=n.selectRootElement(e,o);return P2(s),s}function P2(n){k2(n)}var k2=()=>null;function CS(n,e,t,r,i){for(let o in e){if(!e.hasOwnProperty(o))continue;let s=e[o];if(s===void 0)continue;r??={};let a,l=Ti.None;Array.isArray(s)?(a=s[0],l=s[1]):a=s;let c=o;if(i!==null){if(!i.hasOwnProperty(o))continue;c=i[o]}n===0?DS(r,t,c,a,l):DS(r,t,c,a)}return r}function DS(n,e,t,r,i){let o;n.hasOwnProperty(t)?(o=n[t]).push(e,r):o=n[t]=[e,r],i!==void 0&&o.push(i)}function O2(n,e,t){let r=e.directiveStart,i=e.directiveEnd,o=n.data,s=e.attrs,a=[],l=null,c=null;for(let d=r;d<i;d++){let h=o[d],g=t?t.get(h):null,m=g?g.inputs:null,v=g?g.outputs:null;l=CS(0,h.inputs,d,l,m),c=CS(1,h.outputs,d,c,v);let D=l!==null&&s!==null&&!Sv(e)?Z2(l,d,s):null;a.push(D)}l!==null&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}function F2(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function Mv(n,e,t,r,i,o,s,a){let l=xn(e,t),c=e.inputs,d;!a&&c!=null&&(d=c[r])?(Rv(n,t,d,r,i),Mf(e)&&V2(t,e.index)):e.type&3?(r=F2(r),i=s!=null?s(i,e.value||"",r):i,o.setProperty(l,r,i)):e.type&12}function V2(n,e){let t=Ai(e,n);t[ce]&16||(t[ce]|=64)}function wM(n,e,t,r){if(IA()){let i=r===null?null:{"":-1},o=$2(n,t),s,a;o===null?s=a=null:[s,a]=o,s!==null&&EM(n,e,t,s,i,a),i&&H2(t,r,i)}t.mergedAttrs=oa(t.mergedAttrs,t.attrs)}function EM(n,e,t,r,i,o){for(let c=0;c<r.length;c++)C_(ff(t,e),n,r[c].type);G2(t,n.data.length,r.length);for(let c=0;c<r.length;c++){let d=r[c];d.providersResolver&&d.providersResolver(d)}let s=!1,a=!1,l=gM(n,e,r.length,null);for(let c=0;c<r.length;c++){let d=r[c];t.mergedAttrs=oa(t.mergedAttrs,d.hostAttrs),z2(n,t,e,l,d),q2(l,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let h=d.type.prototype;!s&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),s=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),l++}O2(n,t,o)}function L2(n,e,t,r,i){let o=i.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;j2(s)!=a&&s.push(a),s.push(t,r,o)}}function j2(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function B2(n,e,t,r){let i=t.directiveStart,o=t.directiveEnd;Mf(t)&&W2(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||ff(t,e),Ro(r,e);let s=t.initialInputs;for(let a=i;a<o;a++){let l=n.data[a],c=sa(e,n,a,t);if(Ro(c,e),s!==null&&Y2(e,a-i,c,l,t,s),Ci(l)){let d=Ai(t.index,e);d[cr]=sa(e,n,a,t)}}}function IM(n,e,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=Dj();try{Ao(o);for(let a=r;a<i;a++){let l=n.data[a],c=e[a];w_(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&U2(l,c)}}finally{Ao(-1),w_(s)}}function U2(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function $2(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let o=0;o<t.length;o++){let s=t[o];if(w2(e,s.selectors,!1))if(r||(r=[]),Ci(s))if(s.findHostDirectiveDefs!==null){let a=[];i=i||new Map,s.findHostDirectiveDefs(s,a,i),r.unshift(...a,s);let l=a.length;P_(n,e,l)}else r.unshift(s),P_(n,e,0);else i=i||new Map,s.findHostDirectiveDefs?.(s,r,i),r.push(s)}return r===null?null:[r,i]}function P_(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function H2(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let o=t[e[i+1]];if(o==null)throw new ne(-301,!1);r.push(e[i],o)}}}function q2(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;Ci(e)&&(t[""]=n)}}function G2(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function z2(n,e,t,r,i){n.data[r]=i;let o=i.factory||(i.factory=Do(i.type,!0)),s=new Mo(o,Ci(i),Te);n.blueprint[r]=s,t[r]=s,L2(n,e,r,gM(n,t,i.hostVars,Mi),i)}function CM(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function W2(n,e,t){let r=xn(e,n),i=vM(t),o=n[Ii].rendererFactory,s=Lf(n,Vf(n,i,null,CM(t),r,e,null,o.createRenderer(r,t),null,null,null));n[e.index]=s}function K2(n,e,t,r,i,o){let s=xn(n,e);Q2(e[ct],s,o,n.value,t,r,i)}function Q2(n,e,t,r,i,o,s){if(o==null)n.removeAttribute(e,i,t);else{let a=s==null?tv(o):s(o,r||"",i);n.setAttribute(e,i,a,t)}}function Y2(n,e,t,r,i,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;){let l=s[a++],c=s[a++],d=s[a++],h=s[a++];dM(r,t,l,c,d,h)}}function Z2(n,e,t){let r=null,i=0;for(;i<t.length;){let o=t[i];if(o===0){i+=4;continue}else if(o===5){i+=2;continue}if(typeof o=="number")break;if(n.hasOwnProperty(o)){r===null&&(r=[]);let s=n[o];for(let a=0;a<s.length;a+=3)if(s[a]===e){r.push(o,s[a+1],s[a+2],t[i+1]);break}}i+=2}return r}function DM(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function Lf(n,e){return n[Iu]?n[aS][zn]=e:n[Iu]=e,n[aS]=e,e}function TM(n,e){let t=n[na],r=t?t.get(Di,null):null;r&&r.handleError(e)}function Rv(n,e,t,r,i){for(let o=0;o<t.length;){let s=t[o++],a=t[o++],l=t[o++],c=e[s],d=n.data[s];dM(d,c,r,a,l,i)}}function J2(n,e){let t=Ai(e,n),r=t[Ee];X2(r,t);let i=t[Ur];i!==null&&t[rf]===null&&(t[rf]=Tv(i,t[na])),xv(r,t,t[cr])}function X2(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function xv(n,e,t){dv(e);try{let r=n.viewQuery;r!==null&&x_(1,r,t);let i=n.template;i!==null&&mM(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[ia]?.finishViewCreation(n),n.staticContentQueries&&sM(n,e),n.staticViewQueries&&x_(2,n.viewQuery,t);let o=n.components;o!==null&&eB(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[ce]&=-5,hv()}}function eB(n,e){for(let t=0;t<e.length;t++)J2(n,e[t])}var Lr=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Lr||{}),tB;function Nv(n,e){return tB(n,e)}function Ys(n,e,t,r,i){if(r!=null){let o,s=!1;$r(r)?o=r:Ei(r)&&(s=!0,r=r[Ur]);let a=hr(r);n===0&&t!==null?i==null?fM(e,t,a):mf(e,t,a,i||null,!0):n===1&&t!==null?mf(e,t,a,i||null,!0):n===2?A2(e,a,s):n===3&&e.destroyNode(a),o!=null&&pB(e,n,o,t,i)}}function nB(n,e){bM(n,e),e[Ur]=null,e[Kn]=null}function rB(n,e,t,r,i,o){r[Ur]=i,r[Kn]=e,jf(n,r,t,1,i,o)}function bM(n,e){e[Ii].changeDetectionScheduler?.notify(10),jf(n,e,e[ct],2,null,null)}function iB(n){let e=n[Iu];if(!e)return r_(n[Ee],n);for(;e;){let t=null;if(Ei(e))t=e[Iu];else{let r=e[Mn];r&&(t=r)}if(!t){for(;e&&!e[zn]&&e!==n;)Ei(e)&&r_(e[Ee],e),e=e[Wt];e===null&&(e=n),Ei(e)&&r_(e[Ee],e),t=e&&e[zn]}e=t}}function oB(n,e,t,r){let i=Mn+r,o=t.length;r>0&&(t[i-1][zn]=e),r<o-Mn?(e[zn]=t[i],JS(t,Mn+r,e)):(t.push(e),e[zn]=null),e[Wt]=t;let s=e[ra];s!==null&&t!==s&&SM(s,e);let a=e[ia];a!==null&&a.insertView(n),__(e),e[ce]|=128}function SM(n,e){let t=n[lf],r=e[Wt];if(Ei(r))n[ce]|=2;else{let i=r[Wt][dr];e[dr]!==i&&(n[ce]|=2)}t===null?n[lf]=[e]:t.push(e)}function Pv(n,e){let t=n[lf],r=t.indexOf(e);t.splice(r,1)}function k_(n,e){if(n.length<=Mn)return;let t=Mn+e,r=n[t];if(r){let i=r[ra];i!==null&&i!==n&&Pv(i,r),e>0&&(n[t-1][zn]=r[zn]);let o=tf(n,Mn+e);nB(r[Ee],r);let s=o[ia];s!==null&&s.detachView(o[Ee]),r[Wt]=null,r[zn]=null,r[ce]&=-129}return r}function AM(n,e){if(Au(e))return;let t=e[ct];t.destroyNode&&jf(n,e,t,3,null,null),iB(e)}function r_(n,e){if(Au(e))return;let t=be(null);try{e[ce]&=-129,e[ce]|=256,e[fn]&&xy(e[fn]),aB(n,e),sB(n,e),e[Ee].type===1&&e[ct].destroy();let r=e[ra];if(r!==null&&$r(e[Wt])){r!==e[Wt]&&Pv(r,e);let i=e[ia];i!==null&&i.detachView(n)}M_(e)}finally{be(t)}}function sB(n,e){let t=n.cleanup,r=e[of];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?r[a]():r[-a].unsubscribe(),s+=2}else{let a=r[t[s+1]];t[s].call(a)}r!==null&&(e[of]=null);let i=e[wi];if(i!==null){e[wi]=null;for(let s=0;s<i.length;s++){let a=i[s];a()}}let o=e[sf];if(o!==null){e[sf]=null;for(let s of o)s.destroy()}}function aB(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof Mo)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],l=o[s+1];An(4,a,l);try{l.call(a)}finally{An(5,a,l)}}else{An(4,i,o);try{o.call(i)}finally{An(5,i,o)}}}}}function lB(n,e,t){return uB(n,e.parent,t)}function uB(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[Ur];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:o}=n.data[r.directiveStart+i];if(o===fr.None||o===fr.Emulated)return null}return xn(r,t)}}function cB(n,e,t){return hB(n,e,t)}function dB(n,e,t){return n.type&40?xn(n,t):null}var hB=dB,TS;function kv(n,e,t,r){let i=lB(n,r,e),o=e[ct],s=r.parent||e[Kn],a=cB(s,r,e);if(i!=null)if(Array.isArray(t))for(let l=0;l<t.length;l++)IS(o,i,t[l],a,!1);else IS(o,i,t,a,!1);TS!==void 0&&TS(o,r,e,t,i)}function _u(n,e){if(e!==null){let t=e.type;if(t&3)return xn(e,n);if(t&4)return O_(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return _u(n,r);{let i=n[e.index];return $r(i)?O_(-1,i):hr(i)}}else{if(t&128)return _u(n,e.next);if(t&32)return Nv(e,n)()||hr(n[e.index]);{let r=MM(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=So(n[dr]);return _u(i,r)}else return _u(n,e.next)}}}return null}function MM(n,e){if(e!==null){let r=n[dr][Kn],i=e.projection;return r.projection[i]}return null}function O_(n,e){let t=Mn+n+1;if(t<e.length){let r=e[t],i=r[Ee].firstChild;if(i!==null)return _u(r,i)}return e[bo]}function Ov(n,e,t,r,i,o,s){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],l=t.type;if(s&&e===0&&(a&&Ro(hr(a),r),t.flags|=2),(t.flags&32)!==32)if(l&8)Ov(n,e,t.child,r,i,o,!1),Ys(e,n,i,a,o);else if(l&32){let c=Nv(t,r),d;for(;d=c();)Ys(e,n,i,d,o);Ys(e,n,i,a,o)}else l&16?fB(n,e,r,t,i,o):Ys(e,n,i,a,o);t=s?t.projectionNext:t.next}}function jf(n,e,t,r,i,o){Ov(t,r,n.firstChild,e,i,o,!1)}function fB(n,e,t,r,i,o){let s=t[dr],l=s[Kn].projection[r.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++){let d=l[c];Ys(e,n,i,d,o)}else{let c=l,d=s[Wt];ZA(r)&&(c.flags|=128),Ov(n,e,c,d,i,o,!0)}}function pB(n,e,t,r,i){let o=t[bo],s=hr(t);o!==s&&Ys(e,n,r,o,i);for(let a=Mn;a<t.length;a++){let l=t[a];jf(l[Ee],l,n,e,r,o)}}function gB(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let o=r.indexOf("-")===-1?void 0:Lr.DashCase;i==null?n.removeStyle(t,r,o):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=Lr.Important),n.setStyle(t,r,i,o))}}function mB(n,e,t,r){let i=be(null);try{let o=e.tView,a=n[ce]&4096?4096:16,l=Vf(n,o,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),c=n[e.index];l[ra]=c;let d=n[ia];return d!==null&&(l[ia]=d.createEmbeddedView(o)),xv(o,l,t),l}finally{be(i)}}function bS(n,e){return!e||e.firstChild===null||ZA(n)}function yB(n,e,t,r=!0){let i=e[Ee];if(oB(i,e,n,t),r){let s=O_(t,n),a=e[ct],l=a.parentNode(n[bo]);l!==null&&rB(i,n[Kn],a,e,l,s)}let o=e[rf];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function yf(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&r.push(hr(o)),$r(o)&&_B(o,r);let s=t.type;if(s&8)yf(n,e,t.child,r);else if(s&32){let a=Nv(t,e),l;for(;l=a();)r.push(l)}else if(s&16){let a=MM(e,t);if(Array.isArray(a))r.push(...a);else{let l=So(e[dr]);yf(l[Ee],l,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function _B(n,e){for(let t=Mn;t<n.length;t++){let r=n[t],i=r[Ee].firstChild;i!==null&&yf(r[Ee],r,i,e)}n[bo]!==n[Ur]&&e.push(n[bo])}var RM=[];function vB(n){return n[fn]??wB(n)}function wB(n){let e=RM.pop()??Object.create(IB);return e.lView=n,e}function EB(n){n.lView[fn]!==n&&(n.lView=null,RM.push(n))}var IB=pe($({},su),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{xf(n.lView)},consumerOnSignalRead(){this.lView[fn]=this}});function CB(n){let e=n[fn]??Object.create(DB);return e.lView=n,e}var DB=pe($({},su),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=So(n.lView);for(;e&&!xM(e[Ee]);)e=So(e);e&&cv(e)},consumerOnSignalRead(){this.lView[fn]=this}});function xM(n){return n.type!==2}function NM(n){if(n[sf]===null)return;let e=!0;for(;e;){let t=!1;for(let r of n[sf])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(n[ce]&8192)}}var TB=100;function PM(n,e=!0,t=0){let i=n[Ii].rendererFactory,o=!1;o||i.begin?.();try{bB(n,t)}catch(s){throw e&&TM(n,s),s}finally{o||i.end?.()}}function bB(n,e){let t=TA();try{uS(!0),F_(n,e);let r=0;for(;Rf(n);){if(r===TB)throw new ne(103,!1);r++,F_(n,1)}}finally{uS(t)}}function SB(n,e,t,r){if(Au(e))return;let i=e[ce],o=!1,s=!1;dv(e);let a=!0,l=null,c=null;o||(xM(n)?(c=vB(e),l=gh(c)):C0()===null?(a=!1,c=CB(e),l=gh(c)):e[fn]&&(xy(e[fn]),e[fn]=null));try{wA(e),wj(n.bindingStartIndex),t!==null&&mM(n,e,t,2,r);let d=(i&3)===3;if(!o)if(d){let m=n.preOrderCheckHooks;m!==null&&Qh(e,m,null)}else{let m=n.preOrderHooks;m!==null&&Yh(e,m,0,null),e_(e,0)}if(s||AB(e),NM(e),kM(e,0),n.contentQueries!==null&&sM(n,e),!o)if(d){let m=n.contentCheckHooks;m!==null&&Qh(e,m)}else{let m=n.contentHooks;m!==null&&Yh(e,m,1),e_(e,1)}RB(n,e);let h=n.components;h!==null&&FM(e,h,0);let g=n.viewQuery;if(g!==null&&x_(2,g,r),!o)if(d){let m=n.viewCheckHooks;m!==null&&Qh(e,m)}else{let m=n.viewHooks;m!==null&&Yh(e,m,2),e_(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Xy]){for(let m of e[Xy])m();e[Xy]=null}o||(e[ce]&=-73)}catch(d){throw o||xf(e),d}finally{c!==null&&(My(c,l),a&&EB(c)),hv()}}function kM(n,e){for(let t=eM(n);t!==null;t=tM(t))for(let r=Mn;r<t.length;r++){let i=t[r];OM(i,e)}}function AB(n){for(let e=eM(n);e!==null;e=tM(e)){if(!(e[ce]&2))continue;let t=e[lf];for(let r=0;r<t.length;r++){let i=t[r];cv(i)}}}function MB(n,e,t){let r=Ai(e,n);OM(r,t)}function OM(n,e){uv(n)&&F_(n,e)}function F_(n,e){let r=n[Ee],i=n[ce],o=n[fn],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&Ry(o)),s||=!1,o&&(o.dirty=!1),n[ce]&=-9217,s)SB(r,n,r.template,n[cr]);else if(i&8192){NM(n),kM(n,1);let a=r.components;a!==null&&FM(n,a,1)}}function FM(n,e,t){for(let r=0;r<e.length;r++)MB(n,e[r],t)}function RB(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)Ao(~i);else{let o=i,s=t[++r],a=t[++r];Cj(s,o);let l=e[o];An(24,l),a(2,l),An(25,l)}}}finally{Ao(-1)}}function Fv(n,e){let t=TA()?64:1088;for(n[Ii].changeDetectionScheduler?.notify(e);n;){n[ce]|=t;let r=So(n);if(m_(n)&&!r)return n;n=r}return null}var xo=class{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){let e=this._lView,t=e[Ee];return yf(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r}get context(){return this._lView[cr]}get dirty(){return!!(this._lView[ce]&9280)||!!this._lView[fn]?.dirty}set context(e){this._lView[cr]=e}get destroyed(){return Au(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Wt];if($r(e)){let t=e[af],r=t?t.indexOf(this):-1;r>-1&&(k_(e,r),tf(t,r))}this._attachedToViewContainer=!1}AM(this._lView[Ee],this._lView)}onDestroy(e){EA(this._lView,e)}markForCheck(){Fv(this._cdRefInjectingView||this._lView,4)}markForRefresh(){cv(this._cdRefInjectingView||this._lView)}detach(){this._lView[ce]&=-129}reattach(){__(this._lView),this._lView[ce]|=128}detectChanges(){this._lView[ce]|=1024,PM(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ne(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=m_(this._lView),t=this._lView[ra];t!==null&&!e&&Pv(t,this._lView),bM(this._lView[Ee],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ne(902,!1);this._appRef=e;let t=m_(this._lView),r=this._lView[ra];r!==null&&!t&&SM(r,this._lView),__(this._lView)}},Bf=(()=>{class n{static __NG_ELEMENT_ID__=PB}return n})(),xB=Bf,NB=class extends xB{_declarationLView;_declarationTContainer;elementRef;constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=mB(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new xo(i)}};function PB(){return kB(on(),$e())}function kB(n,e){return n.type&4?new NB(e,n,kf(n,e)):null}function Uf(n,e,t,r,i){let o=n.data[e];if(o===null)o=OB(n,e,t,r,i),Ij()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=yj();o.injectorIndex=s===null?-1:s.injectorIndex}return Mu(o,!0),o}function OB(n,e,t,r,i){let o=CA(),s=DA(),a=s?o:o&&o.parent,l=n.data[e]=VB(n,a,t,e,r,i);return FB(n,l,o,s),l}function FB(n,e,t,r){n.firstChild===null&&(n.firstChild=e),t!==null&&(r?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function VB(n,e,t,r,i,o){let s=e?e.injectorIndex:-1,a=0;return pj()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var qZ=new RegExp(`^(\\d+)*(${d2}|${c2})*(.*)`);var LB=()=>null;function SS(n,e){return LB(n,e)}var V_=class{},_f=class{},L_=class{resolveComponentFactory(e){throw Error(`No component factory found for ${zt(e)}.`)}},la=class{static NULL=new L_},ua=class{},qr=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>jB()}return n})();function jB(){let n=$e(),e=on(),t=Ai(e.index,n);return(Ei(t)?t:n)[ct]}var BB=(()=>{class n{static \u0275prov=te({token:n,providedIn:"root",factory:()=>null})}return n})();function j_(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)i=tS(i,a);else if(o==2){let l=a,c=e[++s];r=tS(r,l+": "+c+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var vf=class extends la{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=To(e);return new Cu(t,this.ngModule)}};function AS(n,e){let t=[];for(let r in n){if(!n.hasOwnProperty(r))continue;let i=n[r];if(i===void 0)continue;let o=Array.isArray(i),s=o?i[0]:i,a=o?i[1]:Ti.None;e?t.push({propName:s,templateName:r,isSignal:(a&Ti.SignalBased)!==0}):t.push({propName:s,templateName:r})}return t}function UB(n){let e=n.toLowerCase();return e==="svg"?rj:e==="math"?ij:null}function $B(n){let{attrs:e,classes:t}=T2(n),r=e;return t.length&&r.push(1,...t),r}var Cu=class extends _f{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;get inputs(){let e=this.componentDef,t=e.inputTransforms,r=AS(e.inputs,!0);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return AS(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=D2(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let o=be(null);try{i=i||this.ngModule;let s=i instanceof it?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let a=s?new E_(e,s):e,l=a.get(ua,null);if(l===null)throw new ne(407,!1);let c=a.get(BB,null),d=a.get(aa,null),h={rendererFactory:l,sanitizer:c,changeDetectionScheduler:d},g=l.createRenderer(null,this.componentDef),m=this.componentDef.selectors[0][0]||"div",v=r?N2(g,r,this.componentDef.encapsulation,a):hM(g,m,UB(m)),D=512;this.componentDef.signals?D|=4096:this.componentDef.onPush||(D|=16);let S=null;v!==null&&(S=Tv(v,a,!0));let P=Av(0,null,null,1,0,null,null,null,null,null,null),j=Vf(null,P,null,D,null,null,h,g,a,null,S);j[Wn]=v,dv(j);let O,K=null;try{let ee=this.componentDef,I,_=null;ee.findHostDirectiveDefs?(I=[],_=new Map,ee.findHostDirectiveDefs(ee,I,_),I.push(ee)):I=[ee];let E=r?["ng-version","19.1.3"]:$B(this.componentDef.selectors[0]),C=Uf(P,Wn,2,"#host",E);for(let T of I)C.mergedAttrs=oa(C.mergedAttrs,T.hostAttrs);C.mergedAttrs=oa(C.mergedAttrs,E),j_(C,C.mergedAttrs,!0),v&&pM(g,v,C),K=HB(C,v,ee,I,j,h),t!==void 0&&GB(C,this.ngContentSelectors,t),O=qB(K,ee,I,_,j,[zB]),xv(P,j,null)}catch(ee){throw K!==null&&M_(K),M_(j),ee}finally{hv()}let ie=vA(P,Wn);return new B_(this.componentType,O,kf(ie,j),j,ie)}finally{be(o)}}},B_=class extends V_{location;_rootLView;_tNode;instance;hostView;changeDetectorRef;componentType;previousInputValues=null;constructor(e,t,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.instance=t,this.hostView=this.changeDetectorRef=new xo(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let o=this._rootLView;Rv(o[Ee],o,i,e,t),this.previousInputValues.set(e,t);let s=Ai(this._tNode.index,o);Fv(s,1)}}get injector(){return new Co(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function HB(n,e,t,r,i,o){let s=i[Ee],a=null;e!==null&&(a=Tv(e,i[na]));let l=o.rendererFactory.createRenderer(e,t),c=Vf(i,vM(t),null,CM(t),i[n.index],n,o,l,null,null,a);return s.firstCreatePass&&P_(s,n,r.length-1),Lf(i,c),i[n.index]=c}function qB(n,e,t,r,i,o){let s=on(),a=i[Ee],l=xn(s,i);EM(a,i,s,t,null,r);for(let d=0;d<t.length;d++){let h=s.directiveStart+d,g=sa(i,a,h,s);Ro(g,i)}IM(a,i,s),l&&Ro(l,i);let c=sa(i,a,s.directiveStart+s.componentOffset,s);if(n[cr]=i[cr]=c,o!==null)for(let d of o)d(c,e);return aM(a,s,i),c}function GB(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let o=t[i];r.push(o!=null&&o.length?Array.from(o):null)}}function zB(){let n=on();gv($e()[Ee],n)}var pa=(()=>{class n{static __NG_ELEMENT_ID__=WB}return n})();function WB(){let n=on();return QB(n,$e())}var KB=pa,VM=class extends KB{_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return kf(this._hostTNode,this._hostLView)}get injector(){return new Co(this._hostTNode,this._hostLView)}get parentInjector(){let e=mv(this._hostTNode,this._hostLView);if(kA(e)){let t=df(e,this._hostLView),r=cf(e),i=t[Ee].data[r+8];return new Co(i,t)}else return new Co(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=MS(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Mn}createEmbeddedView(e,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=SS(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,i,bS(this._hostTNode,s)),a}createComponent(e,t,r,i,o){let s=e&&!XL(e),a;if(s)a=t;else{let v=t||{};a=v.index,r=v.injector,i=v.projectableNodes,o=v.environmentInjector||v.ngModuleRef}let l=s?e:new Cu(To(e)),c=r||this.parentInjector;if(!o&&l.ngModule==null){let D=(s?c:this.parentInjector).get(it,null);D&&(o=D)}let d=To(l.componentType??{}),h=SS(this._lContainer,d?.id??null),g=h?.firstChild??null,m=l.create(c,i,g,o);return this.insertImpl(m.hostView,a,bS(this._hostTNode,h)),m}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(sj(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=i[Wt],c=new VM(l,l[Kn],l[Wt]);c.detach(c.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return yB(s,i,o,r),e.attachToViewContainerRef(),JS(i_(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=MS(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=k_(this._lContainer,t);r&&(tf(i_(this._lContainer),t),AM(r[Ee],r))}detach(e){let t=this._adjustIndex(e,-1),r=k_(this._lContainer,t);return r&&tf(i_(this._lContainer),t)!=null?new xo(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function MS(n){return n[af]}function i_(n){return n[af]||(n[af]=[])}function QB(n,e){let t,r=e[n.index];return $r(r)?t=r:(t=DM(r,e,null,n),e[n.index]=t,Lf(e,t)),ZB(t,e,n,r),new VM(t,n,e)}function YB(n,e){let t=n[ct],r=t.createComment(""),i=xn(e,n),o=t.parentNode(i);return mf(t,o,r,t.nextSibling(i),!1),r}var ZB=eU,JB=()=>!1;function XB(n,e,t){return JB(n,e,t)}function eU(n,e,t,r){if(n[bo])return;let i;t.type&8?i=hr(r):i=YB(e,t),n[bo]=i}var bi=class{},Du=class{};var U_=class extends bi{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new vf(this);constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t;let o=tA(e);this._bootstrapComponents=lM(o.bootstrap),this._r3Injector=HA(e,t,[{provide:bi,useValue:this},{provide:la,useValue:this.componentFactoryResolver},...r],zt(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},$_=class extends Du{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new U_(this.moduleType,e,[])}};var wf=class extends bi{injector;componentFactoryResolver=new vf(this);instance=null;constructor(e){super();let t=new Eu([...e.providers,{provide:bi,useValue:this},{provide:la,useValue:this.componentFactoryResolver}],e.parent||av(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Vv(n,e,t=null){return new wf({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var tU=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=oA(!1,t.type),i=r.length>0?Vv([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=te({token:n,providedIn:"environment",factory:()=>new n(B(it))})}return n})();function ga(n){return bu(()=>{let e=jM(n),t=pe($({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===JA.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(tU).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||fr.Emulated,styles:n.styles||Sn,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&Of("NgStandalone"),BM(t);let r=n.dependencies;return t.directiveDefs=xS(r,!1),t.pipeDefs=xS(r,!0),t.id=iU(t),t})}function nU(n){return To(n)||nA(n)}function rU(n){return n!==null}function mn(n){return bu(()=>({type:n.type,bootstrap:n.bootstrap||Sn,declarations:n.declarations||Sn,imports:n.imports||Sn,exports:n.exports||Sn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function RS(n,e){if(n==null)return Xs;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],o,s,a=Ti.None;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o):(o=i,s=i),e?(t[o]=a!==Ti.None?[r,a]:r,e[o]=s):t[o]=r}return t}function _t(n){return bu(()=>{let e=jM(n);return BM(e),e})}function LM(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function jM(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Xs,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Sn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:RS(n.inputs,e),outputs:RS(n.outputs),debugInfo:null}}function BM(n){n.features?.forEach(e=>e(n))}function xS(n,e){if(!n)return null;let t=e?rA:nU;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(rU)}function iU(n){let e=0,t=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of r.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function oU(n){return Object.getPrototypeOf(n.prototype).constructor}function gr(n){let e=oU(n.type),t=!0,r=[n];for(;e;){let i;if(Ci(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ne(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let s=n;s.inputs=zh(n.inputs),s.inputTransforms=zh(n.inputTransforms),s.declaredInputs=zh(n.declaredInputs),s.outputs=zh(n.outputs);let a=i.hostBindings;a&&cU(n,a);let l=i.viewQuery,c=i.contentQueries;if(l&&lU(n,l),c&&uU(n,c),sU(n,i),wL(n.outputs,i.outputs),Ci(i)&&i.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}let o=i.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===gr&&(t=!1)}}e=Object.getPrototypeOf(e)}aU(r)}function sU(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];if(r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;n.inputTransforms??={},n.inputTransforms[i]=e.inputTransforms[i]}}}function aU(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=oa(i.hostAttrs,t=oa(t,i.hostAttrs))}}function zh(n){return n===Xs?{}:n===Sn?[]:n}function lU(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function uU(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,o)=>{e(r,i,o),t(r,i,o)}:n.contentQueries=e}function cU(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function UM(n){return hU(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function dU(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function hU(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function fU(n,e,t){return n[e]=t}function No(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function pU(n,e,t,r){let i=No(n,e,t);return No(n,e+1,r)||i}function gU(n){return(n.flags&32)===32}function mU(n,e,t,r,i,o,s,a,l){let c=e.consts,d=Uf(e,n,4,s||null,a||null);wM(e,t,d,uf(c,l)),gv(e,d);let h=d.tView=Av(2,d,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return e.queries!==null&&(e.queries.template(e,d),h.queries=e.queries.embeddedTView(d)),d}function yU(n,e,t,r,i,o,s,a,l,c){let d=t+Wn,h=e.firstCreatePass?mU(d,e,n,r,i,o,s,a,l):e.data[d];Mu(h,!1);let g=_U(e,n,h,t);fv()&&kv(e,n,g,h),Ro(g,n);let m=DM(g,n,g,h);return n[d]=m,Lf(n,m),XB(m,h,n),lv(h)&&yM(e,n,h),l!=null&&_M(n,h,c),h}function xu(n,e,t,r,i,o,s,a){let l=$e(),c=Kt(),d=uf(c.consts,o);return yU(l,c,n,e,t,r,i,d,s,a),xu}var _U=vU;function vU(n,e,t,r){return pv(!0),e[ct].createComment("")}var Lv=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var $M=new Q("");function Oo(n){return!!n&&typeof n.then=="function"}function HM(n){return!!n&&typeof n.subscribe=="function"}var qM=new Q("");var GM=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=V(qM,{optional:!0})??[];injector=V(pn);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let o=Rn(this.injector,i);if(Oo(o))t.push(o);else if(HM(o)){let s=new Promise((a,l)=>{o.subscribe({complete:a,error:l})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),wU=(()=>{class n{static \u0275prov=te({token:n,providedIn:"root",factory:()=>new H_})}return n})(),H_=class{queuedEffectCount=0;queues=new Map;schedule(e){this.enqueue(e)}remove(e){let t=e.zone,r=this.queues.get(t);r.has(e)&&(r.delete(e),this.queuedEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||(this.queuedEffectCount++,r.add(e))}flush(){for(;this.queuedEffectCount>0;)for(let[e,t]of this.queues)e===null?this.flushQueue(t):e.run(()=>this.flushQueue(t))}flushQueue(e){for(let t of e)e.delete(t),this.queuedEffectCount--,t.run()}},jv=new Q("");function EU(){N0(()=>{throw new ne(600,!1)})}function IU(n){return n.isBoundToModule}var CU=10;function DU(n,e,t){try{let r=t();return Oo(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}var Si=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=V(e2);afterRenderManager=V(f2);zonelessEnabled=V(_v);rootEffectScheduler=V(wU);dirtyFlags=0;deferredDirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new ze;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=V(ko).hasPendingTasks.pipe(J(t=>!t));constructor(){V(Ff,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=V(it);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){let i=t instanceof _f;if(!this._injector.get(GM).done){let g=!i&&iA(t),m=!1;throw new ne(405,m)}let s;i?s=t:s=this._injector.get(la).resolveComponentFactory(t),this.componentTypes.push(s.componentType);let a=IU(s)?void 0:this._injector.get(bi),l=r||s.selector,c=s.create(pn.NULL,[],l,a),d=c.location.nativeElement,h=c.injector.get($M,null);return h?.registerApplication(d),c.onDestroy(()=>{this.detachView(c.hostView),Zh(this.components,c),h?.unregisterApplication(d)}),this._loadComponent(c),c}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick=()=>{if(this.tracingSnapshot!==null){let r=this.tracingSnapshot;this.tracingSnapshot=null,r.run(oM.CHANGE_DETECTION,this._tick),r.dispose();return}if(this._runningTick)throw new ne(101,!1);let t=be(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,be(t),this.afterTick.next()}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(ua,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let t=0;for(;this.dirtyFlags!==0&&t++<CU;)this.synchronizeOnce()}synchronizeOnce(){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),this.dirtyFlags&7){let t=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r,notifyErrorHandler:i}of this.allViews)TU(r,i,t,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Rf(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;Zh(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(jv,[]).forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Zh(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ne(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Zh(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function TU(n,e,t,r){if(!t&&!Rf(n))return;PM(n,e,t&&!r?0:1)}function $f(n,e,t,r){let i=$e(),o=Nf();if(No(i,o,e)){let s=Kt(),a=Pf();K2(a,i,n,e,t,r)}return $f}function zM(n,e,t,r){return No(n,Nf(),t)?e+tv(t)+r:Mi}function Wh(n,e){return n<<17|e<<2}function Po(n){return n>>17&32767}function bU(n){return(n&2)==2}function SU(n,e){return n&131071|e<<17}function q_(n){return n|2}function ca(n){return(n&131068)>>2}function o_(n,e){return n&-131069|e<<2}function AU(n){return(n&1)===1}function G_(n){return n|1}function MU(n,e,t,r,i,o){let s=o?e.classBindings:e.styleBindings,a=Po(s),l=ca(s);n[r]=t;let c=!1,d;if(Array.isArray(t)){let h=t;d=h[1],(d===null||Su(h,d)>0)&&(c=!0)}else d=t;if(i)if(l!==0){let g=Po(n[a+1]);n[r+1]=Wh(g,a),g!==0&&(n[g+1]=o_(n[g+1],r)),n[a+1]=SU(n[a+1],r)}else n[r+1]=Wh(a,0),a!==0&&(n[a+1]=o_(n[a+1],r)),a=r;else n[r+1]=Wh(l,0),a===0?a=r:n[l+1]=o_(n[l+1],r),l=r;c&&(n[r+1]=q_(n[r+1])),NS(n,d,r,!0),NS(n,d,r,!1),RU(e,d,n,r,o),s=Wh(a,l),o?e.classBindings=s:e.styleBindings=s}function RU(n,e,t,r,i){let o=i?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&Su(o,e)>=0&&(t[r+1]=G_(t[r+1]))}function NS(n,e,t,r){let i=n[t+1],o=e===null,s=r?Po(i):ca(i),a=!1;for(;s!==0&&(a===!1||o);){let l=n[s],c=n[s+1];xU(l,e)&&(a=!0,n[s+1]=r?G_(c):q_(c)),s=r?Po(c):ca(c)}a&&(n[t+1]=r?q_(i):G_(i))}function xU(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?Su(n,e)>=0:!1}function Nn(n,e,t){let r=$e(),i=Nf();if(No(r,i,e)){let o=Kt(),s=Pf();Mv(o,s,r,n,e,r[ct],t,!1)}return Nn}function PS(n,e,t,r,i){let o=e.inputs,s=i?"class":"style";Rv(n,t,o[s],s,r)}function Bv(n,e){return NU(n,e,null,!0),Bv}function NU(n,e,t,r){let i=$e(),o=Kt(),s=Ej(2);if(o.firstUpdatePass&&kU(o,n,s,r),e!==Mi&&No(i,s,e)){let a=o.data[fa()];jU(o,a,i,i[ct],n,i[s+1]=BU(e,t),r,s)}}function PU(n,e){return e>=n.expandoStartIndex}function kU(n,e,t,r){let i=n.data;if(i[t+1]===null){let o=i[fa()],s=PU(n,t);UU(o,r)&&e===null&&!s&&(e=!1),e=OU(i,o,e,r),MU(i,o,e,t,s,r)}}function OU(n,e,t,r){let i=Tj(n),o=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=s_(null,n,e,t,r),t=Tu(t,e.attrs,r),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==i)if(t=s_(i,n,e,t,r),o===null){let l=FU(n,e,r);l!==void 0&&Array.isArray(l)&&(l=s_(null,n,e,l[1],r),l=Tu(l,e.attrs,r),VU(n,e,r,l))}else o=LU(n,e,r)}return o!==void 0&&(r?e.residualClasses=o:e.residualStyles=o),t}function FU(n,e,t){let r=t?e.classBindings:e.styleBindings;if(ca(r)!==0)return n[Po(r)]}function VU(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[Po(i)]=r}function LU(n,e,t){let r,i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++){let s=n[o].hostAttrs;r=Tu(r,s,t)}return Tu(r,e.attrs,t)}function s_(n,e,t,r,i){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],r=Tu(r,o.hostAttrs,i),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function Tu(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?i=s:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),UL(n,s,t?!0:e[++o]))}return n===void 0?null:n}function jU(n,e,t,r,i,o,s,a){if(!(e.type&3))return;let l=n.data,c=l[a+1],d=AU(c)?kS(l,e,t,i,ca(c),s):void 0;if(!Ef(d)){Ef(o)||bU(c)&&(o=kS(l,null,t,i,a,s));let h=_A(fa(),t);gB(r,s,h,i,o)}}function kS(n,e,t,r,i,o){let s=e===null,a;for(;i>0;){let l=n[i],c=Array.isArray(l),d=c?l[1]:l,h=d===null,g=t[i+1];g===Mi&&(g=h?Sn:void 0);let m=h?Zy(g,r):d===r?g:void 0;if(c&&!Ef(m)&&(m=Zy(l,r)),Ef(m)&&(a=m,s))return a;let v=n[i+1];i=s?Po(v):ca(v)}if(e!==null){let l=o?e.residualClasses:e.residualStyles;l!=null&&(a=Zy(l,r))}return a}function Ef(n){return n!==void 0}function BU(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=zt(bv(n)))),n}function UU(n,e){return(n.flags&(e?8:16))!==0}function $U(n,e,t,r,i,o){let s=e.consts,a=uf(s,i),l=Uf(e,n,2,r,a);return wM(e,t,l,uf(s,o)),l.attrs!==null&&j_(l,l.attrs,!1),l.mergedAttrs!==null&&j_(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function G(n,e,t,r){let i=$e(),o=Kt(),s=Wn+n,a=i[ct],l=o.firstCreatePass?$U(s,o,i,e,t,r):o.data[s],c=HU(o,i,l,a,e,n);i[s]=c;let d=lv(l);return Mu(l,!0),pM(a,c,l),!gU(l)&&fv()&&kv(o,i,c,l),dj()===0&&Ro(c,i),hj(),d&&(yM(o,i,l),aM(o,l,i)),r!==null&&_M(i,l),G}function z(){let n=on();DA()?_j():(n=n.parent,Mu(n,!1));let e=n;gj(e)&&mj(),fj();let t=Kt();return t.firstCreatePass&&(gv(t,n),fA(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&Nj(e)&&PS(t,e,$e(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&Pj(e)&&PS(t,e,$e(),e.stylesWithoutHost,!1),z}function Fo(n,e,t,r){return G(n,e,t,r),z(),Fo}var HU=(n,e,t,r,i,o)=>(pv(!0),hM(r,i,Aj()));var Io=void 0;function qU(n){let e=n,t=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length;return t===1&&r===0?1:5}var GU=["en",[["a","p"],["AM","PM"],Io],[["AM","PM"],Io,Io],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Io,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Io,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Io,"{1} 'at' {0}",Io],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",qU],a_={};function Uv(n){let e=zU(n),t=OS(e);if(t)return t;let r=e.split("-")[0];if(t=OS(r),t)return t;if(r==="en")return GU;throw new ne(701,!1)}function OS(n){return n in a_||(a_[n]=mu.ng&&mu.ng.common&&mu.ng.common.locales&&mu.ng.common.locales[n]),a_[n]}var ma=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(ma||{});function zU(n){return n.toLowerCase().replace(/_/g,"-")}var If="en-US";var WU=If;function KU(n){typeof n=="string"&&(WU=n.toLowerCase().replace(/_/g,"-"))}var QU=(n,e,t)=>{};function an(n,e,t,r){let i=$e(),o=Kt(),s=on();return WM(o,i,i[ct],s,n,e,r),an}function YU(n,e,t,r){let i=n.cleanup;if(i!=null)for(let o=0;o<i.length-1;o+=2){let s=i[o];if(s===t&&i[o+1]===r){let a=e[of],l=i[o+2];return a.length>l?a[l]:null}typeof s=="string"&&(o+=2)}return null}function WM(n,e,t,r,i,o,s){let a=lv(r),c=n.firstCreatePass&&cj(n),d=e[cr],h=uj(e),g=!0;if(r.type&3||s){let D=xn(r,e),S=s?s(D):D,P=h.length,j=s?K=>s(hr(K[r.index])):r.index,O=null;if(!s&&a&&(O=YU(n,e,i,r.index)),O!==null){let K=O.__ngLastListenerFn__||O;K.__ngNextListenerFn__=o,O.__ngLastListenerFn__=o,g=!1}else{o=VS(r,e,d,o),QU(D,i,o);let K=t.listen(S,i,o);h.push(o,K),c&&c.push(i,j,P,P+1)}}else o=VS(r,e,d,o);let m=r.outputs,v;if(g&&m!==null&&(v=m[i])){let D=v.length;if(D)for(let S=0;S<D;S+=2){let P=v[S],j=v[S+1],ie=e[P][j].subscribe(o),ee=h.length;h.push(o,ie),c&&c.push(i,r.index,ee,-(ee+1))}}}function FS(n,e,t,r){let i=be(null);try{return An(6,e,t),t(r)!==!1}catch(o){return TM(n,o),!1}finally{An(7,e,t),be(i)}}function VS(n,e,t,r){return function i(o){if(o===Function)return r;let s=n.componentOffset>-1?Ai(n.index,e):e;Fv(s,5);let a=FS(e,t,r,o),l=i.__ngNextListenerFn__;for(;l;)a=FS(e,t,l,o)&&a,l=l.__ngNextListenerFn__;return a}}function $v(n=1){return Sj(n)}function Hv(n,e,t,r,i){let o=$e(),s=zM(o,e,t,r);if(s!==Mi){let a=Kt(),l=Pf();Mv(a,l,o,n,s,o[ct],i,!1)}return Hv}function ZU(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function Z(n,e=""){let t=$e(),r=Kt(),i=n+Wn,o=r.firstCreatePass?Uf(r,i,1,e,null):r.data[i],s=JU(r,t,o,e,n);t[i]=s,fv()&&kv(r,t,s,o),Mu(o,!1)}var JU=(n,e,t,r,i)=>(pv(!0),b2(e[ct],r));function Gr(n){return Qt("",n,""),Gr}function Qt(n,e,t){let r=$e(),i=zM(r,n,e,t);return i!==Mi&&XU(r,fa(),i),Qt}function XU(n,e,t){let r=_A(e,n);S2(n[ct],r,t)}function Vo(n,e,t){YA(e)&&(e=e());let r=$e(),i=Nf();if(No(r,i,e)){let o=Kt(),s=Pf();Mv(o,s,r,n,e,r[ct],t,!1)}return Vo}function ya(n,e){let t=YA(n);return t&&n.set(e),t}function Lo(n,e){let t=$e(),r=Kt(),i=on();return WM(r,t,t[ct],i,n,e),Lo}function e$(n,e,t){let r=Kt();if(r.firstCreatePass){let i=Ci(n);z_(t,r.data,r.blueprint,i,!0),z_(e,r.data,r.blueprint,i,!1)}}function z_(n,e,t,r,i){if(n=Gt(n),Array.isArray(n))for(let o=0;o<n.length;o++)z_(n[o],e,t,r,i);else{let o=Kt(),s=$e(),a=on(),l=ta(n)?n:Gt(n.provide),c=lA(n),d=a.providerIndexes&1048575,h=a.directiveStart,g=a.providerIndexes>>20;if(ta(n)||!n.multi){let m=new Mo(c,i,Te),v=u_(l,e,i?d:d+g,h);v===-1?(C_(ff(a,s),o,l),l_(o,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(m),s.push(m)):(t[v]=m,s[v]=m)}else{let m=u_(l,e,d+g,h),v=u_(l,e,d,d+g),D=m>=0&&t[m],S=v>=0&&t[v];if(i&&!S||!i&&!D){C_(ff(a,s),o,l);let P=r$(i?n$:t$,t.length,i,r,c);!i&&S&&(t[v].providerFactory=P),l_(o,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(P),s.push(P)}else{let P=KM(t[i?v:m],c,!i&&r);l_(o,n,m>-1?m:v,P)}!i&&r&&S&&t[v].componentProviders++}}}function l_(n,e,t,r){let i=ta(e),o=zL(e);if(i||o){let l=(o?Gt(e.useClass):e).prototype.ngOnDestroy;if(l){let c=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let d=c.indexOf(t);d===-1?c.push(t,[r,l]):c[d+1].push(r,l)}else c.push(t,l)}}}function KM(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function u_(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function t$(n,e,t,r){return W_(this.multi,[])}function n$(n,e,t,r){let i=this.multi,o;if(this.providerFactory){let s=this.providerFactory.componentProviders,a=sa(t,t[Ee],this.providerFactory.index,r);o=a.slice(0,s),W_(i,o);for(let l=s;l<a.length;l++)o.push(a[l])}else o=[],W_(i,o);return o}function W_(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function r$(n,e,t,r,i){let o=new Mo(n,t,Te);return o.multi=[],o.index=e,o.componentProviders=0,KM(o,i,r&&!t),o}function jo(n,e=[]){return t=>{t.providersResolver=(r,i)=>e$(r,i?i(n):n,e)}}function i$(n,e){let t=n[e];return t===Mi?void 0:t}function o$(n,e,t,r,i,o,s){let a=e+t;return pU(n,a,i,o)?fU(n,a+2,s?r.call(s,i,o):r(i,o)):i$(n,a+2)}function qv(n,e){let t=Kt(),r,i=n+Wn;t.firstCreatePass?(r=s$(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let o=r.factory||(r.factory=Do(r.type,!0)),s,a=rn(Te);try{let l=hf(!1),c=o();return hf(l),ZU(t,$e(),i,c),c}finally{rn(a)}}function s$(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function Gv(n,e,t,r){let i=n+Wn,o=$e(),s=oj(o,i);return a$(o,i)?o$(o,vj(),e,s.transform,t,r,s):s.transform(t,r)}function a$(n,e){return n[Ee].data[e].pure}var jr=class{full;major;minor;patch;constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},QM=new jr("19.1.3"),K_=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},zv=(()=>{class n{compileModuleSync(t){return new $_(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=tA(t),o=lM(i.declarations).reduce((s,a)=>{let l=To(a);return l&&s.push(new Cu(l)),s},[]);return new K_(r,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var l$=(()=>{class n{zone=V(Se);changeDetectionScheduler=V(aa);applicationRef=V(Si);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function u$({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new Se(pe($({},c$()),{scheduleInRootZone:t})),[{provide:Se,useFactory:n},{provide:ea,multi:!0,useFactory:()=>{let r=V(l$,{optional:!0});return()=>r.initialize()}},{provide:ea,multi:!0,useFactory:()=>{let r=V(d$);return()=>{r.initialize()}}},e===!0?{provide:GA,useValue:!0}:[],{provide:zA,useValue:t??qA}]}function c$(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var d$=(()=>{class n{subscription=new tt;initialized=!1;zone=V(Se);pendingTasks=V(ko);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Se.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Se.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var h$=(()=>{class n{appRef=V(Si);taskService=V(ko);ngZone=V(Se);zonelessEnabled=V(_v);tracing=V(Ff,{optional:!0});disableScheduling=V(GA,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new tt;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(gf):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(V(zA,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof A_||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let r=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 8:{this.appRef.deferredDirtyFlags|=8;break}case 6:{this.appRef.dirtyFlags|=2,r=!0;break}case 13:{this.appRef.dirtyFlags|=16,r=!0;break}case 14:{this.appRef.dirtyFlags|=2,r=!0;break}case 12:{r=!0;break}case 10:case 9:case 7:case 11:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(r))return;let i=this.useMicrotaskScheduler?gS:WA;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(gf+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(t),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,gS(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function f$(){return typeof $localize<"u"&&$localize.locale||If}var Hf=new Q("",{providedIn:"root",factory:()=>V(Hf,me.Optional|me.SkipSelf)||f$()});var Q_=new Q(""),p$=new Q("");function gu(n){return!n.moduleRef}function g$(n){let e=gu(n)?n.r3Injector:n.moduleRef.injector,t=e.get(Se);return t.run(()=>{gu(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(Di,null),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:o=>{r.handleError(o)}})}),gu(n)){let o=()=>e.destroy(),s=n.platformInjector.get(Q_);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(Q_);s.add(o),n.moduleRef.onDestroy(()=>{Zh(n.allPlatformModules,n.moduleRef),i.unsubscribe(),s.delete(o)})}return DU(r,t,()=>{let o=e.get(GM);return o.runInitializers(),o.donePromise.then(()=>{let s=e.get(Hf,If);if(KU(s||If),!e.get(p$,!0))return gu(n)?e.get(Si):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(gu(n)){let l=e.get(Si);return n.rootComponent!==void 0&&l.bootstrap(n.rootComponent),l}else return m$(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function m$(n,e){let t=n.injector.get(Si);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new ne(-403,!1);e.push(n)}var Jh=null;function y$(n=[],e){return pn.create({name:e,providers:[{provide:Sf,useValue:"platform"},{provide:Q_,useValue:new Set([()=>Jh=null])},...n]})}function _$(n=[]){if(Jh)return Jh;let e=y$(n);return Jh=e,EU(),v$(e),e}function v$(n){let e=n.get(Cv,null);Rn(n,()=>{e?.forEach(t=>t())})}function Nu(){return!1}var Bo=(()=>{class n{static __NG_ELEMENT_ID__=w$}return n})();function w$(n){return E$(on(),$e(),(n&16)===16)}function E$(n,e,t){if(Mf(n)&&!t){let r=Ai(n.index,e);return new xo(r,r)}else if(n.type&175){let r=e[dr];return new xo(r,e)}return null}var Y_=class{constructor(){}supports(e){return UM(e)}create(e){return new Z_(e)}},I$=(n,e)=>e,Z_=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||I$}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,o=null;for(;t||r;){let s=!r||t&&t.currentIndex<LS(r,i,o)?t:r,a=LS(s,i,o),l=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(t=t._next,s.previousIndex==null)i++;else{o||(o=[]);let c=a-i,d=l-i;if(c!=d){for(let g=0;g<c;g++){let m=g<o.length?o[g]:o[g]=0,v=m+g;d<=v&&v<c&&(o[g]=m+1)}let h=s.previousIndex;o[h]=d-c}}a!==l&&e(s,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!UM(e))throw new ne(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),r=!0):(r&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else i=0,dU(e,a=>{s=this._trackByFn(i,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,s,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new J_(t,r),o,i)),e}_verifyReinsertion(e,t,r,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return o!==null?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,o=e._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Cf),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Cf),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},J_=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},X_=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},Cf=class{map=new Map;put(e){let t=e.trackById,r=this.map.get(t);r||(r=new X_,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function LS(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function jS(){return new Wv([new Y_])}var Wv=(()=>{class n{factories;static \u0275prov=te({token:n,providedIn:"root",factory:jS});constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||jS()),deps:[[n,new jL,new bf]]}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new ne(901,!1)}}return n})();function YM(n){try{let{rootComponent:e,appProviders:t,platformProviders:r}=n,i=_$(r),o=[u$({}),{provide:aa,useExisting:h$},...t||[]],s=new wf({providers:o,parent:i,debugName:"",runEnvironmentInitializers:!1});return g$({r3Injector:s.injector,platformInjector:i,rootComponent:e})}catch(e){return Promise.reject(e)}}function qf(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function Pu(n,e){Of("NgSignals");let t=M0(n);return e?.equal&&(t[hn].equal=e.equal),t}function zr(n){let e=be(null);try{return n()}finally{be(e)}}var BS=class{[hn];constructor(e){this[hn]=e}destroy(){this[hn].destroy()}};var rR=null;function Kr(){return rR}function iR(n){rR??=n}var Gf=class{};var kn=new Q(""),oR=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:()=>V(T$),providedIn:"platform"})}return n})();var T$=(()=>{class n extends oR{_location;_history;_doc=V(kn);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Kr().getBaseHref(this._doc)}onPopState(t){let r=Kr().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=Kr().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function sR(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function ZM(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function Uo(n){return n&&n[0]!=="?"?"?"+n:n}var Kf=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:()=>V(aR),providedIn:"root"})}return n})(),b$=new Q(""),aR=(()=>{class n extends Kf{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??V(kn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return sR(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+Uo(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,o){let s=this.prepareExternalUrl(i+Uo(o));this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){let s=this.prepareExternalUrl(i+Uo(o));this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(B(oR),B(b$,8))};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Fu=(()=>{class n{_subject=new ze;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=M$(ZM(JM(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Uo(r))}normalize(t){return n.stripTrailingSlash(A$(this._basePath,JM(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Uo(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Uo(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=Uo;static joinWithSlash=sR;static stripTrailingSlash=ZM;static \u0275fac=function(r){return new(r||n)(B(Kf))};static \u0275prov=te({token:n,factory:()=>S$(),providedIn:"root"})}return n})();function S$(){return new Fu(B(Kf))}function A$(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function JM(n){return n.replace(/\/index.html$/,"")}function M$(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var lR=function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n}(lR||{});var Wr={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function ku(n,e){let t=Uv(n),r=t[ma.NumberSymbols][e];if(typeof r>"u"){if(e===Wr.CurrencyDecimal)return t[ma.NumberSymbols][Wr.Decimal];if(e===Wr.CurrencyGroup)return t[ma.NumberSymbols][Wr.Group]}return r}function R$(n,e){return Uv(n)[ma.NumberFormats][e]}var x$=/^(\d+)?\.((\d+)(-(\d+))?)?$/,XM=22,zf=".",Ou="0",N$=";",P$=",",Kv="#";function k$(n,e,t,r,i,o,s=!1){let a="",l=!1;if(!isFinite(n))a=ku(t,Wr.Infinity);else{let c=L$(n);s&&(c=V$(c));let d=e.minInt,h=e.minFrac,g=e.maxFrac;if(o){let j=o.match(x$);if(j===null)throw new Error(`${o} is not a valid digit info`);let O=j[1],K=j[3],ie=j[5];O!=null&&(d=Qv(O)),K!=null&&(h=Qv(K)),ie!=null?g=Qv(ie):K!=null&&h>g&&(g=h)}j$(c,h,g);let m=c.digits,v=c.integerLen,D=c.exponent,S=[];for(l=m.every(j=>!j);v<d;v++)m.unshift(0);for(;v<0;v++)m.unshift(0);v>0?S=m.splice(v,m.length):(S=m,m=[0]);let P=[];for(m.length>=e.lgSize&&P.unshift(m.splice(-e.lgSize,m.length).join(""));m.length>e.gSize;)P.unshift(m.splice(-e.gSize,m.length).join(""));m.length&&P.unshift(m.join("")),a=P.join(ku(t,r)),S.length&&(a+=ku(t,i)+S.join("")),D&&(a+=ku(t,Wr.Exponential)+"+"+D)}return n<0&&!l?a=e.negPre+a+e.negSuf:a=e.posPre+a+e.posSuf,a}function O$(n,e,t){let r=R$(e,lR.Decimal),i=F$(r,ku(e,Wr.MinusSign));return k$(n,i,e,Wr.Group,Wr.Decimal,t)}function F$(n,e="-"){let t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=n.split(N$),i=r[0],o=r[1],s=i.indexOf(zf)!==-1?i.split(zf):[i.substring(0,i.lastIndexOf(Ou)+1),i.substring(i.lastIndexOf(Ou)+1)],a=s[0],l=s[1]||"";t.posPre=a.substring(0,a.indexOf(Kv));for(let d=0;d<l.length;d++){let h=l.charAt(d);h===Ou?t.minFrac=t.maxFrac=d+1:h===Kv?t.maxFrac=d+1:t.posSuf+=h}let c=a.split(P$);if(t.gSize=c[1]?c[1].length:0,t.lgSize=c[2]||c[1]?(c[2]||c[1]).length:0,o){let d=i.length-t.posPre.length-t.posSuf.length,h=o.indexOf(Kv);t.negPre=o.substring(0,h).replace(/'/g,""),t.negSuf=o.slice(h+d).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}function V$(n){if(n.digits[0]===0)return n;let e=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(e===0?n.digits.push(0,0):e===1&&n.digits.push(0),n.integerLen+=2),n}function L$(n){let e=Math.abs(n)+"",t=0,r,i,o,s,a;for((i=e.indexOf(zf))>-1&&(e=e.replace(zf,"")),(o=e.search(/e/i))>0?(i<0&&(i=o),i+=+e.slice(o+1),e=e.substring(0,o)):i<0&&(i=e.length),o=0;e.charAt(o)===Ou;o++);if(o===(a=e.length))r=[0],i=1;else{for(a--;e.charAt(a)===Ou;)a--;for(i-=o,r=[],s=0;o<=a;o++,s++)r[s]=Number(e.charAt(o))}return i>XM&&(r=r.splice(0,XM-1),t=i-1,i=1),{digits:r,exponent:t,integerLen:i}}function j$(n,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let r=n.digits,i=r.length-n.integerLen,o=Math.min(Math.max(e,i),t),s=o+n.integerLen,a=r[s];if(s>0){r.splice(Math.max(n.integerLen,s));for(let h=s;h<r.length;h++)r[h]=0}else{i=Math.max(0,i),n.integerLen=1,r.length=Math.max(1,s=o+1),r[0]=0;for(let h=1;h<s;h++)r[h]=0}if(a>=5)if(s-1<0){for(let h=0;h>s;h--)r.unshift(0),n.integerLen++;r.unshift(1),n.integerLen++}else r[s-1]++;for(;i<Math.max(0,o);i++)r.push(0);let l=o!==0,c=e+n.integerLen,d=r.reduceRight(function(h,g,m,v){return g=g+h,v[m]=g<10?g:g-10,l&&(v[m]===0&&m>=c?v.pop():l=!1),g>=10?1:0},0);d&&(r.unshift(d),n.integerLen++)}function Qv(n){let e=parseInt(n);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+n);return e}function uR(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var Yv=/\s+/,eR=[],cR=(()=>{class n{_ngEl;_renderer;initialClasses=eR;rawClass;stateMap=new Map;constructor(t,r){this._ngEl=t,this._renderer=r}set klass(t){this.initialClasses=t!=null?t.trim().split(Yv):eR}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(Yv):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let i=this.stateMap.get(t);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],i=t[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split(Yv).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static \u0275fac=function(r){return new(r||n)(Te(pr),Te(qr))};static \u0275dir=_t({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var Zv=class{$implicit;ngForOf;index;count;constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},dR=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,o,s)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new Zv(i.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)r.remove(o===null?void 0:o);else if(o!==null){let a=r.get(o);r.move(a,s),tR(a,i)}});for(let i=0,o=r.length;i<o;i++){let a=r.get(i).context;a.index=i,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let o=r.get(i.currentIndex);tR(o,i)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(Te(pa),Te(Bf),Te(Wv))};static \u0275dir=_t({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function tR(n,e){n.context.$implicit=e.item}var hR=(()=>{class n{_viewContainer;_context=new Jv;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,r){this._viewContainer=t,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){nR("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){nR("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(Te(pa),Te(Bf))};static \u0275dir=_t({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),Jv=class{$implicit=null;ngIf=null};function nR(n,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${n} must be a TemplateRef, but received '${zt(e)}'.`)}function B$(n,e){return new ne(2100,!1)}var fR=(()=>{class n{_locale;constructor(t){this._locale=t}transform(t,r,i){if(!U$(t))return null;i||=this._locale;try{let o=$$(t);return O$(o,i,r)}catch(o){throw B$(n,o.message)}}static \u0275fac=function(r){return new(r||n)(Te(Hf,16))};static \u0275pipe=LM({name:"number",type:n,pure:!0})}return n})();function U$(n){return!(n==null||n===""||n!==n)}function $$(n){if(typeof n=="string"&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if(typeof n!="number")throw new Error(`${n} is not a number`);return n}var Vu=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=mn({type:n});static \u0275inj=gn({})}return n})(),pR="browser",H$="server";function $o(n){return n===H$}var Wf=class{};var ew=class extends Gf{supportsDOMEvents=!0},tw=class n extends ew{static makeCurrent(){iR(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=G$();return t==null?null:z$(t)}resetBaseElement(){Lu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return uR(document.cookie,e)}},Lu=null;function G$(){return Lu=Lu||document.querySelector("base"),Lu?Lu.getAttribute("href"):null}function z$(n){return new URL(n,document.baseURI).pathname}var W$=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac})}return n})(),nw=new Q(""),wR=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i,o){return this._findPluginFor(r).addEventListener(t,r,i,o)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(o=>o.supports(t)),!r)throw new ne(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(B(nw),B(Se))};static \u0275prov=te({token:n,factory:n.\u0275fac})}return n})(),Yf=class{_doc;constructor(e){this._doc=e}manager},Qf="ng-app-id";function gR(n){for(let e of n)e.remove()}function mR(n,e){let t=e.createElement("style");return t.textContent=n,t}function K$(n,e,t,r){let i=n.head?.querySelectorAll(`style[${Qf}="${e}"],link[${Qf}="${e}"]`);if(i)for(let o of i)o.removeAttribute(Qf),o instanceof HTMLLinkElement?r.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function rw(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var ER=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,r,i,o={}){this.doc=t,this.appId=r,this.nonce=i,this.isServer=$o(o),K$(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,mR);r?.forEach(i=>this.addUsage(i,this.external,rw))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let o=r.get(t);o?o.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(gR(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])gR(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,mR(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,rw(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),this.isServer&&r.setAttribute(Qf,this.appId),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(B(kn),B(Iv),B(Dv,8),B(sn))};static \u0275prov=te({token:n,factory:n.\u0275fac})}return n})(),Xv={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},ow=/%COMP%/g,IR="%COMP%",Q$=`_nghost-${IR}`,Y$=`_ngcontent-${IR}`,Z$=!0,J$=new Q("",{providedIn:"root",factory:()=>Z$});function X$(n){return Y$.replace(ow,n)}function eH(n){return Q$.replace(ow,n)}function CR(n,e){return e.map(t=>t.replace(ow,n))}var yR=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,i,o,s,a,l,c=null,d=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=l,this.nonce=c,this.tracingService=d,this.platformIsServer=$o(a),this.defaultRenderer=new ju(t,s,l,this.platformIsServer,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===fr.ShadowDom&&(r=pe($({},r),{encapsulation:fr.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof Zf?i.applyToHost(t):i instanceof Bu&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,o=i.get(r.id);if(!o){let s=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(r.encapsulation){case fr.Emulated:o=new Zf(l,c,r,this.appId,d,s,a,h,this.tracingService);break;case fr.ShadowDom:return new iw(l,c,t,r,s,a,this.nonce,h,this.tracingService);default:o=new Bu(l,c,r,d,s,a,h,this.tracingService);break}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(B(wR),B(ER),B(Iv),B(J$),B(kn),B(sn),B(Se),B(Dv),B(Ff,8))};static \u0275prov=te({token:n,factory:n.\u0275fac})}return n})(),ju=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i,o){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(Xv[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(_R(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(_R(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new ne(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let o=Xv[i];o?e.setAttributeNS(o,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=Xv[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Lr.DashCase|Lr.Important)?e.style.setProperty(t,r,i&Lr.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Lr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=Kr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);let o=this.decoratePreventDefault(r);return this.tracingService!==null&&this.tracingService.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function _R(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var iw=class extends ju{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,r,i,o,s,a,l,c){super(e,o,s,l,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let d=CR(i.id,i.styles);for(let g of d){let m=document.createElement("style");a&&m.setAttribute("nonce",a),m.textContent=g,this.shadowRoot.appendChild(m)}let h=i.getExternalStyles?.();if(h)for(let g of h){let m=rw(g,o);a&&m.setAttribute("nonce",a),this.shadowRoot.appendChild(m)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Bu=class extends ju{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,o,s,a,l,c){super(e,o,s,a,l),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?CR(c,r.styles):r.styles,this.styleUrls=r.getExternalStyles?.(c)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Zf=class extends Bu{contentAttr;hostAttr;constructor(e,t,r,i,o,s,a,l,c){let d=i+"-"+r.id;super(e,t,r,o,s,a,l,c,d),this.contentAttr=X$(d),this.hostAttr=eH(d)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},tH=(()=>{class n extends Yf{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,o){return t.addEventListener(r,i,o),()=>this.removeEventListener(t,r,i,o)}removeEventListener(t,r,i,o){return t.removeEventListener(r,i,o)}static \u0275fac=function(r){return new(r||n)(B(kn))};static \u0275prov=te({token:n,factory:n.\u0275fac})}return n})(),vR=["alt","control","meta","shift"],nH={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},rH={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},iH=(()=>{class n extends Yf{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,o){let s=n.parseEventName(r),a=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Kr().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let o=n._normalizeKey(r.pop()),s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),vR.forEach(c=>{let d=r.indexOf(c);d>-1&&(r.splice(d,1),s+=c+".")}),s+=o,r.length!=0||o.length===0)return null;let l={};return l.domEventName=i,l.fullKey=s,l}static matchEventFullKeyCode(t,r){let i=nH[t.key]||t.key,o="";return r.indexOf("code.")>-1&&(i=t.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),vR.forEach(s=>{if(s!==i){let a=rH[s];a(t)&&(o+=s+".")}}),o+=i,o===r)}static eventCallback(t,r,i){return o=>{n.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>r(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(B(kn))};static \u0275prov=te({token:n,factory:n.\u0275fac})}return n})();function DR(n,e){return YM($({rootComponent:n},oH(e)))}function oH(n){return{appProviders:[...cH,...n?.providers??[]],platformProviders:uH}}function sH(){tw.makeCurrent()}function aH(){return new Di}function lH(){return rM(document),document}var uH=[{provide:sn,useValue:pR},{provide:Cv,useValue:sH,multi:!0},{provide:kn,useFactory:lH,deps:[]}];var cH=[{provide:Sf,useValue:"root"},{provide:Di,useFactory:aH,deps:[]},{provide:nw,useClass:tH,multi:!0,deps:[kn,Se,sn]},{provide:nw,useClass:iH,multi:!0,deps:[kn]},yR,ER,wR,{provide:ua,useExisting:yR},{provide:Wf,useClass:W$,deps:[]},[]];var TR=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)(B(kn))};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var ge="primary",nc=Symbol("RouteTitle"),cw=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Ca(n){return new cw(n)}function hH(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let o=0;o<r.length;o++){let s=r[o],a=n[o];if(s[0]===":")i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function fH(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!mr(n[t],e[t]))return!1;return!0}function mr(n,e){let t=n?dw(n):void 0,r=e?dw(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!PR(n[i],e[i]))return!1;return!0}function dw(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function PR(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,o)=>r[o]===i)}else return n===e}function kR(n){return n.length>0?n[n.length-1]:null}function Ri(n){return qy(n)?n:Oo(n)?ke(Promise.resolve(n)):re(n)}var pH={exact:FR,subset:VR},OR={exact:gH,subset:mH,ignored:()=>!0};function bR(n,e,t){return pH[t.paths](n.root,e.root,t.matrixParams)&&OR[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function gH(n,e){return mr(n,e)}function FR(n,e,t){if(!qo(n.segments,e.segments)||!ep(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!FR(n.children[r],e.children[r],t))return!1;return!0}function mH(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>PR(n[t],e[t]))}function VR(n,e,t){return LR(n,e,e.segments,t)}function LR(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!qo(i,t)||e.hasChildren()||!ep(i,t,r))}else if(n.segments.length===t.length){if(!qo(n.segments,t)||!ep(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!VR(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!qo(n.segments,i)||!ep(n.segments,i,r)||!n.children[ge]?!1:LR(n.children[ge],e,o,r)}}function ep(n,e,t){return e.every((r,i)=>OR[t](n[i].parameters,r.parameters))}var Yr=class{root;queryParams;fragment;_queryParamMap;constructor(e=new Oe([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Ca(this.queryParams),this._queryParamMap}toString(){return vH.serialize(this)}},Oe=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return tp(this)}},Ho=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Ca(this.parameters),this._parameterMap}toString(){return BR(this)}};function yH(n,e){return qo(n,e)&&n.every((t,r)=>mr(t.parameters,e[r].parameters))}function qo(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function _H(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===ge&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==ge&&(t=t.concat(e(i,r)))}),t}var Vw=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:()=>new zu,providedIn:"root"})}return n})(),zu=class{parse(e){let t=new fw(e);return new Yr(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Uu(e.root,!0)}`,r=IH(e.queryParams),i=typeof e.fragment=="string"?`#${wH(e.fragment)}`:"";return`${t}${r}${i}`}},vH=new zu;function tp(n){return n.segments.map(e=>BR(e)).join("/")}function Uu(n,e){if(!n.hasChildren())return tp(n);if(e){let t=n.children[ge]?Uu(n.children[ge],!1):"",r=[];return Object.entries(n.children).forEach(([i,o])=>{i!==ge&&r.push(`${i}:${Uu(o,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=_H(n,(r,i)=>i===ge?[Uu(n.children[ge],!1)]:[`${i}:${Uu(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[ge]!=null?`${tp(n)}/${t[0]}`:`${tp(n)}/(${t.join("//")})`}}function jR(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Jf(n){return jR(n).replace(/%3B/gi,";")}function wH(n){return encodeURI(n)}function hw(n){return jR(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function np(n){return decodeURIComponent(n)}function SR(n){return np(n.replace(/\+/g,"%20"))}function BR(n){return`${hw(n.path)}${EH(n.parameters)}`}function EH(n){return Object.entries(n).map(([e,t])=>`;${hw(e)}=${hw(t)}`).join("")}function IH(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Jf(t)}=${Jf(i)}`).join("&"):`${Jf(t)}=${Jf(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var CH=/^[^\/()?;#]+/;function sw(n){let e=n.match(CH);return e?e[0]:""}var DH=/^[^\/()?;=#]+/;function TH(n){let e=n.match(DH);return e?e[0]:""}var bH=/^[^=?&#]+/;function SH(n){let e=n.match(bH);return e?e[0]:""}var AH=/^[^&#]+/;function MH(n){let e=n.match(AH);return e?e[0]:""}var fw=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Oe([],{}):new Oe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[ge]=new Oe(e,t)),r}parseSegment(){let e=sw(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new ne(4009,!1);return this.capture(e),new Ho(np(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=TH(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=sw(this.remaining);i&&(r=i,this.capture(r))}e[np(t)]=np(r)}parseQueryParam(e){let t=SH(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let s=MH(this.remaining);s&&(r=s,this.capture(r))}let i=SR(t),o=SR(r);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=sw(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new ne(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=ge);let s=this.parseChildren();t[o]=Object.keys(s).length===1?s[ge]:new Oe([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new ne(4011,!1)}};function UR(n){return n.segments.length>0?new Oe([],{[ge]:n}):n}function $R(n){let e={};for(let[r,i]of Object.entries(n.children)){let o=$R(i);if(r===ge&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[r]=o)}let t=new Oe(n.segments,e);return RH(t)}function RH(n){if(n.numberOfChildren===1&&n.children[ge]){let e=n.children[ge];return new Oe(n.segments.concat(e.segments),e.children)}return n}function Wu(n){return n instanceof Yr}function xH(n,e,t=null,r=null){let i=HR(n);return qR(i,e,t,r)}function HR(n){let e;function t(o){let s={};for(let l of o.children){let c=t(l);s[l.outlet]=c}let a=new Oe(o.url,s);return o===n&&(e=a),a}let r=t(n.root),i=UR(r);return e??i}function qR(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return aw(i,i,i,t,r);let o=NH(e);if(o.toRoot())return aw(i,i,new Oe([],{}),t,r);let s=PH(o,i,n),a=s.processChildren?Hu(s.segmentGroup,s.index,o.commands):zR(s.segmentGroup,s.index,o.commands);return aw(i,s.segmentGroup,a,t,r)}function rp(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Ku(n){return typeof n=="object"&&n!=null&&n.outlets}function aw(n,e,t,r,i){let o={};r&&Object.entries(r).forEach(([l,c])=>{o[l]=Array.isArray(c)?c.map(d=>`${d}`):`${c}`});let s;n===e?s=t:s=GR(n,e,t);let a=UR($R(s));return new Yr(a,o,i)}function GR(n,e,t){let r={};return Object.entries(n.children).forEach(([i,o])=>{o===e?r[i]=t:r[i]=GR(o,e,t)}),new Oe(n.segments,r)}var ip=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&rp(r[0]))throw new ne(4003,!1);let i=r.find(Ku);if(i&&i!==kR(r))throw new ne(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function NH(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new ip(!0,0,n);let e=0,t=!1,r=n.reduce((i,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([l,c])=>{a[l]=typeof c=="string"?c.split("/"):c}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:s===0?(o.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,o]},[]);return new ip(t,e,r)}var wa=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function PH(n,e,t){if(n.isAbsolute)return new wa(e,!0,0);if(!t)return new wa(e,!1,NaN);if(t.parent===null)return new wa(t,!0,0);let r=rp(n.commands[0])?0:1,i=t.segments.length-1+r;return kH(t,i,n.numberOfDoubleDots)}function kH(n,e,t){let r=n,i=e,o=t;for(;o>i;){if(o-=i,r=r.parent,!r)throw new ne(4005,!1);i=r.segments.length}return new wa(r,!1,i-o)}function OH(n){return Ku(n[0])?n[0].outlets:{[ge]:n}}function zR(n,e,t){if(n??=new Oe([],{}),n.segments.length===0&&n.hasChildren())return Hu(n,e,t);let r=FH(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let o=new Oe(n.segments.slice(0,r.pathIndex),{});return o.children[ge]=new Oe(n.segments.slice(r.pathIndex),n.children),Hu(o,0,i)}else return r.match&&i.length===0?new Oe(n.segments,{}):r.match&&!n.hasChildren()?pw(n,e,t):r.match?Hu(n,0,i):pw(n,e,t)}function Hu(n,e,t){if(t.length===0)return new Oe(n.segments,{});{let r=OH(t),i={};if(Object.keys(r).some(o=>o!==ge)&&n.children[ge]&&n.numberOfChildren===1&&n.children[ge].segments.length===0){let o=Hu(n.children[ge],e,t);return new Oe(n.segments,o.children)}return Object.entries(r).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[o]=zR(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{r[o]===void 0&&(i[o]=s)}),new Oe(n.segments,i)}}function FH(n,e,t){let r=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return o;let s=n.segments[i],a=t[r];if(Ku(a))break;let l=`${a}`,c=r<t.length-1?t[r+1]:null;if(i>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!MR(l,c,s))return o;r+=2}else{if(!MR(l,{},s))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function pw(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let o=t[i];if(Ku(o)){let l=VH(o.outlets);return new Oe(r,l)}if(i===0&&rp(t[0])){let l=n.segments[e];r.push(new Ho(l.path,AR(t[0]))),i++;continue}let s=Ku(o)?o.outlets[ge]:`${o}`,a=i<t.length-1?t[i+1]:null;s&&a&&rp(a)?(r.push(new Ho(s,AR(a))),i+=2):(r.push(new Ho(s,{})),i++)}return new Oe(r,{})}function VH(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=pw(new Oe([],{}),0,r))}),e}function AR(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function MR(n,e,t){return n==t.path&&mr(e,t.parameters)}var qu="imperative",Rt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Rt||{}),On=class{id;url;constructor(e,t){this.id=e,this.url=t}},Qu=class extends On{type=Rt.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Go=class extends On{urlAfterRedirects;type=Rt.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},_n=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(_n||{}),gw=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(gw||{}),Qr=class extends On{reason;code;type=Rt.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},zo=class extends On{reason;code;type=Rt.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},Yu=class extends On{error;target;type=Rt.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},op=class extends On{urlAfterRedirects;state;type=Rt.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},mw=class extends On{urlAfterRedirects;state;type=Rt.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},yw=class extends On{urlAfterRedirects;state;shouldActivate;type=Rt.GuardsCheckEnd;constructor(e,t,r,i,o){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},_w=class extends On{urlAfterRedirects;state;type=Rt.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},vw=class extends On{urlAfterRedirects;state;type=Rt.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ww=class{route;type=Rt.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Ew=class{route;type=Rt.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Iw=class{snapshot;type=Rt.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Cw=class{snapshot;type=Rt.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Dw=class{snapshot;type=Rt.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Tw=class{snapshot;type=Rt.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Zu=class{},Da=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function LH(n,e){return n.providers&&!n._injector&&(n._injector=Vv(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Qn(n){return n.outlet||ge}function jH(n,e){let t=n.filter(r=>Qn(r)===e);return t.push(...n.filter(r=>Qn(r)!==e)),t}function rc(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var bw=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return rc(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new hp(this.rootInjector)}},hp=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new bw(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)(B(it))};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),sp=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Sw(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Sw(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Aw(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Aw(e,this._root).map(t=>t.value)}};function Sw(n,e){if(n===e.value)return e;for(let t of e.children){let r=Sw(n,t);if(r)return r}return null}function Aw(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Aw(n,t);if(r.length)return r.unshift(e),r}return[]}var yn=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function va(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var ap=class extends sp{snapshot;constructor(e,t){super(e),this.snapshot=t,Lw(this,e)}toString(){return this.snapshot.toString()}};function WR(n){let e=BH(n),t=new St([new Ho("",{})]),r=new St({}),i=new St({}),o=new St({}),s=new St(""),a=new Ta(t,r,o,s,i,ge,n,e.root);return a.snapshot=e.root,new ap(new yn(a,[]),e)}function BH(n){let e={},t={},r={},i="",o=new Ea([],e,r,i,t,ge,n,null,{});return new up("",new yn(o,[]))}var Ta=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,o,s,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(J(c=>c[nc]))??re(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(J(e=>Ca(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(J(e=>Ca(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function lp(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:$($({},e.params),n.params),data:$($({},e.data),n.data),resolve:$($($($({},n.data),e.data),i?.data),n._resolvedData)}:r={params:$({},n.params),data:$({},n.data),resolve:$($({},n.data),n._resolvedData??{})},i&&QR(i)&&(r.resolve[nc]=i.title),r}var Ea=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[nc]}constructor(e,t,r,i,o,s,a,l,c){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Ca(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Ca(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},up=class extends sp{url;constructor(e,t){super(t),this.url=e,Lw(this,t)}toString(){return KR(this._root)}};function Lw(n,e){e.value._routerState=n,e.children.forEach(t=>Lw(n,t))}function KR(n){let e=n.children.length>0?` { ${n.children.map(KR).join(", ")} } `:"";return`${n.value}${e}`}function lw(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,mr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),mr(e.params,t.params)||n.paramsSubject.next(t.params),fH(e.url,t.url)||n.urlSubject.next(t.url),mr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Mw(n,e){let t=mr(n.params,e.params)&&yH(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Mw(n.parent,e.parent))}function QR(n){return typeof n.title=="string"||n.title===null}var UH=new Q(""),jw=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=ge;activateEvents=new Mt;deactivateEvents=new Mt;attachEvents=new Mt;detachEvents=new Mt;routerOutletData=QA(void 0);parentContexts=V(hp);location=V(pa);changeDetector=V(Bo);inputBinder=V(Bw,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ne(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ne(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ne(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new ne(4013,!1);this._activatedRoute=t;let i=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new Rw(t,a,i.injector,this.routerOutletData);this.activated=i.createComponent(s,{index:i.length,injector:l,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=_t({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[ha]})}return n})(),Rw=class n{route;childContexts;parent;outletData;__ngOutletInjector(e){return new n(this.route,this.childContexts,e,this.outletData)}constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===Ta?this.route:e===hp?this.childContexts:e===UH?this.outletData:this.parent.get(e,t)}},Bw=new Q("");function $H(n,e,t){let r=Ju(n,e._root,t?t._root:void 0);return new ap(r,e)}function Ju(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=HH(n,e,t);return new yn(r,i)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>Ju(n,a)),s}}let r=qH(e.value),i=e.children.map(o=>Ju(n,o));return new yn(r,i)}}function HH(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Ju(n,r,i);return Ju(n,r)})}function qH(n){return new Ta(new St(n.url),new St(n.params),new St(n.queryParams),new St(n.fragment),new St(n.data),n.outlet,n.component,n)}var Xu=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},YR="ngNavigationCancelingError";function cp(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Wu(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=ZR(!1,_n.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function ZR(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[YR]=!0,t.cancellationCode=e,t}function GH(n){return JR(n)&&Wu(n.url)}function JR(n){return!!n&&n[YR]}var zH=(n,e,t,r)=>J(i=>(new xw(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),xw=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),lw(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=va(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,i[s],r),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(i===o)if(i.component){let s=r.getContext(i.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,r);else o&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=va(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(r&&r.outlet){let s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=va(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=va(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new Tw(o.value.snapshot))}),e.children.length&&this.forwardEvent(new Cw(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(lw(i),i===o)if(i.component){let s=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let s=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),lw(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=i,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,r)}},dp=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ia=class{component;route;constructor(e,t){this.component=e,this.route=t}};function WH(n,e,t){let r=n._root,i=e?e._root:null;return $u(r,i,t,[r.value])}function KH(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Sa(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!GS(n)?n:e.get(n):r}function $u(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=va(e);return n.children.forEach(s=>{QH(s,o[s.value.outlet],t,r.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>Gu(a,t.getContext(s),i)),i}function QH(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let l=YH(s,o,o.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new dp(r)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?$u(n,e,a?a.children:null,r,i):$u(n,e,t,r,i),l&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Ia(a.outlet.component,s))}else s&&Gu(e,a,i),i.canActivateChecks.push(new dp(r)),o.component?$u(n,null,a?a.children:null,r,i):$u(n,null,t,r,i);return i}function YH(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!qo(n.url,e.url);case"pathParamsOrQueryParamsChange":return!qo(n.url,e.url)||!mr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Mw(n,e)||!mr(n.queryParams,e.queryParams);case"paramsChange":default:return!Mw(n,e)}}function Gu(n,e,t){let r=va(n),i=n.value;Object.entries(r).forEach(([o,s])=>{i.component?e?Gu(s,e.children.getContext(o),t):Gu(s,null,t):Gu(s,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Ia(e.outlet.component,i)):t.canDeactivateChecks.push(new Ia(null,i)):t.canDeactivateChecks.push(new Ia(null,i))}function ic(n){return typeof n=="function"}function ZH(n){return typeof n=="boolean"}function JH(n){return n&&ic(n.canLoad)}function XH(n){return n&&ic(n.canActivate)}function eq(n){return n&&ic(n.canActivateChild)}function tq(n){return n&&ic(n.canDeactivate)}function nq(n){return n&&ic(n.canMatch)}function XR(n){return n instanceof Fr||n?.name==="EmptyError"}var Xf=Symbol("INITIAL_VALUE");function ba(){return Ye(n=>Bh(n.map(e=>e.pipe(Vr(1),Eo(Xf)))).pipe(J(e=>{for(let t of e)if(t!==!0){if(t===Xf)return Xf;if(t===!1||rq(t))return t}return!0}),Vt(e=>e!==Xf),Vr(1)))}function rq(n){return Wu(n)||n instanceof Xu}function iq(n,e){return yt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?re(pe($({},t),{guardsResult:!0})):oq(s,r,i,n).pipe(yt(a=>a&&ZH(a)?sq(r,o,n,e):re(a)),J(a=>pe($({},t),{guardsResult:a})))})}function oq(n,e,t,r){return ke(n).pipe(yt(i=>dq(i.component,i.route,t,e,r)),qn(i=>i!==!0,!0))}function sq(n,e,t,r){return ke(e).pipe(zs(i=>qs(lq(i.route.parent,r),aq(i.route,r),cq(n,i.path,t),uq(n,i.route,t))),qn(i=>i!==!0,!0))}function aq(n,e){return n!==null&&e&&e(new Dw(n)),re(!0)}function lq(n,e){return n!==null&&e&&e(new Iw(n)),re(!0)}function uq(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return re(!0);let i=r.map(o=>Uh(()=>{let s=rc(e)??t,a=Sa(o,s),l=XH(a)?a.canActivate(e,n):Rn(s,()=>a(e,n));return Ri(l).pipe(qn())}));return re(i).pipe(ba())}function cq(n,e,t){let r=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>KH(s)).filter(s=>s!==null).map(s=>Uh(()=>{let a=s.guards.map(l=>{let c=rc(s.node)??t,d=Sa(l,c),h=eq(d)?d.canActivateChild(r,n):Rn(c,()=>d(r,n));return Ri(h).pipe(qn())});return re(a).pipe(ba())}));return re(o).pipe(ba())}function dq(n,e,t,r,i){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return re(!0);let s=o.map(a=>{let l=rc(e)??i,c=Sa(a,l),d=tq(c)?c.canDeactivate(n,e,t,r):Rn(l,()=>c(n,e,t,r));return Ri(d).pipe(qn())});return re(s).pipe(ba())}function hq(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return re(!0);let o=i.map(s=>{let a=Sa(s,n),l=JH(a)?a.canLoad(e,t):Rn(n,()=>a(e,t));return Ri(l)});return re(o).pipe(ba(),ex(r))}function ex(n){return Ly(At(e=>{if(typeof e!="boolean")throw cp(n,e)}),J(e=>e===!0))}function fq(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return re(!0);let o=i.map(s=>{let a=Sa(s,n),l=nq(a)?a.canMatch(e,t):Rn(n,()=>a(e,t));return Ri(l)});return re(o).pipe(ba(),ex(r))}var ec=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},tc=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function _a(n){return Hs(new ec(n))}function pq(n){return Hs(new ne(4e3,!1))}function gq(n){return Hs(ZR(!1,_n.GuardRejected))}var Nw=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return re(r);if(i.numberOfChildren>1||!i.children[ge])return pq(`${e.redirectTo}`);i=i.children[ge]}}applyRedirectCommands(e,t,r,i,o){if(typeof t!="string"){let a=t,{queryParams:l,fragment:c,routeConfig:d,url:h,outlet:g,params:m,data:v,title:D}=i,S=Rn(o,()=>a({params:m,data:v,queryParams:l,fragment:c,routeConfig:d,url:h,outlet:g,title:D}));if(S instanceof Yr)throw new tc(S);t=S}let s=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new tc(s);return s}applyRedirectCreateUrlTree(e,t,r,i){let o=this.createSegmentGroup(e,t.root,r,i);return new Yr(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);r[i]=t[a]}else r[i]=o}),r}createSegmentGroup(e,t,r,i){let o=this.createSegments(e,t.segments,r,i),s={};return Object.entries(t.children).forEach(([a,l])=>{s[a]=this.createSegmentGroup(e,l,r,i)}),new Oe(o,s)}createSegments(e,t,r,i){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,i):this.findOrReturn(o,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new ne(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Pw={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function mq(n,e,t,r,i){let o=tx(n,e,t);return o.matched?(r=LH(e,r),fq(r,e,t,i).pipe(J(s=>s===!0?o:$({},Pw)))):re(o)}function tx(n,e,t){if(e.path==="**")return yq(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?$({},Pw):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||hH)(t,n,e);if(!i)return $({},Pw);let o={};Object.entries(i.posParams??{}).forEach(([a,l])=>{o[a]=l.path});let s=i.consumed.length>0?$($({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function yq(n){return{matched:!0,parameters:n.length>0?kR(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function RR(n,e,t,r){return t.length>0&&wq(n,t,r)?{segmentGroup:new Oe(e,vq(r,new Oe(t,n.children))),slicedSegments:[]}:t.length===0&&Eq(n,t,r)?{segmentGroup:new Oe(n.segments,_q(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Oe(n.segments,n.children),slicedSegments:t}}function _q(n,e,t,r){let i={};for(let o of t)if(fp(n,e,o)&&!r[Qn(o)]){let s=new Oe([],{});i[Qn(o)]=s}return $($({},r),i)}function vq(n,e){let t={};t[ge]=e;for(let r of n)if(r.path===""&&Qn(r)!==ge){let i=new Oe([],{});t[Qn(r)]=i}return t}function wq(n,e,t){return t.some(r=>fp(n,e,r)&&Qn(r)!==ge)}function Eq(n,e,t){return t.some(r=>fp(n,e,r))}function fp(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function Iq(n,e,t){return e.length===0&&!n.children[t]}var kw=class{};function Cq(n,e,t,r,i,o,s="emptyOnly"){return new Ow(n,e,t,r,i,s,o).recognize()}var Dq=31,Ow=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new Nw(this.urlSerializer,this.urlTree)}noMatchError(e){return new ne(4002,`'${e.segmentGroup}'`)}recognize(){let e=RR(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(J(({children:t,rootSnapshot:r})=>{let i=new yn(r,t),o=new up("",i),s=xH(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let t=new Ea([],Object.freeze({}),Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),ge,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,ge,t).pipe(J(r=>({children:r,rootSnapshot:t})),yi(r=>{if(r instanceof tc)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof ec?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,o){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,o):this.processSegment(e,t,r,r.segments,i,!0,o).pipe(J(s=>s instanceof yn?[s]:[]))}processChildren(e,t,r,i){let o=[];for(let s of Object.keys(r.children))s==="primary"?o.unshift(s):o.push(s);return ke(o).pipe(zs(s=>{let a=r.children[s],l=jH(t,s);return this.processSegmentGroup(e,l,a,s,i)}),lr((s,a)=>(s.push(...a),s)),_i(null),zy(),yt(s=>{if(s===null)return _a(r);let a=nx(s);return Tq(a),re(a)}))}processSegment(e,t,r,i,o,s,a){return ke(t).pipe(zs(l=>this.processSegmentAgainstRoute(l._injector??e,t,l,r,i,o,s,a).pipe(yi(c=>{if(c instanceof ec)return re(null);throw c}))),qn(l=>!!l),yi(l=>{if(XR(l))return Iq(r,i,o)?re(new kw):_a(r);throw l}))}processSegmentAgainstRoute(e,t,r,i,o,s,a,l){return Qn(r)!==s&&(s===ge||!fp(i,o,r))?_a(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,o,s,l):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,o,s,l):_a(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,o,s,a){let{matched:l,parameters:c,consumedSegments:d,positionalParamSegments:h,remainingSegments:g}=tx(t,i,o);if(!l)return _a(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Dq&&(this.allowRedirects=!1));let m=new Ea(o,c,Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,xR(i),Qn(i),i.component??i._loadedComponent??null,i,NR(i)),v=lp(m,a,this.paramsInheritanceStrategy);m.params=Object.freeze(v.params),m.data=Object.freeze(v.data);let D=this.applyRedirects.applyRedirectCommands(d,i.redirectTo,h,m,e);return this.applyRedirects.lineralizeSegments(i,D).pipe(yt(S=>this.processSegment(e,r,t,S.concat(g),s,!1,a)))}matchSegmentAgainstRoute(e,t,r,i,o,s){let a=mq(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(Ye(l=>l.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Ye(({routes:c})=>{let d=r._loadedInjector??e,{parameters:h,consumedSegments:g,remainingSegments:m}=l,v=new Ea(g,h,Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,xR(r),Qn(r),r.component??r._loadedComponent??null,r,NR(r)),D=lp(v,s,this.paramsInheritanceStrategy);v.params=Object.freeze(D.params),v.data=Object.freeze(D.data);let{segmentGroup:S,slicedSegments:P}=RR(t,g,m,c);if(P.length===0&&S.hasChildren())return this.processChildren(d,c,S,v).pipe(J(O=>new yn(v,O)));if(c.length===0&&P.length===0)return re(new yn(v,[]));let j=Qn(r)===o;return this.processSegment(d,c,S,P,j?ge:o,!0,v).pipe(J(O=>new yn(v,O instanceof yn?[O]:[])))}))):_a(t)))}getChildConfig(e,t,r){return t.children?re({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?re({routes:t._loadedRoutes,injector:t._loadedInjector}):hq(e,t,r,this.urlSerializer).pipe(yt(i=>i?this.configLoader.loadChildren(e,t).pipe(At(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):gq(t))):re({routes:[],injector:e})}};function Tq(n){n.sort((e,t)=>e.value.outlet===ge?-1:t.value.outlet===ge?1:e.value.outlet.localeCompare(t.value.outlet))}function bq(n){let e=n.value.routeConfig;return e&&e.path===""}function nx(n){let e=[],t=new Set;for(let r of n){if(!bq(r)){e.push(r);continue}let i=e.find(o=>r.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=nx(r.children);e.push(new yn(r.value,i))}return e.filter(r=>!t.has(r))}function xR(n){return n.data||{}}function NR(n){return n.resolve||{}}function Sq(n,e,t,r,i,o){return yt(s=>Cq(n,e,t,r,s.extractedUrl,i,o).pipe(J(({state:a,tree:l})=>pe($({},s),{targetSnapshot:a,urlAfterRedirects:l}))))}function Aq(n,e){return yt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return re(t);let o=new Set(i.map(l=>l.route)),s=new Set;for(let l of o)if(!s.has(l))for(let c of rx(l))s.add(c);let a=0;return ke(s).pipe(zs(l=>o.has(l)?Mq(l,r,n,e):(l.data=lp(l,l.parent,n).resolve,re(void 0))),At(()=>a++),Ws(1),yt(l=>a===s.size?re(t):qt))})}function rx(n){let e=n.children.map(t=>rx(t)).flat();return[n,...e]}function Mq(n,e,t,r){let i=n.routeConfig,o=n._resolve;return i?.title!==void 0&&!QR(i)&&(o[nc]=i.title),Rq(o,n,e,r).pipe(J(s=>(n._resolvedData=s,n.data=lp(n,n.parent,t).resolve,null)))}function Rq(n,e,t,r){let i=dw(n);if(i.length===0)return re({});let o={};return ke(i).pipe(yt(s=>xq(n[s],e,t,r).pipe(qn(),At(a=>{if(a instanceof Xu)throw cp(new zu,a);o[s]=a}))),Ws(1),J(()=>o),yi(s=>XR(s)?qt:Hs(s)))}function xq(n,e,t,r){let i=rc(e)??r,o=Sa(n,i),s=o.resolve?o.resolve(e,t):Rn(i,()=>o(e,t));return Ri(s)}function uw(n){return Ye(e=>{let t=n(e);return t?ke(t).pipe(J(()=>e)):re(e)})}var ix=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===ge);return r}getResolvedTitleForRoute(t){return t.data[nc]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:()=>V(Nq),providedIn:"root"})}return n})(),Nq=(()=>{class n extends ix{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(B(TR))};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Uw=new Q("",{providedIn:"root",factory:()=>({})}),Pq=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=ga({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&Fo(0,"router-outlet")},dependencies:[jw],encapsulation:2})}return n})();function $w(n){let e=n.children&&n.children.map($w),t=e?pe($({},n),{children:e}):$({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==ge&&(t.component=Pq),t}var Hw=new Q(""),kq=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=V(zv);loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return re(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=Ri(t.loadComponent()).pipe(J(ox),At(o=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=o}),hu(()=>{this.componentLoaders.delete(t)})),i=new Ls(r,()=>new ze).pipe(Vs());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return re({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=Oq(r,this.compiler,t,this.onLoadEndListener).pipe(hu(()=>{this.childrenLoaders.delete(r)})),s=new Ls(o,()=>new ze).pipe(Vs());return this.childrenLoaders.set(r,s),s}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Oq(n,e,t,r){return Ri(n.loadChildren()).pipe(J(ox),yt(i=>i instanceof Du||Array.isArray(i)?re(i):ke(e.compileModuleAsync(i))),J(i=>{r&&r(n);let o,s,a=!1;return Array.isArray(i)?(s=i,a=!0):(o=i.create(t).injector,s=o.get(Hw,[],{optional:!0,self:!0}).flat()),{routes:s.map($w),injector:o}}))}function Fq(n){return n&&typeof n=="object"&&"default"in n}function ox(n){return Fq(n)?n.default:n}var qw=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:()=>V(Vq),providedIn:"root"})}return n})(),Vq=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Lq=new Q("");var jq=new Q(""),Bq=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new ze;transitionAbortSubject=new ze;configLoader=V(kq);environmentInjector=V(it);urlSerializer=V(Vw);rootContexts=V(hp);location=V(Fu);inputBindingEnabled=V(Bw,{optional:!0})!==null;titleStrategy=V(ix);options=V(Uw,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=V(qw);createViewTransition=V(Lq,{optional:!0});navigationErrorHandler=V(jq,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>re(void 0);rootComponentType=null;constructor(){let t=i=>this.events.next(new ww(i)),r=i=>this.events.next(new Ew(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(pe($($({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new St({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:qu,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Vt(o=>o.id!==0),J(o=>pe($({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Ye(o=>{let s=!1,a=!1;return re(o).pipe(Ye(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",_n.SupersededByNewNavigation),qt;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:typeof l.extras.browserUrl=="string"?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?pe($({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let c=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=l.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!c&&d!=="reload"){let h="";return this.events.next(new zo(l.id,this.urlSerializer.serialize(l.rawUrl),h,gw.IgnoredSameUrlNavigation)),l.resolve(!1),qt}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return re(l).pipe(Ye(h=>{let g=this.transitions?.getValue();return this.events.next(new Qu(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),g!==this.transitions?.getValue()?qt:Promise.resolve(h)}),Sq(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),At(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=pe($({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let g=new op(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(g)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:h,extractedUrl:g,source:m,restoredState:v,extras:D}=l,S=new Qu(h,this.urlSerializer.serialize(g),m,v);this.events.next(S);let P=WR(this.rootComponentType).snapshot;return this.currentTransition=o=pe($({},l),{targetSnapshot:P,urlAfterRedirects:g,extras:pe($({},D),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=g,re(o)}else{let h="";return this.events.next(new zo(l.id,this.urlSerializer.serialize(l.extractedUrl),h,gw.IgnoredByUrlHandlingStrategy)),l.resolve(!1),qt}}),At(l=>{let c=new mw(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(c)}),J(l=>(this.currentTransition=o=pe($({},l),{guards:WH(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),iq(this.environmentInjector,l=>this.events.next(l)),At(l=>{if(o.guardsResult=l.guardsResult,l.guardsResult&&typeof l.guardsResult!="boolean")throw cp(this.urlSerializer,l.guardsResult);let c=new yw(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(c)}),Vt(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",_n.GuardRejected),!1)),uw(l=>{if(l.guards.canActivateChecks.length)return re(l).pipe(At(c=>{let d=new _w(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}),Ye(c=>{let d=!1;return re(c).pipe(Aq(this.paramsInheritanceStrategy,this.environmentInjector),At({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(c,"",_n.NoDataFromResolver)}}))}),At(c=>{let d=new vw(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}))}),uw(l=>{let c=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(At(g=>{d.component=g}),J(()=>{})));for(let g of d.children)h.push(...c(g));return h};return Bh(c(l.targetSnapshot.root)).pipe(_i(null),Vr(1))}),uw(()=>this.afterPreactivation()),Ye(()=>{let{currentSnapshot:l,targetSnapshot:c}=o,d=this.createViewTransition?.(this.environmentInjector,l.root,c.root);return d?ke(d).pipe(J(()=>o)):re(o)}),J(l=>{let c=$H(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=pe($({},l),{targetRouterState:c}),this.currentNavigation.targetRouterState=c,o}),At(()=>{this.events.next(new Zu)}),zH(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Vr(1),At({next:l=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Go(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{s=!0}}),Qy(this.transitionAbortSubject.pipe(At(l=>{throw l}))),hu(()=>{!s&&!a&&this.cancelNavigationTransition(o,"",_n.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),yi(l=>{if(a=!0,JR(l))this.events.next(new Qr(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),GH(l)?this.events.next(new Da(l.url,l.navigationBehaviorOptions)):o.resolve(!1);else{let c=new Yu(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0);try{let d=Rn(this.environmentInjector,()=>this.navigationErrorHandler?.(c));if(d instanceof Xu){let{message:h,cancellationCode:g}=cp(this.urlSerializer,d);this.events.next(new Qr(o.id,this.urlSerializer.serialize(o.extractedUrl),h,g)),this.events.next(new Da(d.redirectTo,d.navigationBehaviorOptions))}else throw this.events.next(c),l}catch(d){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(d)}}return qt}))}))}cancelNavigationTransition(t,r,i){let o=new Qr(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Uq(n){return n!==qu}var $q=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:()=>V(Hq),providedIn:"root"})}return n})(),Fw=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},Hq=(()=>{class n extends Fw{static \u0275fac=(()=>{let t;return function(i){return(t||(t=Hr(n)))(i||n)}})();static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),sx=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:()=>V(qq),providedIn:"root"})}return n})(),qq=(()=>{class n extends sx{location=V(Fu);urlSerializer=V(Vw);options=V(Uw,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";urlHandlingStrategy=V(qw);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Yr;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}routerState=WR(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof Qu)this.stateMemento=this.createStateMemento();else if(t instanceof zo)this.rawUrlTree=r.initialUrl;else if(t instanceof op){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??i,r)}}else t instanceof Zu?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):t instanceof Qr&&(t.code===_n.GuardRejected||t.code===_n.NoDataFromResolver)?this.restoreHistory(r):t instanceof Yu?this.restoreHistory(r,!0):t instanceof Go&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=t instanceof Yr?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let o=this.browserPageId,s=$($({},r.extras.state),this.generateNgRouterState(r.id,o));this.location.replaceState(i,"",s)}else{let o=$($({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",o)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,o=this.currentPageId-i;o!==0?this.location.historyGo(o):this.currentUrlTree===t.finalUrl&&o===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Hr(n)))(i||n)}})();static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Gq(n,e){n.events.pipe(Vt(t=>t instanceof Go||t instanceof Qr||t instanceof Yu||t instanceof zo),J(t=>t instanceof Go||t instanceof zo?0:(t instanceof Qr?t.code===_n.Redirect||t.code===_n.SupersededByNewNavigation:!1)?2:1),Vt(t=>t!==2),Vr(1)).subscribe(()=>{e()})}var zq={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Wq={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},ax=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=V(Lv);stateManager=V(sx);options=V(Uw,{optional:!0})||{};pendingTasks=V(ko);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=V(Bq);urlSerializer=V(Vw);location=V(Fu);urlHandlingStrategy=V(qw);_events=new ze;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=V($q);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=V(Hw,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!V(Bw,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new tt;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(i!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof Qr&&r.code!==_n.Redirect&&r.code!==_n.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Go)this.navigated=!0;else if(r instanceof Da){let s=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),l=$({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||Uq(i.source)},s);this.scheduleNavigation(a,qu,null,l,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}Qq(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),qu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let o={replaceUrl:!0},s=i?.navigationId?i:null;if(i){let l=$({},i);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,s,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map($w),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:l}=r,c=l?this.currentUrlTree.fragment:s,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=$($({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let g=i?i.snapshot:this.routerState.snapshot.root;h=HR(g)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),h=this.currentUrlTree.root}return qR(h,t,d,c??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Wu(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,qu,null,r)}navigate(t,r={skipLocationChange:!1}){return Kq(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=$({},zq):r===!1?i=$({},Wq):i=r,Wu(t))return bR(this.currentUrlTree,t,i);let o=this.parseUrl(t);return bR(this.currentUrlTree,o,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,o])=>(o!=null&&(r[i]=o),r),{})}scheduleNavigation(t,r,i,o,s){if(this.disposed)return Promise.resolve(!1);let a,l,c;s?(a=s.resolve,l=s.reject,c=s.promise):c=new Promise((h,g)=>{a=h,l=g});let d=this.pendingTasks.add();return Gq(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(h=>Promise.reject(h))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Kq(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new ne(4008,!1)}function Qq(n){return!(n instanceof Zu)&&!(n instanceof Da)}var Yq=new Q("");function lx(n,...e){return iv([{provide:Hw,multi:!0,useValue:n},[],{provide:Ta,useFactory:Zq,deps:[ax]},{provide:jv,multi:!0,useFactory:Jq},e.map(t=>t.\u0275providers)])}function Zq(n){return n.routerState.root}function Jq(){let n=V(pn);return e=>{let t=n.get(Si);if(e!==t.components[0])return;let r=n.get(ax),i=n.get(Xq);n.get(eG)===1&&r.initialNavigation(),n.get(tG,null,me.Optional)?.setUpPreloading(),n.get(Yq,null,me.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var Xq=new Q("",{factory:()=>new ze}),eG=new Q("",{providedIn:"root",factory:()=>1});var tG=new Q("");var vx=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,r){this._renderer=t,this._elementRef=r}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(r){return new(r||n)(Te(qr),Te(pr))};static \u0275dir=_t({type:n})}return n})(),_p=(()=>{class n extends vx{static \u0275fac=(()=>{let t;return function(i){return(t||(t=Hr(n)))(i||n)}})();static \u0275dir=_t({type:n,features:[gr]})}return n})(),cc=new Q("");var nG={provide:cc,useExisting:Br(()=>vp),multi:!0};function rG(){let n=Kr()?Kr().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var iG=new Q(""),vp=(()=>{class n extends vx{_compositionMode;_composing=!1;constructor(t,r,i){super(t,r),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!rG())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(r){return new(r||n)(Te(qr),Te(pr),Te(iG,8))};static \u0275dir=_t({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&an("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},standalone:!1,features:[jo([nG]),gr]})}return n})();function ux(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}var wx=new Q(""),oG=new Q("");function sG(n){return e=>{if(ux(e.value)||ux(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function cx(n){return null}function Ex(n){return n!=null}function Ix(n){return Oo(n)?ke(n):n}function Cx(n){let e={};return n.forEach(t=>{e=t!=null?$($({},e),t):e}),Object.keys(e).length===0?null:e}function Dx(n,e){return e.map(t=>t(n))}function aG(n){return!n.validate}function Tx(n){return n.map(e=>aG(e)?e:t=>e.validate(t))}function lG(n){if(!n)return null;let e=n.filter(Ex);return e.length==0?null:function(t){return Cx(Dx(t,e))}}function bx(n){return n!=null?lG(Tx(n)):null}function uG(n){if(!n)return null;let e=n.filter(Ex);return e.length==0?null:function(t){let r=Dx(t,e).map(Ix);return Gy(r).pipe(J(Cx))}}function Sx(n){return n!=null?uG(Tx(n)):null}function dx(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function cG(n){return n._rawValidators}function dG(n){return n._rawAsyncValidators}function Gw(n){return n?Array.isArray(n)?n:[n]:[]}function gp(n,e){return Array.isArray(n)?n.includes(e):n===e}function hx(n,e){let t=Gw(e);return Gw(n).forEach(i=>{gp(t,i)||t.push(i)}),t}function fx(n,e){return Gw(e).filter(t=>!gp(n,t))}var mp=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=bx(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Sx(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},zw=class extends mp{name;get formDirective(){return null}get path(){return null}},uc=class extends mp{_parent=null;name=null;valueAccessor=null},Ww=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},hG={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},FX=pe($({},hG),{"[class.ng-submitted]":"isSubmitted"}),Ax=(()=>{class n extends Ww{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(Te(uc,2))};static \u0275dir=_t({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&Bv("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[gr]})}return n})();var oc="VALID",pp="INVALID",Aa="PENDING",sc="DISABLED",Ra=class{},yp=class extends Ra{value;source;constructor(e,t){super(),this.value=e,this.source=t}},ac=class extends Ra{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},lc=class extends Ra{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},Ma=class extends Ra{status;source;constructor(e,t){super(),this.status=e,this.source=t}};function fG(n){return(wp(n)?n.validators:n)||null}function pG(n){return Array.isArray(n)?bx(n):n||null}function gG(n,e){return(wp(e)?e.asyncValidators:n)||null}function mG(n){return Array.isArray(n)?Sx(n):n||null}function wp(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}var Kw=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return zr(this.statusReactive)}set status(e){zr(()=>this.statusReactive.set(e))}_status=Pu(()=>this.statusReactive());statusReactive=Ru(void 0);get valid(){return this.status===oc}get invalid(){return this.status===pp}get pending(){return this.status==Aa}get disabled(){return this.status===sc}get enabled(){return this.status!==sc}errors;get pristine(){return zr(this.pristineReactive)}set pristine(e){zr(()=>this.pristineReactive.set(e))}_pristine=Pu(()=>this.pristineReactive());pristineReactive=Ru(!0);get dirty(){return!this.pristine}get touched(){return zr(this.touchedReactive)}set touched(e){zr(()=>this.touchedReactive.set(e))}_touched=Pu(()=>this.touchedReactive());touchedReactive=Ru(!1);get untouched(){return!this.touched}_events=new ze;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(hx(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(hx(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(fx(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(fx(e,this._rawAsyncValidators))}hasValidator(e){return gp(this._rawValidators,e)}hasAsyncValidator(e){return gp(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(pe($({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new lc(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new lc(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(pe($({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new ac(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new ac(!0,r))}markAsPending(e={}){this.status=Aa;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ma(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(pe($({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=sc,this.errors=null,this._forEachChild(i=>{i.disable(pe($({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new yp(this.value,r)),this._events.next(new Ma(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(pe($({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=oc,this._forEachChild(r=>{r.enable(pe($({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(pe($({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===oc||this.status===Aa)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new yp(this.value,t)),this._events.next(new Ma(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(pe($({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?sc:oc}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Aa,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=Ix(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Ma(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new Mt,this.statusChanges=new Mt}_calculateStatus(){return this._allControlsDisabled()?sc:this.errors?pp:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Aa)?Aa:this._anyControlsHaveStatus(pp)?pp:oc}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new ac(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new lc(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){wp(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=pG(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=mG(this._rawAsyncValidators)}};var Mx=new Q("",{providedIn:"root",factory:()=>Qw}),Qw="always";function yG(n,e){return[...e.path,n]}function _G(n,e,t=Qw){wG(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),EG(n,e),CG(n,e),IG(n,e),vG(n,e)}function px(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function vG(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function wG(n,e){let t=cG(n);e.validator!==null?n.setValidators(dx(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=dG(n);e.asyncValidator!==null?n.setAsyncValidators(dx(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();px(e._rawValidators,i),px(e._rawAsyncValidators,i)}function EG(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&Rx(n,e)})}function IG(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&Rx(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function Rx(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function CG(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function DG(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function TG(n){return Object.getPrototypeOf(n.constructor)===_p}function bG(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(o=>{o.constructor===vp?t=o:TG(o)?r=o:i=o}),i||r||t||null}function gx(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function mx(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var SG=class extends Kw{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,r){super(fG(t),gG(r,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),wp(t)&&(t.nonNullable||t.initialValueIsDefault)&&(mx(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){gx(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){gx(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){mx(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var AG={provide:uc,useExisting:Br(()=>Yw)},yx=Promise.resolve(),Yw=(()=>{class n extends uc{_changeDetectorRef;callSetDisabledState;control=new SG;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new Mt;constructor(t,r,i,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=bG(this,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),DG(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){_G(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){yx.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,i=r!==0&&qf(r);yx.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?yG(t,this._parent):[t]}static \u0275fac=function(r){return new(r||n)(Te(zw,9),Te(wx,10),Te(oG,10),Te(cc,10),Te(Bo,8),Te(Mx,8))};static \u0275dir=_t({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[jo([AG]),gr,ha]})}return n})();var MG={provide:cc,useExisting:Br(()=>Zw),multi:!0},Zw=(()=>{class n extends _p{writeValue(t){let r=t??"";this.setProperty("value",r)}registerOnChange(t){this.onChange=r=>{t(r==""?null:parseFloat(r))}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Hr(n)))(i||n)}})();static \u0275dir=_t({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(r,i){r&1&&an("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},standalone:!1,features:[jo([MG]),gr]})}return n})();var RG={provide:cc,useExisting:Br(()=>Ep),multi:!0};function xx(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function xG(n){return n.split(":")[0]}var Ep=(()=>{class n extends _p{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let r=this._getOptionId(t),i=xx(r,t);this.setProperty("value",i)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){let r=xG(t);return this._optionMap.has(r)?this._optionMap.get(r):t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Hr(n)))(i||n)}})();static \u0275dir=_t({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,i){r&1&&an("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[jo([RG]),gr]})}return n})(),Nx=(()=>{class n{_element;_renderer;_select;id;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(xx(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||n)(Te(pr),Te(qr),Te(Ep,9))};static \u0275dir=_t({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),NG={provide:cc,useExisting:Br(()=>Px),multi:!0};function _x(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function PG(n){return n.split(":")[0]}var Px=(()=>{class n extends _p{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let r;if(Array.isArray(t)){let i=t.map(o=>this._getOptionId(o));r=(o,s)=>{o._setSelected(i.indexOf(s.toString())>-1)}}else r=(i,o)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{let i=[],o=r.selectedOptions;if(o!==void 0){let s=o;for(let a=0;a<s.length;a++){let l=s[a],c=this._getOptionValue(l.value);i.push(c)}}else{let s=r.options;for(let a=0;a<s.length;a++){let l=s[a];if(l.selected){let c=this._getOptionValue(l.value);i.push(c)}}}this.value=i,t(i)}}_registerOption(t){let r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){let r=PG(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Hr(n)))(i||n)}})();static \u0275dir=_t({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,i){r&1&&an("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[jo([NG]),gr]})}return n})(),kx=(()=>{class n{_element;_renderer;_select;id;_value;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(_x(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(_x(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||n)(Te(pr),Te(qr),Te(Px,9))};static \u0275dir=_t({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();function kG(n){return typeof n=="number"?n:parseFloat(n)}var OG=(()=>{class n{_validator=cx;_onChange;_enabled;ngOnChanges(t){if(this.inputName in t){let r=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):cx,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static \u0275fac=function(r){return new(r||n)};static \u0275dir=_t({type:n,features:[ha]})}return n})();var FG={provide:wx,useExisting:Br(()=>Jw),multi:!0},Jw=(()=>{class n extends OG{min;inputName="min";normalizeInput=t=>kG(t);createValidator=t=>sG(t);static \u0275fac=(()=>{let t;return function(i){return(t||(t=Hr(n)))(i||n)}})();static \u0275dir=_t({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(r,i){r&2&&$f("min",i._enabled?i.min:null)},inputs:{min:"min"},standalone:!1,features:[jo([FG]),gr]})}return n})();var VG=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=mn({type:n});static \u0275inj=gn({})}return n})();var Ox=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Mx,useValue:t.callSetDisabledState??Qw}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=mn({type:n});static \u0275inj=gn({imports:[VG]})}return n})();var jG="firebase",BG="11.2.0";$n(jG,BG,"app");function nt(n){n===void 0&&(cA(nt),n=V(pn));let e=n.get(vv);return t=>new de(r=>{let i=e.add(),o=!1;function s(){o||(i(),o=!0)}let a=t.subscribe({next:l=>{r.next(l),s()},complete:()=>{r.complete(),s()},error:l=>{r.error(l),s()}});return a.add(()=>{r.unsubscribe(),s()}),a})}var xa=new jr("ANGULARFIRE2_VERSION");var Fx=(n,e)=>{let t=e?[e]:I0(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(s=>{r.includes(s)||r.push(s)})}),r},Xw=function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n}(Xw||{}),tee=Nu()&&typeof Zone<"u"?Xw.WARN:Xw.SILENT;var Ip=class{zone;delegate;constructor(e,t=$y){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(s){i?i.runGuarded(()=>{e.apply(this,[s])}):e.apply(this,[s])};return this.delegate.schedule(o,t,r)}},Wo=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=V(Se);this.outsideAngular=t.runOutsideAngular(()=>new Ip(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new Ip(typeof Zone>"u"?void 0:Zone.current,wo))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var UG=new Map,$G={activated:!1,tokenObservers:[]},HG={initialized:!1,enabled:!1};function Yn(n){return UG.get(n)||Object.assign({},$G)}function Hx(){return HG}var qG="https://content-firebaseappcheck.googleapis.com/v1";var GG="exchangeDebugToken",Vx={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},uee=24*60*60*1e3;var nE=class{constructor(e,t,r,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return x(this,null,function*(){this.stop();try{this.pending=new Et,this.pending.promise.catch(t=>{}),yield zG(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Et,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function zG(n){return new Promise(e=>{setTimeout(e,n)})}var WG={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},xi=new m0("appCheck","AppCheck",WG);function qx(n){if(!Yn(n).activated)throw xi.create("use-before-activation",{appName:n.name})}function Gx(r,i){return x(this,arguments,function*({url:n,body:e},t){let o={"Content-Type":"application/json"},s=t.getImmediate({optional:!0});if(s){let m=yield s.getHeartbeatsHeader();m&&(o["X-Firebase-Client"]=m)}let a={method:"POST",body:JSON.stringify(e),headers:o},l;try{l=yield fetch(n,a)}catch(m){throw xi.create("fetch-network-error",{originalErrorMessage:m?.message})}if(l.status!==200)throw xi.create("fetch-status-error",{httpStatus:l.status});let c;try{c=yield l.json()}catch(m){throw xi.create("fetch-parse-error",{originalErrorMessage:m?.message})}let d=c.ttl.match(/^([\d.]+)(s)$/);if(!d||!d[2]||isNaN(Number(d[1])))throw xi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});let h=Number(d[1])*1e3,g=Date.now();return{token:c.token,expireTimeMillis:g+h,issuedAtTimeMillis:g}})}function zx(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${qG}/projects/${t}/apps/${r}:${GG}?key=${i}`,body:{debug_token:e}}}var KG="firebase-app-check-database",QG=1,rE="firebase-app-check-store";var Cp=null;function YG(){return Cp||(Cp=new Promise((n,e)=>{try{let t=indexedDB.open(KG,QG);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(xi.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(rE,{keyPath:"compositeKey"})}}}catch(t){e(xi.create("storage-open",{originalErrorMessage:t?.message}))}}),Cp)}function ZG(n,e){return JG(XG(n),e)}function JG(n,e){return x(this,null,function*(){let r=(yield YG()).transaction(rE,"readwrite"),o=r.objectStore(rE).put({compositeKey:n,value:e});return new Promise((s,a)=>{o.onsuccess=l=>{s()},r.onerror=l=>{var c;a(xi.create("storage-set",{originalErrorMessage:(c=l.target.error)===null||c===void 0?void 0:c.message}))}})})}function XG(n){return`${n.options.appId}-${n.name}`}var iE=new mi("@firebase/app-check");function tE(n,e){return ah()?ZG(n,e).catch(t=>{iE.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Wx(){return Hx().enabled}function Kx(){return x(this,null,function*(){let n=Hx();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var e4={error:"UNKNOWN_ERROR"};function t4(n){return oh.encodeString(JSON.stringify(n),!1)}function oE(n,e=!1){return x(this,null,function*(){let t=n.app;qx(t);let r=Yn(t),i=r.token,o;if(i&&!dc(i)&&(r.token=void 0,i=void 0),!i){let l=yield r.cachedTokenPromise;l&&(dc(l)?i=l:yield tE(t,void 0))}if(!e&&i&&dc(i))return{token:i.token};let s=!1;if(Wx()){r.exchangeTokenPromise||(r.exchangeTokenPromise=Gx(zx(t,yield Kx()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),s=!0);let l=yield r.exchangeTokenPromise;return yield tE(t,l),r.token=l,{token:l.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),s=!0),i=yield Yn(t).exchangeTokenPromise}catch(l){l.code==="appCheck/throttled"?iE.warn(l.message):iE.error(l),o=l}let a;return i?o?dc(i)?a={token:i.token,internalError:o}:a=jx(o):(a={token:i.token},r.token=i,yield tE(t,i)):a=jx(o),s&&o4(t,a),a})}function n4(n){return x(this,null,function*(){let e=n.app;qx(e);let{provider:t}=Yn(e);if(Wx()){let r=yield Kx(),{token:i}=yield Gx(zx(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function r4(n,e,t,r){let{app:i}=n,o=Yn(i),s={next:t,error:r,type:e};if(o.tokenObservers=[...o.tokenObservers,s],o.token&&dc(o.token)){let a=o.token;Promise.resolve().then(()=>{t({token:a.token}),Lx(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>Lx(n))}function Qx(n,e){let t=Yn(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function Lx(n){let{app:e}=n,t=Yn(e),r=t.tokenRefresher;r||(r=i4(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function i4(n){let{app:e}=n;return new nE(()=>x(this,null,function*(){let t=Yn(e),r;if(t.token?r=yield oE(n,!0):r=yield oE(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=Yn(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},Vx.RETRIAL_MIN_WAIT,Vx.RETRIAL_MAX_WAIT)}function o4(n,e){let t=Yn(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function dc(n){return n.expireTimeMillis-Date.now()>0}function jx(n){return{token:t4(e4),error:n}}var sE=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Yn(this.app);for(let t of e)Qx(this.app,t.next);return Promise.resolve()}};function s4(n,e){return new sE(n,e)}function a4(n){return{getToken:e=>oE(n,e),getLimitedUseToken:()=>n4(n),addTokenListener:e=>r4(n,"INTERNAL",e),removeTokenListener:e=>Qx(n.app,e)}}var l4="@firebase/app-check",u4="0.8.11";var c4="app-check",Bx="app-check-internal";function d4(){go(new dn(c4,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return s4(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(Bx).initialize()})),go(new dn(Bx,n=>{let e=n.getProvider("app-check").getImmediate();return a4(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),$n(l4,u4)}d4();var h4="app-check";var Ni=class{constructor(){return Fx(h4)}};var f4=["localhost","0.0.0.0","127.0.0.1"],Dee=typeof window<"u"&&f4.includes(window.location.hostname);var p4="firebase",g4="11.2.0";Tt.registerVersion(p4,g4,"app-compat");var m4=["ngOnDestroy"],Zx=(n,e,t,r={})=>new Proxy(n,{get:(i,o)=>t.runOutsideAngular(()=>{if(n[o])return r?.spy?.get&&r.spy.get(o,n[o]),n[o];if(m4.indexOf(o)>-1)return()=>{};let s=e.toPromise().then(a=>{let l=a?.[o];return typeof l=="function"?l.bind(a):l?.then?l.then(c=>t.run(()=>c)):t.run(()=>l)});return new Proxy(()=>{},{get:(a,l)=>s[l],apply:(a,l,c)=>s.then(d=>{let h=d?.(...c);return r?.spy?.apply&&r.spy.apply(o,c,h),h})})})});var Dp=class{constructor(e){return e}},Pi=new Q("angularfire2.app.options"),ki=new Q("angularfire2.app.name");function Ko(n,e,t){let r=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||r;let s=Tt.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>Tt.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(s.options)){let a=!!module.hot;y4("error",`${s.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Dp(s)}var y4=(n,...e)=>{Nu()&&typeof console<"u"&&console[n](...e)},_4={provide:Dp,useFactory:Ko,deps:[Pi,Se,[new bf,ki]]},Jx=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:Pi,useValue:t},{provide:ki,useValue:r}]}}constructor(t){Tt.registerVersion("angularfire",xa.full,"core"),Tt.registerVersion("angularfire",xa.full,"app-compat"),Tt.registerVersion("angular",QM.full,t.toString())}static \u0275fac=function(r){return new(r||n)(B(sn))};static \u0275mod=mn({type:n});static \u0275inj=gn({providers:[_4]})}return n})();function Na(n,e,t,r,i){let[,o,s]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(o)return v4(i,s)||(Yx("error",`${e} was already initialized on the ${t} Firebase App with different settings.${w4?" You may need to reload as Firebase is not HMR aware.":""}`),Yx("warn",{is:i,was:s})),o;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([n,a,i]),a}}function v4(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var w4=typeof module<"u"&&!!module.hot,Yx=(n,...e)=>{Nu()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var hc=new Q("angularfire2.auth.use-emulator"),fc=new Q("angularfire2.auth.settings"),pc=new Q("angularfire2.auth.tenant-id"),gc=new Q("angularfire2.auth.langugage-code"),mc=new Q("angularfire2.auth.use-device-language"),yc=new Q("angularfire.auth.persistence"),_c=(n,e,t,r,i,o,s,a)=>Na(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let l=e.runOutsideAngular(()=>n.auth());if(t&&l.useEmulator(...t),r&&(l.tenantId=r),l.languageCode=i,o&&l.useDeviceLanguage(),s)for(let[c,d]of Object.entries(s))l.settings[c]=d;return a&&l.setPersistence(a),l},[t,r,i,o,s,a]),vc=(()=>{class n{injector=V(it);authState;idToken;user;idTokenResult;credential;constructor(t,r,i,o,s,a,l,c,d,h,g,m){let v=new ze,D=re(void 0).pipe(ar(s.outsideAngular),Ye(()=>o.runOutsideAngular(()=>import("./chunk-VTHNAWUC.js"))),J(()=>Ko(t,o,r)),J(S=>_c(S,o,a,c,d,h,l,g)),Hh({bufferSize:1,refCount:!1}));if($o(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=re(null);else{D.pipe(qn()).subscribe();let S=D.pipe(Ye(O=>O.getRedirectResult().then(K=>K,()=>null)),nt(this.injector),Hh({bufferSize:1,refCount:!1})),P=D.pipe(Ye(O=>new de(K=>({unsubscribe:o.runOutsideAngular(()=>O.onAuthStateChanged(ie=>K.next(ie),ie=>K.error(ie),()=>K.complete()))})))),j=D.pipe(Ye(O=>new de(K=>({unsubscribe:o.runOutsideAngular(()=>O.onIdTokenChanged(ie=>K.next(ie),ie=>K.error(ie),()=>K.complete()))}))));this.authState=S.pipe(qh(P),Or(s.outsideAngular),ar(s.insideAngular)),this.user=S.pipe(qh(j),Or(s.outsideAngular),ar(s.insideAngular)),this.idToken=this.user.pipe(Ye(O=>O?ke(O.getIdToken()):re(null))),this.idTokenResult=this.user.pipe(Ye(O=>O?ke(O.getIdTokenResult()):re(null))),this.credential=Gs(S,v,this.authState.pipe(Vt(O=>!O))).pipe(J(O=>O?.user?O:null),Or(s.outsideAngular),ar(s.insideAngular))}return Zx(this,D,o,{spy:{apply:(S,P,j)=>{(S.startsWith("signIn")||S.startsWith("createUser"))&&j.then(O=>v.next(O))}}})}static \u0275fac=function(r){return new(r||n)(B(Pi),B(ki,8),B(sn),B(Se),B(Wo),B(hc,8),B(fc,8),B(pc,8),B(gc,8),B(mc,8),B(yc,8),B(Ni,8))};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),Xx=(()=>{class n{constructor(){Tt.registerVersion("angularfire",xa.full,"auth-compat")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=mn({type:n});static \u0275inj=gn({providers:[vc]})}return n})();var tN="@firebase/database",nN="1.0.11";var vI="";function wI(n){vI=n}var gE=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ut(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:lh(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var mE=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Tn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var PN=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new gE(e)}}catch{}return new mE},Yo=PN("localStorage"),yE=PN("sessionStorage");var Fa=new mi("@firebase/database"),kN=function(){let n=1;return function(){return n++}}(),ON=function(n){let e=E0(n),t=new w0;t.update(e);let r=t.digest();return oh.encodeByteArray(r)},Hc=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Hc.apply(null,r):typeof r=="object"?e+=ut(r):e+=r,e+=" "}return e},Zo=null,rN=!0,FN=function(n,e){L(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Fa.logLevel=bn.VERBOSE,Zo=Fa.log.bind(Fa),e&&yE.set("logging_enabled",!0)):typeof n=="function"?Zo=n:(Zo=null,yE.remove("logging_enabled"))},It=function(...n){if(rN===!0&&(rN=!1,Zo===null&&yE.get("logging_enabled")===!0&&FN(!0)),Zo){let e=Hc.apply(null,n);Zo(e)}},qc=function(n){return function(...e){It(n,...e)}},_E=function(...n){let e="FIREBASE INTERNAL ERROR: "+Hc(...n);Fa.error(e)},vr=function(...n){let e=`FIREBASE FATAL ERROR: ${Hc(...n)}`;throw Fa.error(e),new Error(e)},Lt=function(...n){let e="FIREBASE WARNING: "+Hc(...n);Fa.warn(e)},I4=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Lt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Jp=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},C4=function(n){if(or()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Li="[MIN_NAME]",Zr="[MAX_NAME]",Xo=function(n,e){if(n===e)return 0;if(n===Li||e===Zr)return-1;if(e===Li||n===Zr)return 1;{let t=iN(n),r=iN(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},D4=function(n,e){return n===e?0:n<e?-1:1},wc=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+ut(e))},EI=function(n){if(typeof n!="object"||n===null)return ut(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=ut(e[r]),t+=":",t+=EI(n[e[r]]);return t+="}",t},VN=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function Ct(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var LN=function(n){L(!Jp(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,o,s,a,l;n===0?(o=0,s=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),o=a+r,s=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(o=0,s=Math.round(n/Math.pow(2,1-r-t))));let c=[];for(l=t;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);for(l=e;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);c.push(i?1:0),c.reverse();let d=c.join(""),h="";for(l=0;l<64;l+=8){let g=parseInt(d.substr(l,8),2).toString(16);g.length===1&&(g="0"+g),h=h+g}return h.toLowerCase()},T4=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},b4=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function S4(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}var A4=new RegExp("^-?(0*)\\d{1,10}$"),M4=-2147483648,R4=2147483647,iN=function(n){if(A4.test(n)){let e=Number(n);if(e>=M4&&e<=R4)return e}return null},Ga=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw Lt("Exception was thrown by user callback.",t),e},Math.floor(0))}},x4=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Dc=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var vE=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Lt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var wE=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(It("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Lt(e)}},Tc=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),bp="5",jN="v",BN="s",UN="r",$N="f",HN=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,qN="ls",GN="p",EE="ac",zN="websocket",WN="long_polling";var Sp=class{constructor(e,t,r,i,o=!1,s="",a=!1,l=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=o,this.persistenceKey=s,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Yo.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Yo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function N4(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function KN(n,e,t){L(typeof e=="string","typeof type must == string"),L(typeof t=="object","typeof params must == object");let r;if(e===zN)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===WN)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);N4(n)&&(t.ns=n.namespace);let i=[];return Ct(t,(o,s)=>{i.push(o+"="+s)}),r+i.join("&")}var IE=class{constructor(){this.counters_={}}incrementCounter(e,t=1){Tn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return f0(this.counters_)}};var lE={},uE={};function II(n){let e=n.toString();return lE[e]||(lE[e]=new IE),lE[e]}function P4(n,e){let t=n.toString();return uE[t]||(uE[t]=e()),uE[t]}var CE=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Ga(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var oN="start",k4="close",O4="pLPCommand",F4="pRTLPCB",QN="id",YN="pw",ZN="ser",V4="cb",L4="seg",j4="ts",B4="d",U4="dframe",JN=1870,XN=30,$4=JN-XN,H4=25e3,q4=3e4,Mc=class n{constructor(e,t,r,i,o,s,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.transportSessionId=s,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=qc(e),this.stats_=II(t),this.urlFn=l=>(this.appCheckToken&&(l[EE]=this.appCheckToken),KN(t,WN,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new CE(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(q4)),C4(()=>{if(this.isClosed_)return;this.scriptTagHolder=new DE((...o)=>{let[s,a,l,c,d]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,s===oN)this.id=a,this.password=l;else if(s===k4)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+s)},(...o)=>{let[s,a]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(s,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[oN]="t",r[ZN]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[V4]=this.scriptTagHolder.uniqueCallbackIdentifier),r[jN]=bp,this.transportSessionId&&(r[BN]=this.transportSessionId),this.lastSessionId&&(r[qN]=this.lastSessionId),this.applicationId&&(r[GN]=this.applicationId),this.appCheckToken&&(r[EE]=this.appCheckToken),typeof location<"u"&&location.hostname&&HN.test(location.hostname)&&(r[UN]=$N);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return or()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!T4()&&!b4()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=ut(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=h0(t),i=VN(r,$4);for(let o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(or())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[U4]="t",r[QN]=e,r[YN]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=ut(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},DE=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,or())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=kN(),window[O4+this.uniqueCallbackIdentifier]=e,window[F4+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');let s="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(a){It("frame writing exception"),a.stack&&It(a.stack),It(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||It("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[QN]=this.myID,e[YN]=this.myPW,e[ZN]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+XN+r.length<=JN;){let s=this.pendingSegs.shift();r=r+"&"+L4+i+"="+s.seg+"&"+j4+i+"="+s.ts+"&"+B4+i+"="+s.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(H4)),o=()=>{clearTimeout(i),r()};this.addTag(e,o)}addTag(e,t){or()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{It("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var G4=16384,z4=45e3,Ap=null;typeof MozWebSocket<"u"?Ap=MozWebSocket:typeof WebSocket<"u"&&(Ap=WebSocket);var ka=(()=>{class n{constructor(t,r,i,o,s,a,l){this.connId=t,this.applicationId=i,this.appCheckToken=o,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=qc(this.connId),this.stats_=II(r),this.connURL=n.connectionURL_(r,a,l,o,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,o,s){let a={};return a[jN]=bp,!or()&&typeof location<"u"&&location.hostname&&HN.test(location.hostname)&&(a[UN]=$N),r&&(a[BN]=r),i&&(a[qN]=i),o&&(a[EE]=o),s&&(a[GN]=s),KN(t,zN,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Yo.set("previous_websocket_failure",!0);try{let i;if(or()){let o=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${bp}/${vI}/${process.platform}/${o}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let s=process.env,a=this.connURL.indexOf("wss://")===0?s.HTTPS_PROXY||s.https_proxy:s.HTTP_PROXY||s.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Ap(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let o=i.message||i.data;o&&this.log_(o),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let o=i.message||i.data;o&&this.log_(o),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&Ap!==null&&!n.forceDisallow_}static previouslyFailed(){return Yo.isInMemoryStorage||Yo.get("previous_websocket_failure")===!0}markConnectionHealthy(){Yo.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=lh(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(L(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=ut(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=VN(r,G4);i.length>1&&this.sendString_(String(i.length));for(let o=0;o<i.length;o++)this.sendString_(i[o])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(z4))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),eP=(()=>{class n{static get ALL_TRANSPORTS(){return[Mc,ka]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){let r=ka&&ka.isAvailable(),i=r&&!ka.previouslyFailed();if(t.webSocketOnly&&(r||Lt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[ka];else{let o=this.transports_=[];for(let s of n.ALL_TRANSPORTS)s&&s.isAvailable()&&o.push(s);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),W4=6e4,K4=5e3,Q4=10*1024,Y4=100*1024,cE="t",sN="d",Z4="s",aN="r",J4="e",lN="o",uN="a",cN="n",dN="p",X4="h",TE=class{constructor(e,t,r,i,o,s,a,l,c,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=o,this.onMessage_=s,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=qc("c:"+this.id+":"),this.transportManager_=new eP(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Dc(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Y4?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Q4?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(cE in e){let t=e[cE];t===uN?this.upgradeIfSecondaryHealthy_():t===aN?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===lN&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=wc("t",e),r=wc("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:dN,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:uN,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:cN,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=wc("t",e),r=wc("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=wc(cE,e);if(sN in e){let r=e[sN];if(t===X4){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===cN){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===Z4?this.onConnectionShutdown_(r):t===aN?this.onReset_(r):t===J4?_E("Server Error: "+r):t===lN?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):_E("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),bp!==r&&Lt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Dc(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(W4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Dc(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(K4))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:dN,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Yo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Mp=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var Rp=class{constructor(e){this.allowedEvents_=e,this.listeners_={},L(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let o=0;o<i.length;o++)if(i[o].callback===t&&(!r||r===i[o].context)){i.splice(o,1);return}}validateEventType_(e){L(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var xp=class n extends Rp{static getInstance(){return new n}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!_y()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return L(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var hN=32,fN=768,Pe=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function Ne(){return new Pe("")}function ye(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function ji(n){return n.pieces_.length-n.pieceNum_}function Ue(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Pe(n.pieces_,e)}function CI(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function ez(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Rc(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function tP(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Pe(e,0)}function Ke(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Pe)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new Pe(t,0)}function _e(n){return n.pieceNum_>=n.pieces_.length}function Yt(n,e){let t=ye(n),r=ye(e);if(t===null)return e;if(t===r)return Yt(Ue(n),Ue(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function tz(n,e){let t=Rc(n,0),r=Rc(e,0);for(let i=0;i<t.length&&i<r.length;i++){let o=Xo(t[i],r[i]);if(o!==0)return o}return t.length===r.length?0:t.length<r.length?-1:1}function DI(n,e){if(ji(n)!==ji(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Fn(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(ji(n)>ji(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var bE=class{constructor(e,t){this.errorPrefix_=t,this.parts_=Rc(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=iu(this.parts_[r]);nP(this)}};function nz(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=iu(e),nP(n)}function rz(n){let e=n.parts_.pop();n.byteLength_-=iu(e),n.parts_.length>0&&(n.byteLength_-=1)}function nP(n){if(n.byteLength_>fN)throw new Error(n.errorPrefix_+"has a key path longer than "+fN+" bytes ("+n.byteLength_+").");if(n.parts_.length>hN)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+hN+") or object contains a cycle "+Qo(n))}function Qo(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var SE=class n extends Rp{static getInstance(){return new n}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return L(e==="visible","Unknown event type: "+e),[this.visible_]}};var Ec=1e3,iz=60*5*1e3,pN=30*1e3,oz=1.3,sz=3e4,az="server_kill",gN=3,TI=(()=>{class n extends Mp{constructor(t,r,i,o,s,a,l,c){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=o,this.onServerInfoUpdate_=s,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=n.nextPersistentConnectionId_++,this.log_=qc("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ec,this.maxReconnectDelay_=iz,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!or())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");SE.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&xp.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let o=++this.requestNumber_,s={r:o,a:t,b:r};this.log_(ut(s)),L(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),i&&(this.requestCBHash_[o]=i)}get(t){this.initConnection_();let r=new Et,o={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let l=a.d;a.s==="ok"?r.resolve(l):r.reject(l)}};this.outstandingGets_.push(o),this.outstandingGetCount_++;let s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),r.promise}listen(t,r,i,o){this.initConnection_();let s=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+s),this.listens.has(a)||this.listens.set(a,new Map),L(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),L(!this.listens.get(a).has(s),"listen() called twice for same path/queryId.");let l={onComplete:o,hashFn:r,query:t,tag:i};this.listens.get(a).set(s,l),this.connected_&&this.sendListen_(l)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);let s={p:i},a="q";t.tag&&(s.q=r._queryObject,s.t=t.tag),s.h=t.hashFn(),this.sendRequest(a,s,l=>{let c=l.d,d=l.s;n.warnOnListenWarnings_(c,r),(this.listens.get(i)&&this.listens.get(i).get(o))===t&&(this.log_("listen response",l),d!=="ok"&&this.removeListen_(i,o),t.onComplete&&t.onComplete(d,c))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&Tn(t,"w")){let i=gi(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let o='".indexOn": "'+r._queryParams.getIndex().toString()+'"',s=r._path.toString();Lt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${o} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||_0(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=pN)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=y0(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,o=>{let s=o.s,a=o.d||"error";this.authToken_===t&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),o=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+o),L(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,o)&&this.connected_&&this.sendUnlisten_(i,o,t._queryObject,r)}sendUnlisten_(t,r,i,o){this.log_("Unlisten on "+t+" for "+r);let s={p:t},a="n";o&&(s.q=i,s.t=o),this.sendRequest(a,s)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,o){let s={p:r,d:i};this.log_("onDisconnect "+t,s),this.sendRequest(t,s,a=>{o&&setTimeout(()=>{o(a.s,a.d)},Math.floor(0))})}put(t,r,i,o){this.putInternal("p",t,r,i,o)}merge(t,r,i,o){this.putInternal("m",t,r,i,o)}putInternal(t,r,i,o,s){this.initConnection_();let a={p:r,d:i};s!==void 0&&(a.h=s),this.outstandingPuts_.push({action:t,request:a,onComplete:o}),this.outstandingPutCount_++;let l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,o=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,s=>{this.log_(r+" response",s),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),o&&o(s.s,s.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let s=i.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+ut(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):_E("Unrecognized action received from server: "+ut(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){L(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ec,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Ec,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>sz&&(this.reconnectDelay_=Ec),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*oz)}this.onConnectStatus_(!1)}establishConnection_(){return x(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),o=this.id+":"+n.nextConnectionId_++,s=this.lastSessionId,a=!1,l=null,c=function(){l?l.close():(a=!0,i())},d=function(g){L(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(g)};this.realtime_={close:c,sendRequest:d};let h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[g,m]=yield Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);a?It("getToken() completed but was canceled"):(It("getToken() completed. Creating connection."),this.authToken_=g&&g.accessToken,this.appCheckToken_=m&&m.token,l=new TE(o,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,v=>{Lt(v+" ("+this.repoInfo_.toString()+")"),this.interrupt(az)},s))}catch(g){this.log_("Failed to get token: "+g),a||(this.repoInfo_.nodeAdmin&&Lt(g),c())}}})}interrupt(t){It("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){It("Resuming connection for reason: "+t),delete this.interruptReasons_[t],uh(this.interruptReasons_)&&(this.reconnectDelay_=Ec,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(s=>EI(s)).join("$"):i="default";let o=this.removeListen_(t,i);o&&o.onComplete&&o.onComplete("permission_denied")}removeListen_(t,r){let i=new Pe(t).toString(),o;if(this.listens.has(i)){let s=this.listens.get(i);o=s.get(r),s.delete(r),s.size===0&&this.listens.delete(i)}else o=void 0;return o}onAuthRevoked_(t,r){It("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=gN&&(this.reconnectDelay_=pN,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){It("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=gN&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";or()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+vI.replace(/\./g,"-")]=1,_y()?t["framework.cordova"]=1:p0()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=xp.getInstance().currentlyOnline();return uh(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),ve=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var Va=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new ve(Li,e),i=new ve(Li,t);return this.compare(r,i)!==0}minPost(){return ve.MIN}};var Tp,Np=class extends Va{static get __EMPTY_NODE(){return Tp}static set __EMPTY_NODE(e){Tp=e}compare(e,t){return Xo(e.name,t.name)}isDefinedOn(e){throw Ns("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return ve.MIN}maxPost(){return new ve(Zr,Tp)}makePost(e,t){return L(typeof e=="string","KeyIndex indexValue must always be a string."),new ve(e,Tp)}toString(){return".key"}},_r=new Np;var Oa=class{constructor(e,t,r,i,o=null){this.isReverse_=i,this.resultGenerator_=o,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(e=e,s=t?r(e.key,t):1,i&&(s*=-1),s<0)this.isReverse_?e=e.left:e=e.right;else if(s===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Zn=(()=>{class n{constructor(t,r,i,o,s){this.key=t,this.value=r,this.color=i??n.RED,this.left=o??Vn.EMPTY_NODE,this.right=s??Vn.EMPTY_NODE}copy(t,r,i,o,s){return new n(t??this.key,r??this.value,i??this.color,o??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let o=this,s=i(t,o.key);return s<0?o=o.copy(null,null,null,o.left.insert(t,r,i),null):s===0?o=o.copy(null,r,null,null,null):o=o.copy(null,null,null,null,o.right.insert(t,r,i)),o.fixUp_()}removeMin_(){if(this.left.isEmpty())return Vn.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,o;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return Vn.EMPTY_NODE;o=i.right.min_(),i=i.copy(o.key,o.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),AE=class{copy(e,t,r,i,o){return this}insert(e,t,r){return new Zn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Vn=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Zn.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Zn.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Oa(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Oa(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Oa(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Oa(this.root_,null,this.comparator_,!0,e)}};Vn.EMPTY_NODE=new AE;function lz(n,e){return Xo(n.name,e.name)}function bI(n,e){return Xo(n,e)}var ME;function uz(n){ME=n}var rP=function(n){return typeof n=="number"?"number:"+LN(n):"string:"+n},iP=function(n){if(n.isLeafNode()){let e=n.val();L(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Tn(e,".sv"),"Priority must be a string or number.")}else L(n===ME||n.isEmpty(),"priority of unexpected type.");L(n===ME||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var mN,La=(()=>{class n{static set __childrenNodeConstructor(t){mN=t}static get __childrenNodeConstructor(){return mN}constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,L(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),iP(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return _e(t)?this:ye(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=ye(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(L(i!==".priority"||ji(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ue(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+rP(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=LN(this.value_):t+=this.value_,this.lazyHash_=ON(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(L(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,o=n.VALUE_TYPE_ORDER.indexOf(r),s=n.VALUE_TYPE_ORDER.indexOf(i);return L(o>=0,"Unknown leaf type: "+r),L(s>=0,"Unknown leaf type: "+i),o===s?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:s-o}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),oP,sP;function cz(n){oP=n}function dz(n){sP=n}var RE=class extends Va{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),o=r.compareTo(i);return o===0?Xo(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return ve.MIN}maxPost(){return new ve(Zr,new La("[PRIORITY-POST]",sP))}makePost(e,t){let r=oP(e);return new ve(t,new La("[PRIORITY-POST]",r))}toString(){return".priority"}},He=new RE;var hz=Math.log(2),xE=class{constructor(e){let t=o=>parseInt(Math.log(o)/hz,10),r=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Pp=function(n,e,t,r){n.sort(e);let i=function(l,c){let d=c-l,h,g;if(d===0)return null;if(d===1)return h=n[l],g=t?t(h):h,new Zn(g,h.node,Zn.BLACK,null,null);{let m=parseInt(d/2,10)+l,v=i(l,m),D=i(m+1,c);return h=n[m],g=t?t(h):h,new Zn(g,h.node,Zn.BLACK,v,D)}},o=function(l){let c=null,d=null,h=n.length,g=function(v,D){let S=h-v,P=h;h-=v;let j=i(S+1,P),O=n[S],K=t?t(O):O;m(new Zn(K,O.node,D,null,j))},m=function(v){c?(c.left=v,c=v):(d=v,c=v)};for(let v=0;v<l.count;++v){let D=l.nextBitIsOne(),S=Math.pow(2,l.count-(v+1));D?g(S,Zn.BLACK):(g(S,Zn.BLACK),g(S,Zn.RED))}return d},s=new xE(n.length),a=o(s);return new Vn(r||e,a)};var dE,Pa={},ja=class n{static get Default(){return L(Pa&&He,"ChildrenNode.ts has not been loaded"),dE=dE||new n({".priority":Pa},{".priority":He}),dE}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){let t=gi(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Vn?t:null}hasIndex(e){return Tn(this.indexSet_,e.toString())}addIndex(e,t){L(e!==_r,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,o=t.getIterator(ve.Wrap),s=o.getNext();for(;s;)i=i||e.isDefinedOn(s.node),r.push(s),s=o.getNext();let a;i?a=Pp(r,e.getCompare()):a=Pa;let l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;let d=Object.assign({},this.indexes_);return d[l]=a,new n(d,c)}addToIndexes(e,t){let r=ru(this.indexes_,(i,o)=>{let s=gi(this.indexSet_,o);if(L(s,"Missing index implementation for "+o),i===Pa)if(s.isDefinedOn(e.node)){let a=[],l=t.getIterator(ve.Wrap),c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),Pp(a,s.getCompare())}else return Pa;else{let a=t.get(e.name),l=i;return a&&(l=l.remove(new ve(e.name,a))),l.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=ru(this.indexes_,i=>{if(i===Pa)return i;{let o=t.get(e.name);return o?i.remove(new ve(e.name,o)):i}});return new n(r,this.indexSet_)}};var Ic,he=(()=>{class n{static get EMPTY_NODE(){return Ic||(Ic=new n(new Vn(bI),null,ja.Default))}constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&iP(this.priorityNode_),this.children_.isEmpty()&&L(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ic}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?Ic:r}}getChild(t){let r=ye(t);return r===null?this:this.getImmediateChild(r).getChild(Ue(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(L(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new ve(t,r),o,s;r.isEmpty()?(o=this.children_.remove(t),s=this.indexMap_.removeFromIndexes(i,this.children_)):(o=this.children_.insert(t,r),s=this.indexMap_.addToIndexes(i,this.children_));let a=o.isEmpty()?Ic:this.priorityNode_;return new n(o,a,s)}}updateChild(t,r){let i=ye(t);if(i===null)return r;{L(ye(t)!==".priority"||ji(t)===1,".priority must be the last token in a path");let o=this.getImmediateChild(i).updateChild(Ue(t),r);return this.updateImmediateChild(i,o)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,o=0,s=!0;if(this.forEachChild(He,(a,l)=>{r[a]=l.val(t),i++,s&&n.INTEGER_REGEXP_.test(a)?o=Math.max(o,Number(a)):s=!1}),!t&&s&&o<2*i){let a=[];for(let l in r)a[l]=r[l];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+rP(this.getPriority().val())+":"),this.forEachChild(He,(r,i)=>{let o=i.hash();o!==""&&(t+=":"+r+":"+o)}),this.lazyHash_=t===""?"":ON(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let o=this.resolveIndex_(i);if(o){let s=o.getPredecessorKey(new ve(t,r));return s?s.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new ve(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new ve(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(o=>r(o.name,o.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,o=>o);{let o=this.children_.getIteratorFrom(t.name,ve.Wrap),s=o.peek();for(;s!=null&&r.compare(s,t)<0;)o.getNext(),s=o.peek();return o}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,o=>o);{let o=this.children_.getReverseIteratorFrom(t.name,ve.Wrap),s=o.peek();for(;s!=null&&r.compare(s,t)>0;)o.getNext(),s=o.peek();return o}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Gc?-1:0}withIndex(t){if(t===_r||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===_r||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(He),o=r.getIterator(He),s=i.getNext(),a=o.getNext();for(;s&&a;){if(s.name!==a.name||!s.node.equals(a.node))return!1;s=i.getNext(),a=o.getNext()}return s===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===_r?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),NE=class extends he{constructor(){super(new Vn(bI),he.EMPTY_NODE,ja.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return he.EMPTY_NODE}isEmpty(){return!1}},Gc=new NE;Object.defineProperties(ve,{MIN:{value:new ve(Li,he.EMPTY_NODE)},MAX:{value:new ve(Zr,Gc)}});Np.__EMPTY_NODE=he.EMPTY_NODE;La.__childrenNodeConstructor=he;uz(Gc);dz(Gc);var fz=!0;function Ze(n,e=null){if(n===null)return he.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),L(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new La(t,Ze(e))}if(!(n instanceof Array)&&fz){let t=[],r=!1;if(Ct(n,(s,a)=>{if(s.substring(0,1)!=="."){let l=Ze(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),t.push(new ve(s,l)))}}),t.length===0)return he.EMPTY_NODE;let o=Pp(t,lz,s=>s.name,bI);if(r){let s=Pp(t,He.getCompare());return new he(o,Ze(e),new ja({".priority":s},{".priority":He}))}else return new he(o,Ze(e),ja.Default)}else{let t=he.EMPTY_NODE;return Ct(n,(r,i)=>{if(Tn(n,r)&&r.substring(0,1)!=="."){let o=Ze(i);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(r,o))}}),t.updatePriority(Ze(e))}}cz(Ze);var xc=class extends Va{constructor(e){super(),this.indexPath_=e,L(!_e(e)&&ye(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),o=r.compareTo(i);return o===0?Xo(e.name,t.name):o}makePost(e,t){let r=Ze(e),i=he.EMPTY_NODE.updateChild(this.indexPath_,r);return new ve(t,i)}maxPost(){let e=he.EMPTY_NODE.updateChild(this.indexPath_,Gc);return new ve(Zr,e)}toString(){return Rc(this.indexPath_,0).join("/")}};var PE=class extends Va{compare(e,t){let r=e.node.compareTo(t.node);return r===0?Xo(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return ve.MIN}maxPost(){return ve.MAX}makePost(e,t){let r=Ze(e);return new ve(t,r)}toString(){return".value"}},SI=new PE;function aP(n){return{type:"value",snapshotNode:n}}function Ba(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Nc(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Pc(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function pz(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var kc=class{constructor(e){this.index_=e}updateChild(e,t,r,i,o,s){L(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(s!=null&&(r.isEmpty()?e.hasChild(t)?s.trackChildChange(Nc(t,a)):L(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?s.trackChildChange(Ba(t,r)):s.trackChildChange(Pc(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(He,(i,o)=>{t.hasChild(i)||r.trackChildChange(Nc(i,o))}),t.isLeafNode()||t.forEachChild(He,(i,o)=>{if(e.hasChild(i)){let s=e.getImmediateChild(i);s.equals(o)||r.trackChildChange(Pc(i,o,s))}else r.trackChildChange(Ba(i,o))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?he.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var kp=class n{constructor(e){this.indexedFilter_=new kc(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,o,s){return this.matches(new ve(t,r))||(r=he.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,o,s)}updateFullNode(e,t,r){t.isLeafNode()&&(t=he.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(he.EMPTY_NODE);let o=this;return t.forEachChild(He,(s,a)=>{o.matches(new ve(s,a))||(i=i.updateImmediateChild(s,he.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var kE=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{let r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new kp(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,o,s){return this.rangedFilter_.matches(new ve(t,r))||(r=he.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,o,s):this.fullLimitUpdateChild_(e,t,r,o,s)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=he.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=he.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let s=0;for(;o.hasNext()&&s<this.limit_;){let a=o.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),s++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(he.EMPTY_NODE);let o;this.reverse_?o=i.getReverseIterator(this.index_):o=i.getIterator(this.index_);let s=0;for(;o.hasNext();){let a=o.getNext();s<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?s++:i=i.updateImmediateChild(a.name,he.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,o){let s;if(this.reverse_){let h=this.index_.getCompare();s=(g,m)=>h(m,g)}else s=this.index_.getCompare();let a=e;L(a.numChildren()===this.limit_,"");let l=new ve(t,r),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(l);if(a.hasChild(t)){let h=a.getImmediateChild(t),g=i.getChildAfterChild(this.index_,c,this.reverse_);for(;g!=null&&(g.name===t||a.hasChild(g.name));)g=i.getChildAfterChild(this.index_,g,this.reverse_);let m=g==null?1:s(g,l);if(d&&!r.isEmpty()&&m>=0)return o?.trackChildChange(Pc(t,r,h)),a.updateImmediateChild(t,r);{o?.trackChildChange(Nc(t,h));let D=a.updateImmediateChild(t,he.EMPTY_NODE);return g!=null&&this.rangedFilter_.matches(g)?(o?.trackChildChange(Ba(g.name,g.node)),D.updateImmediateChild(g.name,g.node)):D}}else return r.isEmpty()?e:d&&s(c,l)>=0?(o!=null&&(o.trackChildChange(Nc(c.name,c.node)),o.trackChildChange(Ba(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(c.name,he.EMPTY_NODE)):e}};var Oc=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=He}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return L(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return L(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Li}hasEnd(){return this.endSet_}getIndexEndValue(){return L(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return L(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Zr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return L(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===He}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function gz(n){return n.loadsAllData()?new kc(n.getIndex()):n.hasLimit()?new kE(n):new kp(n)}function mz(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function yz(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function OE(n,e,t){let r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function _z(n,e,t){let r;return n.index_===_r||t?r=OE(n,e,t):r=OE(n,e,Zr),r.startAfterSet_=!0,r}function FE(n,e,t){let r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function vz(n,e,t){let r;return n.index_===_r||t?r=FE(n,e,t):r=FE(n,e,Li),r.endBeforeSet_=!0,r}function Xp(n,e){let t=n.copy();return t.index_=e,t}function yN(n){let e={};if(n.isDefault())return e;let t;if(n.index_===He?t="$priority":n.index_===SI?t="$value":n.index_===_r?t="$key":(L(n.index_ instanceof xc,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=ut(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=ut(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+ut(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=ut(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+ut(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function _N(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==He&&(e.i=n.index_.toString()),e}var VE=class n extends Mp{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(L(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=qc("p:rest:"),this.listens_={}}listen(e,t,r,i){let o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);let s=n.getListenId_(e,r),a={};this.listens_[s]=a;let l=yN(e._queryParams);this.restRequest_(o+".json",l,(c,d)=>{let h=d;if(c===404&&(h=null,c=null),c===null&&this.onDataUpdate_(o,h,!1,r),gi(this.listens_,s)===a){let g;c?c===401?g="permission_denied":g="rest_error:"+c:g="ok",i(g,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=yN(e._queryParams),r=e._path.toString(),i=new Et;return this.restRequest_(r+".json",t,(o,s)=>{let a=s;o===404&&(a=null,o=null),o===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,o])=>{i&&i.accessToken&&(t.auth=i.accessToken),o&&o.token&&(t.ac=o.token);let s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+v0(t);this.log_("Sending REST request for "+s);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+s+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=lh(a.responseText)}catch{Lt("Failed to parse JSON response for "+s+": "+a.responseText)}r(null,l)}else a.status!==401&&a.status!==404&&Lt("Got unsuccessful REST response for "+s+" Status: "+a.status),r(a.status);r=null}},a.open("GET",s,!0),a.send()})}};var LE=class{constructor(){this.rootNode_=he.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function Op(){return{value:null,children:new Map}}function za(n,e,t){if(_e(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=ye(e);n.children.has(r)||n.children.set(r,Op());let i=n.children.get(r);e=Ue(e),za(i,e,t)}}function jE(n,e){if(_e(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{let t=n.value;return n.value=null,t.forEachChild(He,(r,i)=>{za(n,new Pe(r),i)}),jE(n,e)}}else if(n.children.size>0){let t=ye(e);return e=Ue(e),n.children.has(t)&&jE(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function BE(n,e,t){n.value!==null?t(e,n.value):wz(n,(r,i)=>{let o=new Pe(e.toString()+"/"+r);BE(i,o,t)})}function wz(n,e){n.children.forEach((t,r)=>{e(r,t)})}var UE=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Ct(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var vN=10*1e3,Ez=30*1e3,Iz=5*60*1e3,$E=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new UE(e);let r=vN+(Ez-vN)*Math.random();Dc(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;Ct(e,(i,o)=>{o>0&&Tn(this.statsToReport_,i)&&(t[i]=o,r=!0)}),r&&this.server_.reportStats(t),Dc(this.reportStats_.bind(this),Math.floor(Math.random()*2*Iz))}};var yr=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(yr||{});function AI(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function MI(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function RI(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var HE=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=yr.ACK_USER_WRITE,this.source=AI()}operationForChild(e){if(_e(this.path)){if(this.affectedTree.value!=null)return L(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new Pe(e));return new n(Ne(),t,this.revert)}}else return L(ye(this.path)===e,"operationForChild called for unrelated child."),new n(Ue(this.path),this.affectedTree,this.revert)}};var Fp=class n{constructor(e,t){this.source=e,this.path=t,this.type=yr.LISTEN_COMPLETE}operationForChild(e){return _e(this.path)?new n(this.source,Ne()):new n(this.source,Ue(this.path))}};var Ua=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=yr.OVERWRITE}operationForChild(e){return _e(this.path)?new n(this.source,Ne(),this.snap.getImmediateChild(e)):new n(this.source,Ue(this.path),this.snap)}};var Fc=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=yr.MERGE}operationForChild(e){if(_e(this.path)){let t=this.children.subtree(new Pe(e));return t.isEmpty()?null:t.value?new Ua(this.source,Ne(),t.value):new n(this.source,Ne(),t)}else return L(ye(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,Ue(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var wr=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(_e(e))return this.isFullyInitialized()&&!this.filtered_;let t=ye(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var qE=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function Cz(n,e,t,r){let i=[],o=[];return e.forEach(s=>{s.type==="child_changed"&&n.index_.indexedValueChanged(s.oldSnap,s.snapshotNode)&&o.push(pz(s.childName,s.snapshotNode))}),Cc(n,i,"child_removed",e,r,t),Cc(n,i,"child_added",e,r,t),Cc(n,i,"child_moved",o,r,t),Cc(n,i,"child_changed",e,r,t),Cc(n,i,"value",e,r,t),i}function Cc(n,e,t,r,i,o){let s=r.filter(a=>a.type===t);s.sort((a,l)=>Tz(n,a,l)),s.forEach(a=>{let l=Dz(n,a,o);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,n.query_))})})}function Dz(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function Tz(n,e,t){if(e.childName==null||t.childName==null)throw Ns("Should only compare child_ events.");let r=new ve(e.childName,e.snapshotNode),i=new ve(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function eg(n,e){return{eventCache:n,serverCache:e}}function bc(n,e,t,r){return eg(new wr(e,t,r),n.serverCache)}function lP(n,e,t,r){return eg(n.eventCache,new wr(e,t,r))}function Vp(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Jo(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var hE,bz=()=>(hE||(hE=new Vn(D4)),hE),Zt=class n{static fromObject(e){let t=new n(null);return Ct(e,(r,i)=>{t=t.set(new Pe(r),i)}),t}constructor(e,t=bz()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Ne(),value:this.value};if(_e(e))return null;{let r=ye(e),i=this.children.get(r);if(i!==null){let o=i.findRootMostMatchingPathAndValue(Ue(e),t);return o!=null?{path:Ke(new Pe(r),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(_e(e))return this;{let t=ye(e),r=this.children.get(t);return r!==null?r.subtree(Ue(e)):new n(null)}}set(e,t){if(_e(e))return new n(t,this.children);{let r=ye(e),o=(this.children.get(r)||new n(null)).set(Ue(e),t),s=this.children.insert(r,o);return new n(this.value,s)}}remove(e){if(_e(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=ye(e),r=this.children.get(t);if(r){let i=r.remove(Ue(e)),o;return i.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,i),this.value===null&&o.isEmpty()?new n(null):new n(this.value,o)}else return this}}get(e){if(_e(e))return this.value;{let t=ye(e),r=this.children.get(t);return r?r.get(Ue(e)):null}}setTree(e,t){if(_e(e))return t;{let r=ye(e),o=(this.children.get(r)||new n(null)).setTree(Ue(e),t),s;return o.isEmpty()?s=this.children.remove(r):s=this.children.insert(r,o),new n(this.value,s)}}fold(e){return this.fold_(Ne(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,o)=>{r[i]=o.fold_(Ke(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Ne(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(_e(e))return null;{let o=ye(e),s=this.children.get(o);return s?s.findOnPath_(Ue(e),Ke(t,o),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Ne(),t)}foreachOnPath_(e,t,r){if(_e(e))return this;{this.value&&r(t,this.value);let i=ye(e),o=this.children.get(i);return o?o.foreachOnPath_(Ue(e),Ke(t,i),r):new n(null)}}foreach(e){this.foreach_(Ne(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Ke(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var Jn=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new Zt(null))}};function Sc(n,e,t){if(_e(e))return new Jn(new Zt(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,o=r.value,s=Yt(i,e);return o=o.updateChild(s,t),new Jn(n.writeTree_.set(i,o))}else{let i=new Zt(t),o=n.writeTree_.setTree(e,i);return new Jn(o)}}}function GE(n,e,t){let r=n;return Ct(t,(i,o)=>{r=Sc(r,Ke(e,i),o)}),r}function wN(n,e){if(_e(e))return Jn.empty();{let t=n.writeTree_.setTree(e,new Zt(null));return new Jn(t)}}function zE(n,e){return es(n,e)!=null}function es(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Yt(t.path,e)):null}function EN(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(He,(r,i)=>{e.push(new ve(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ve(r,i.value))}),e}function Fi(n,e){if(_e(e))return n;{let t=es(n,e);return t!=null?new Jn(new Zt(t)):new Jn(n.writeTree_.subtree(e))}}function WE(n){return n.writeTree_.isEmpty()}function $a(n,e){return uP(Ne(),n.writeTree_,e)}function uP(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,o)=>{i===".priority"?(L(o.value!==null,"Priority writes must always be leaf nodes"),r=o.value):t=uP(Ke(n,i),o,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(Ke(n,".priority"),r)),t}}function tg(n,e){return fP(e,n)}function Sz(n,e,t,r,i){L(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Sc(n.visibleWrites,e,t)),n.lastWriteId=r}function Az(n,e,t,r){L(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=GE(n.visibleWrites,e,t),n.lastWriteId=r}function Mz(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function Rz(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);L(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,o=!1,s=n.allWrites.length-1;for(;i&&s>=0;){let a=n.allWrites[s];a.visible&&(s>=t&&xz(a,r.path)?i=!1:Fn(r.path,a.path)&&(o=!0)),s--}if(i){if(o)return Nz(n),!0;if(r.snap)n.visibleWrites=wN(n.visibleWrites,r.path);else{let a=r.children;Ct(a,l=>{n.visibleWrites=wN(n.visibleWrites,Ke(r.path,l))})}return!0}else return!1}function xz(n,e){if(n.snap)return Fn(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&Fn(Ke(n.path,t),e))return!0;return!1}function Nz(n){n.visibleWrites=cP(n.allWrites,Pz,Ne()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function Pz(n){return n.visible}function cP(n,e,t){let r=Jn.empty();for(let i=0;i<n.length;++i){let o=n[i];if(e(o)){let s=o.path,a;if(o.snap)Fn(t,s)?(a=Yt(t,s),r=Sc(r,a,o.snap)):Fn(s,t)&&(a=Yt(s,t),r=Sc(r,Ne(),o.snap.getChild(a)));else if(o.children){if(Fn(t,s))a=Yt(t,s),r=GE(r,a,o.children);else if(Fn(s,t))if(a=Yt(s,t),_e(a))r=GE(r,Ne(),o.children);else{let l=gi(o.children,ye(a));if(l){let c=l.getChild(Ue(a));r=Sc(r,Ne(),c)}}}else throw Ns("WriteRecord should have .snap or .children")}}return r}function dP(n,e,t,r,i){if(!r&&!i){let o=es(n.visibleWrites,e);if(o!=null)return o;{let s=Fi(n.visibleWrites,e);if(WE(s))return t;if(t==null&&!zE(s,Ne()))return null;{let a=t||he.EMPTY_NODE;return $a(s,a)}}}else{let o=Fi(n.visibleWrites,e);if(!i&&WE(o))return t;if(!i&&t==null&&!zE(o,Ne()))return null;{let s=function(c){return(c.visible||i)&&(!r||!~r.indexOf(c.writeId))&&(Fn(c.path,e)||Fn(e,c.path))},a=cP(n.allWrites,s,e),l=t||he.EMPTY_NODE;return $a(a,l)}}}function kz(n,e,t){let r=he.EMPTY_NODE,i=es(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(He,(o,s)=>{r=r.updateImmediateChild(o,s)}),r;if(t){let o=Fi(n.visibleWrites,e);return t.forEachChild(He,(s,a)=>{let l=$a(Fi(o,new Pe(s)),a);r=r.updateImmediateChild(s,l)}),EN(o).forEach(s=>{r=r.updateImmediateChild(s.name,s.node)}),r}else{let o=Fi(n.visibleWrites,e);return EN(o).forEach(s=>{r=r.updateImmediateChild(s.name,s.node)}),r}}function Oz(n,e,t,r,i){L(r||i,"Either existingEventSnap or existingServerSnap must exist");let o=Ke(e,t);if(zE(n.visibleWrites,o))return null;{let s=Fi(n.visibleWrites,o);return WE(s)?i.getChild(t):$a(s,i.getChild(t))}}function Fz(n,e,t,r){let i=Ke(e,t),o=es(n.visibleWrites,i);if(o!=null)return o;if(r.isCompleteForChild(t)){let s=Fi(n.visibleWrites,i);return $a(s,r.getNode().getImmediateChild(t))}else return null}function Vz(n,e){return es(n.visibleWrites,e)}function Lz(n,e,t,r,i,o,s){let a,l=Fi(n.visibleWrites,e),c=es(l,Ne());if(c!=null)a=c;else if(t!=null)a=$a(l,t);else return[];if(a=a.withIndex(s),!a.isEmpty()&&!a.isLeafNode()){let d=[],h=s.getCompare(),g=o?a.getReverseIteratorFrom(r,s):a.getIteratorFrom(r,s),m=g.getNext();for(;m&&d.length<i;)h(m,r)!==0&&d.push(m),m=g.getNext();return d}else return[]}function jz(){return{visibleWrites:Jn.empty(),allWrites:[],lastWriteId:-1}}function Lp(n,e,t,r){return dP(n.writeTree,n.treePath,e,t,r)}function xI(n,e){return kz(n.writeTree,n.treePath,e)}function IN(n,e,t,r){return Oz(n.writeTree,n.treePath,e,t,r)}function jp(n,e){return Vz(n.writeTree,Ke(n.treePath,e))}function Bz(n,e,t,r,i,o){return Lz(n.writeTree,n.treePath,e,t,r,i,o)}function NI(n,e,t){return Fz(n.writeTree,n.treePath,e,t)}function hP(n,e){return fP(Ke(n.treePath,e),n.writeTree)}function fP(n,e){return{treePath:n,writeTree:e}}var KE=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;L(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),L(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let o=i.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(r,Pc(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(r,Nc(r,i.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(r,Ba(r,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(r,Pc(r,e.snapshotNode,i.oldSnap));else throw Ns("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var QE=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},pP=new QE,Vc=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new wr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return NI(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Jo(this.viewCache_),o=Bz(this.writes_,i,t,1,r,e);return o.length===0?null:o[0]}};function Uz(n){return{filter:n}}function $z(n,e){L(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),L(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function Hz(n,e,t,r,i){let o=new KE,s,a;if(t.type===yr.OVERWRITE){let c=t;c.source.fromUser?s=YE(n,e,c.path,c.snap,r,i,o):(L(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!_e(c.path),s=Bp(n,e,c.path,c.snap,r,i,a,o))}else if(t.type===yr.MERGE){let c=t;c.source.fromUser?s=Gz(n,e,c.path,c.children,r,i,o):(L(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),s=ZE(n,e,c.path,c.children,r,i,a,o))}else if(t.type===yr.ACK_USER_WRITE){let c=t;c.revert?s=Kz(n,e,c.path,r,i,o):s=zz(n,e,c.path,c.affectedTree,r,i,o)}else if(t.type===yr.LISTEN_COMPLETE)s=Wz(n,e,t.path,r,o);else throw Ns("Unknown operation type: "+t.type);let l=o.getChanges();return qz(e,s,l),{viewCache:s,changes:l}}function qz(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=Vp(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&t.push(aP(Vp(e)))}}function gP(n,e,t,r,i,o){let s=e.eventCache;if(jp(r,t)!=null)return e;{let a,l;if(_e(t))if(L(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=Jo(e),d=c instanceof he?c:he.EMPTY_NODE,h=xI(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),h,o)}else{let c=Lp(r,Jo(e));a=n.filter.updateFullNode(e.eventCache.getNode(),c,o)}else{let c=ye(t);if(c===".priority"){L(ji(t)===1,"Can't have a priority with additional path components");let d=s.getNode();l=e.serverCache.getNode();let h=IN(r,t,d,l);h!=null?a=n.filter.updatePriority(d,h):a=s.getNode()}else{let d=Ue(t),h;if(s.isCompleteForChild(c)){l=e.serverCache.getNode();let g=IN(r,t,s.getNode(),l);g!=null?h=s.getNode().getImmediateChild(c).updateChild(d,g):h=s.getNode().getImmediateChild(c)}else h=NI(r,c,e.serverCache);h!=null?a=n.filter.updateChild(s.getNode(),c,h,d,i,o):a=s.getNode()}}return bc(e,a,s.isFullyInitialized()||_e(t),n.filter.filtersNodes())}}function Bp(n,e,t,r,i,o,s,a){let l=e.serverCache,c,d=s?n.filter:n.filter.getIndexedFilter();if(_e(t))c=d.updateFullNode(l.getNode(),r,null);else if(d.filtersNodes()&&!l.isFiltered()){let m=l.getNode().updateChild(t,r);c=d.updateFullNode(l.getNode(),m,null)}else{let m=ye(t);if(!l.isCompleteForPath(t)&&ji(t)>1)return e;let v=Ue(t),S=l.getNode().getImmediateChild(m).updateChild(v,r);m===".priority"?c=d.updatePriority(l.getNode(),S):c=d.updateChild(l.getNode(),m,S,v,pP,null)}let h=lP(e,c,l.isFullyInitialized()||_e(t),d.filtersNodes()),g=new Vc(i,h,o);return gP(n,h,t,i,g,a)}function YE(n,e,t,r,i,o,s){let a=e.eventCache,l,c,d=new Vc(i,e,o);if(_e(t))c=n.filter.updateFullNode(e.eventCache.getNode(),r,s),l=bc(e,c,!0,n.filter.filtersNodes());else{let h=ye(t);if(h===".priority")c=n.filter.updatePriority(e.eventCache.getNode(),r),l=bc(e,c,a.isFullyInitialized(),a.isFiltered());else{let g=Ue(t),m=a.getNode().getImmediateChild(h),v;if(_e(g))v=r;else{let D=d.getCompleteChild(h);D!=null?CI(g)===".priority"&&D.getChild(tP(g)).isEmpty()?v=D:v=D.updateChild(g,r):v=he.EMPTY_NODE}if(m.equals(v))l=e;else{let D=n.filter.updateChild(a.getNode(),h,v,g,d,s);l=bc(e,D,a.isFullyInitialized(),n.filter.filtersNodes())}}}return l}function CN(n,e){return n.eventCache.isCompleteForChild(e)}function Gz(n,e,t,r,i,o,s){let a=e;return r.foreach((l,c)=>{let d=Ke(t,l);CN(e,ye(d))&&(a=YE(n,a,d,c,i,o,s))}),r.foreach((l,c)=>{let d=Ke(t,l);CN(e,ye(d))||(a=YE(n,a,d,c,i,o,s))}),a}function DN(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function ZE(n,e,t,r,i,o,s,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;_e(t)?c=r:c=new Zt(null).setTree(t,r);let d=e.serverCache.getNode();return c.children.inorderTraversal((h,g)=>{if(d.hasChild(h)){let m=e.serverCache.getNode().getImmediateChild(h),v=DN(n,m,g);l=Bp(n,l,new Pe(h),v,i,o,s,a)}}),c.children.inorderTraversal((h,g)=>{let m=!e.serverCache.isCompleteForChild(h)&&g.value===null;if(!d.hasChild(h)&&!m){let v=e.serverCache.getNode().getImmediateChild(h),D=DN(n,v,g);l=Bp(n,l,new Pe(h),D,i,o,s,a)}}),l}function zz(n,e,t,r,i,o,s){if(jp(i,t)!=null)return e;let a=e.serverCache.isFiltered(),l=e.serverCache;if(r.value!=null){if(_e(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return Bp(n,e,t,l.getNode().getChild(t),i,o,a,s);if(_e(t)){let c=new Zt(null);return l.getNode().forEachChild(_r,(d,h)=>{c=c.set(new Pe(d),h)}),ZE(n,e,t,c,i,o,a,s)}else return e}else{let c=new Zt(null);return r.foreach((d,h)=>{let g=Ke(t,d);l.isCompleteForPath(g)&&(c=c.set(d,l.getNode().getChild(g)))}),ZE(n,e,t,c,i,o,a,s)}}function Wz(n,e,t,r,i){let o=e.serverCache,s=lP(e,o.getNode(),o.isFullyInitialized()||_e(t),o.isFiltered());return gP(n,s,t,r,pP,i)}function Kz(n,e,t,r,i,o){let s;if(jp(r,t)!=null)return e;{let a=new Vc(r,e,i),l=e.eventCache.getNode(),c;if(_e(t)||ye(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=Lp(r,Jo(e));else{let h=e.serverCache.getNode();L(h instanceof he,"serverChildren would be complete if leaf node"),d=xI(r,h)}d=d,c=n.filter.updateFullNode(l,d,o)}else{let d=ye(t),h=NI(r,d,e.serverCache);h==null&&e.serverCache.isCompleteForChild(d)&&(h=l.getImmediateChild(d)),h!=null?c=n.filter.updateChild(l,d,h,Ue(t),a,o):e.eventCache.getNode().hasChild(d)?c=n.filter.updateChild(l,d,he.EMPTY_NODE,Ue(t),a,o):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(s=Lp(r,Jo(e)),s.isLeafNode()&&(c=n.filter.updateFullNode(c,s,o)))}return s=e.serverCache.isFullyInitialized()||jp(r,Ne())!=null,bc(e,c,s,n.filter.filtersNodes())}}var JE=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new kc(r.getIndex()),o=gz(r);this.processor_=Uz(o);let s=t.serverCache,a=t.eventCache,l=i.updateFullNode(he.EMPTY_NODE,s.getNode(),null),c=o.updateFullNode(he.EMPTY_NODE,a.getNode(),null),d=new wr(l,s.isFullyInitialized(),i.filtersNodes()),h=new wr(c,a.isFullyInitialized(),o.filtersNodes());this.viewCache_=eg(h,d),this.eventGenerator_=new qE(this.query_)}get query(){return this.query_}};function Qz(n){return n.viewCache_.serverCache.getNode()}function Yz(n){return Vp(n.viewCache_)}function Zz(n,e){let t=Jo(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!_e(e)&&!t.getImmediateChild(ye(e)).isEmpty())?t.getChild(e):null}function TN(n){return n.eventRegistrations_.length===0}function Jz(n,e){n.eventRegistrations_.push(e)}function bN(n,e,t){let r=[];if(t){L(e==null,"A cancel should cancel all event registrations.");let i=n.query._path;n.eventRegistrations_.forEach(o=>{let s=o.createCancelEvent(t,i);s&&r.push(s)})}if(e){let i=[];for(let o=0;o<n.eventRegistrations_.length;++o){let s=n.eventRegistrations_[o];if(!s.matches(e))i.push(s);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(o+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function SN(n,e,t,r){e.type===yr.MERGE&&e.source.queryId!==null&&(L(Jo(n.viewCache_),"We should always have a full cache before handling merges"),L(Vp(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,o=Hz(n.processor_,i,e,t,r);return $z(n.processor_,o.viewCache),L(o.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,mP(n,o.changes,o.viewCache.eventCache.getNode(),null)}function Xz(n,e){let t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(He,(o,s)=>{r.push(Ba(o,s))}),t.isFullyInitialized()&&r.push(aP(t.getNode())),mP(n,r,t.getNode(),e)}function mP(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return Cz(n.eventGenerator_,e,t,i)}var Up,$p=class{constructor(){this.views=new Map}};function eW(n){L(!Up,"__referenceConstructor has already been defined"),Up=n}function tW(){return L(Up,"Reference.ts has not been loaded"),Up}function nW(n){return n.views.size===0}function PI(n,e,t,r){let i=e.source.queryId;if(i!==null){let o=n.views.get(i);return L(o!=null,"SyncTree gave us an op for an invalid query."),SN(o,e,t,r)}else{let o=[];for(let s of n.views.values())o=o.concat(SN(s,e,t,r));return o}}function yP(n,e,t,r,i){let o=e._queryIdentifier,s=n.views.get(o);if(!s){let a=Lp(t,i?r:null),l=!1;a?l=!0:r instanceof he?(a=xI(t,r),l=!1):(a=he.EMPTY_NODE,l=!1);let c=eg(new wr(a,l,!1),new wr(r,i,!1));return new JE(e,c)}return s}function rW(n,e,t,r,i,o){let s=yP(n,e,r,i,o);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,s),Jz(s,t),Xz(s,t)}function iW(n,e,t,r){let i=e._queryIdentifier,o=[],s=[],a=Bi(n);if(i==="default")for(let[l,c]of n.views.entries())s=s.concat(bN(c,t,r)),TN(c)&&(n.views.delete(l),c.query._queryParams.loadsAllData()||o.push(c.query));else{let l=n.views.get(i);l&&(s=s.concat(bN(l,t,r)),TN(l)&&(n.views.delete(i),l.query._queryParams.loadsAllData()||o.push(l.query)))}return a&&!Bi(n)&&o.push(new(tW())(e._repo,e._path)),{removed:o,events:s}}function _P(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Vi(n,e){let t=null;for(let r of n.views.values())t=t||Zz(r,e);return t}function vP(n,e){if(e._queryParams.loadsAllData())return ng(n);{let r=e._queryIdentifier;return n.views.get(r)}}function wP(n,e){return vP(n,e)!=null}function Bi(n){return ng(n)!=null}function ng(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Hp;function oW(n){L(!Hp,"__referenceConstructor has already been defined"),Hp=n}function sW(){return L(Hp,"Reference.ts has not been loaded"),Hp}var aW=1,qp=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Zt(null),this.pendingWriteTree_=jz(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function kI(n,e,t,r,i){return Sz(n.pendingWriteTree_,e,t,r,i),i?Wa(n,new Ua(AI(),e,t)):[]}function lW(n,e,t,r){Az(n.pendingWriteTree_,e,t,r);let i=Zt.fromObject(t);return Wa(n,new Fc(AI(),e,i))}function Oi(n,e,t=!1){let r=Mz(n.pendingWriteTree_,e);if(Rz(n.pendingWriteTree_,e)){let o=new Zt(null);return r.snap!=null?o=o.set(Ne(),!0):Ct(r.children,s=>{o=o.set(new Pe(s),!0)}),Wa(n,new HE(r.path,o,t))}else return[]}function zc(n,e,t){return Wa(n,new Ua(MI(),e,t))}function uW(n,e,t){let r=Zt.fromObject(t);return Wa(n,new Fc(MI(),e,r))}function cW(n,e){return Wa(n,new Fp(MI(),e))}function dW(n,e,t){let r=OI(n,t);if(r){let i=FI(r),o=i.path,s=i.queryId,a=Yt(o,e),l=new Fp(RI(s),a);return VI(n,o,l)}else return[]}function Gp(n,e,t,r,i=!1){let o=e._path,s=n.syncPointTree_.get(o),a=[];if(s&&(e._queryIdentifier==="default"||wP(s,e))){let l=iW(s,e,t,r);nW(s)&&(n.syncPointTree_=n.syncPointTree_.remove(o));let c=l.removed;if(a=l.events,!i){let d=c.findIndex(g=>g._queryParams.loadsAllData())!==-1,h=n.syncPointTree_.findOnPath(o,(g,m)=>Bi(m));if(d&&!h){let g=n.syncPointTree_.subtree(o);if(!g.isEmpty()){let m=pW(g);for(let v=0;v<m.length;++v){let D=m[v],S=D.query,P=DP(n,D);n.listenProvider_.startListening(Ac(S),Lc(n,S),P.hashFn,P.onComplete)}}}!h&&c.length>0&&!r&&(d?n.listenProvider_.stopListening(Ac(e),null):c.forEach(g=>{let m=n.queryToTagMap.get(ig(g));n.listenProvider_.stopListening(Ac(g),m)}))}gW(n,c)}return a}function EP(n,e,t,r){let i=OI(n,r);if(i!=null){let o=FI(i),s=o.path,a=o.queryId,l=Yt(s,e),c=new Ua(RI(a),l,t);return VI(n,s,c)}else return[]}function hW(n,e,t,r){let i=OI(n,r);if(i){let o=FI(i),s=o.path,a=o.queryId,l=Yt(s,e),c=Zt.fromObject(t),d=new Fc(RI(a),l,c);return VI(n,s,d)}else return[]}function XE(n,e,t,r=!1){let i=e._path,o=null,s=!1;n.syncPointTree_.foreachOnPath(i,(g,m)=>{let v=Yt(g,i);o=o||Vi(m,v),s=s||Bi(m)});let a=n.syncPointTree_.get(i);a?(s=s||Bi(a),o=o||Vi(a,Ne())):(a=new $p,n.syncPointTree_=n.syncPointTree_.set(i,a));let l;o!=null?l=!0:(l=!1,o=he.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((m,v)=>{let D=Vi(v,Ne());D&&(o=o.updateImmediateChild(m,D))}));let c=wP(a,e);if(!c&&!e._queryParams.loadsAllData()){let g=ig(e);L(!n.queryToTagMap.has(g),"View does not exist, but we have a tag");let m=mW();n.queryToTagMap.set(g,m),n.tagToQueryMap.set(m,g)}let d=tg(n.pendingWriteTree_,i),h=rW(a,e,t,d,o,l);if(!c&&!s&&!r){let g=vP(a,e);h=h.concat(yW(n,e,g))}return h}function rg(n,e,t){let i=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(s,a)=>{let l=Yt(s,e),c=Vi(a,l);if(c)return c});return dP(i,e,o,t,!0)}function fW(n,e){let t=e._path,r=null;n.syncPointTree_.foreachOnPath(t,(c,d)=>{let h=Yt(c,t);r=r||Vi(d,h)});let i=n.syncPointTree_.get(t);i?r=r||Vi(i,Ne()):(i=new $p,n.syncPointTree_=n.syncPointTree_.set(t,i));let o=r!=null,s=o?new wr(r,!0,!1):null,a=tg(n.pendingWriteTree_,e._path),l=yP(i,e,a,o?s.getNode():he.EMPTY_NODE,o);return Yz(l)}function Wa(n,e){return IP(e,n.syncPointTree_,null,tg(n.pendingWriteTree_,Ne()))}function IP(n,e,t,r){if(_e(n.path))return CP(n,e,t,r);{let i=e.get(Ne());t==null&&i!=null&&(t=Vi(i,Ne()));let o=[],s=ye(n.path),a=n.operationForChild(s),l=e.children.get(s);if(l&&a){let c=t?t.getImmediateChild(s):null,d=hP(r,s);o=o.concat(IP(a,l,c,d))}return i&&(o=o.concat(PI(i,n,r,t))),o}}function CP(n,e,t,r){let i=e.get(Ne());t==null&&i!=null&&(t=Vi(i,Ne()));let o=[];return e.children.inorderTraversal((s,a)=>{let l=t?t.getImmediateChild(s):null,c=hP(r,s),d=n.operationForChild(s);d&&(o=o.concat(CP(d,a,l,c)))}),i&&(o=o.concat(PI(i,n,r,t))),o}function DP(n,e){let t=e.query,r=Lc(n,t);return{hashFn:()=>(Qz(e)||he.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?dW(n,t._path,r):cW(n,t._path);{let o=S4(i,t);return Gp(n,t,null,o)}}}}function Lc(n,e){let t=ig(e);return n.queryToTagMap.get(t)}function ig(n){return n._path.toString()+"$"+n._queryIdentifier}function OI(n,e){return n.tagToQueryMap.get(e)}function FI(n){let e=n.indexOf("$");return L(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Pe(n.substr(0,e))}}function VI(n,e,t){let r=n.syncPointTree_.get(e);L(r,"Missing sync point for query tag that we're tracking");let i=tg(n.pendingWriteTree_,e);return PI(r,t,i,null)}function pW(n){return n.fold((e,t,r)=>{if(t&&Bi(t))return[ng(t)];{let i=[];return t&&(i=_P(t)),Ct(r,(o,s)=>{i=i.concat(s)}),i}})}function Ac(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(sW())(n._repo,n._path):n}function gW(n,e){for(let t=0;t<e.length;++t){let r=e[t];if(!r._queryParams.loadsAllData()){let i=ig(r),o=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(o)}}}function mW(){return aW++}function yW(n,e,t){let r=e._path,i=Lc(n,e),o=DP(n,t),s=n.listenProvider_.startListening(Ac(e),i,o.hashFn,o.onComplete),a=n.syncPointTree_.subtree(r);if(i)L(!Bi(a.value),"If we're adding a query, it shouldn't be shadowed");else{let l=a.fold((c,d,h)=>{if(!_e(c)&&d&&Bi(d))return[ng(d).query];{let g=[];return d&&(g=g.concat(_P(d).map(m=>m.query))),Ct(h,(m,v)=>{g=g.concat(v)}),g}});for(let c=0;c<l.length;++c){let d=l[c];n.listenProvider_.stopListening(Ac(d),Lc(n,d))}}return s}var eI=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},tI=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=Ke(this.path_,e);return new n(this.syncTree_,t)}node(){return rg(this.syncTree_,this.path_)}},_W=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},AN=function(n,e,t){if(!n||typeof n!="object")return n;if(L(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return vW(n[".sv"],e,t);if(typeof n[".sv"]=="object")return wW(n[".sv"],e);L(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},vW=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:L(!1,"Unexpected server value: "+n)}},wW=function(n,e,t){n.hasOwnProperty("increment")||L(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&L(!1,"Unexpected increment value: "+r);let i=e.node();if(L(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let s=i.getValue();return typeof s!="number"?r:s+r},TP=function(n,e,t,r){return jI(e,new tI(t,n),r)},LI=function(n,e,t){return jI(n,new eI(e),t)};function jI(n,e,t){let r=n.getPriority().val(),i=AN(r,e.getImmediateChild(".priority"),t),o;if(n.isLeafNode()){let s=n,a=AN(s.getValue(),e,t);return a!==s.getValue()||i!==s.getPriority().val()?new La(a,Ze(i)):n}else{let s=n;return o=s,i!==s.getPriority().val()&&(o=o.updatePriority(new La(i))),s.forEachChild(He,(a,l)=>{let c=jI(l,e.getImmediateChild(a),t);c!==l&&(o=o.updateImmediateChild(a,c))}),o}}var jc=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function og(n,e){let t=e instanceof Pe?e:new Pe(e),r=n,i=ye(t);for(;i!==null;){let o=gi(r.node.children,i)||{children:{},childCount:0};r=new jc(i,r,o),t=Ue(t),i=ye(t)}return r}function ts(n){return n.node.value}function BI(n,e){n.node.value=e,nI(n)}function bP(n){return n.node.childCount>0}function EW(n){return ts(n)===void 0&&!bP(n)}function sg(n,e){Ct(n.node.children,(t,r)=>{e(new jc(t,n,r))})}function SP(n,e,t,r){t&&!r&&e(n),sg(n,i=>{SP(i,e,!0,r)}),t&&r&&e(n)}function IW(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Wc(n){return new Pe(n.parent===null?n.name:Wc(n.parent)+"/"+n.name)}function nI(n){n.parent!==null&&CW(n.parent,n.name,n)}function CW(n,e,t){let r=EW(t),i=Tn(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,nI(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,nI(n))}var DW=/[\[\].#$\/\u0000-\u001F\u007F]/,TW=/[\[\].#$\u0000-\u001F\u007F]/,fE=10*1024*1024,ag=function(n){return typeof n=="string"&&n.length!==0&&!DW.test(n)},AP=function(n){return typeof n=="string"&&n.length!==0&&!TW.test(n)},bW=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),AP(n)},Bc=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!Jp(n)||n&&typeof n=="object"&&Tn(n,".sv")},Er=function(n,e,t,r){r&&e===void 0||Kc(tn(n,"value"),e,t)},Kc=function(n,e,t){let r=t instanceof Pe?new bE(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Qo(r));if(typeof e=="function")throw new Error(n+"contains a function "+Qo(r)+" with contents = "+e.toString());if(Jp(e))throw new Error(n+"contains "+e.toString()+" "+Qo(r));if(typeof e=="string"&&e.length>fE/3&&iu(e)>fE)throw new Error(n+"contains a string greater than "+fE+" utf8 bytes "+Qo(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,o=!1;if(Ct(e,(s,a)=>{if(s===".value")i=!0;else if(s!==".priority"&&s!==".sv"&&(o=!0,!ag(s)))throw new Error(n+" contains an invalid key ("+s+") "+Qo(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);nz(r,s),Kc(n,a,r),rz(r)}),i&&o)throw new Error(n+' contains ".value" child '+Qo(r)+" in addition to actual children.")}},SW=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];let o=Rc(r);for(let s=0;s<o.length;s++)if(!(o[s]===".priority"&&s===o.length-1)){if(!ag(o[s]))throw new Error(n+"contains an invalid key ("+o[s]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(tz);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&Fn(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},MP=function(n,e,t,r){if(r&&e===void 0)return;let i=tn(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let o=[];Ct(e,(s,a)=>{let l=new Pe(s);if(Kc(i,a,Ke(t,l)),CI(l)===".priority"&&!Bc(a))throw new Error(i+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(l)}),SW(i,o)},UI=function(n,e,t){if(!(t&&e===void 0)){if(Jp(e))throw new Error(tn(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Bc(e))throw new Error(tn(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Qc=function(n,e,t,r){if(!(r&&t===void 0)&&!ag(t))throw new Error(tn(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Ka=function(n,e,t,r){if(!(r&&t===void 0)&&!AP(t))throw new Error(tn(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},AW=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Ka(n,e,t,r)},vn=function(n,e){if(ye(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},RP=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!ag(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!bW(t))throw new Error(tn(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var rI=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function lg(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],o=i.getPath();t!==null&&!DI(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(i)}t&&n.eventLists_.push(t)}function xP(n,e,t){lg(n,t),NP(n,r=>DI(r,e))}function wn(n,e,t){lg(n,t),NP(n,r=>Fn(r,e)||Fn(e,r))}function NP(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let o=i.path;e(o)?(MW(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function MW(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();Zo&&It("event: "+t.toString()),Ga(r)}}}var PP="repo_interrupt",RW=25,iI=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new rI,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Op(),this.transactionQueueTree_=new jc,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function xW(n,e,t){if(n.stats_=II(n.repoInfo_),n.forceRestClient_||x4())n.server_=new VE(n.repoInfo_,(r,i,o,s)=>{MN(n,r,i,o,s)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>RN(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ut(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new TI(n.repoInfo_,e,(r,i,o,s)=>{MN(n,r,i,o,s)},r=>{RN(n,r)},r=>{NW(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=P4(n.repoInfo_,()=>new $E(n.stats_,n.server_)),n.infoData_=new LE,n.infoSyncTree_=new qp({startListening:(r,i,o,s)=>{let a=[],l=n.infoData_.getNode(r._path);return l.isEmpty()||(a=zc(n.infoSyncTree_,r._path,l),setTimeout(()=>{s("ok")},0)),a},stopListening:()=>{}}),$I(n,"connected",!1),n.serverSyncTree_=new qp({startListening:(r,i,o,s)=>(n.server_.listen(r,o,i,(a,l)=>{let c=s(a,l);wn(n.eventQueue_,r._path,c)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function kP(n){let t=n.infoData_.getNode(new Pe(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Yc(n){return _W({timestamp:kP(n)})}function MN(n,e,t,r,i){n.dataUpdateCount++;let o=new Pe(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let s=[];if(i)if(r){let l=ru(t,c=>Ze(c));s=hW(n.serverSyncTree_,o,l,i)}else{let l=Ze(t);s=EP(n.serverSyncTree_,o,l,i)}else if(r){let l=ru(t,c=>Ze(c));s=uW(n.serverSyncTree_,o,l)}else{let l=Ze(t);s=zc(n.serverSyncTree_,o,l)}let a=o;s.length>0&&(a=Ha(n,o)),wn(n.eventQueue_,a,s)}function RN(n,e){$I(n,"connected",e),e===!1&&OW(n)}function NW(n,e){Ct(e,(t,r)=>{$I(n,t,r)})}function $I(n,e,t){let r=new Pe("/.info/"+e),i=Ze(t);n.infoData_.updateSnapshot(r,i);let o=zc(n.infoSyncTree_,r,i);wn(n.eventQueue_,r,o)}function ug(n){return n.nextWriteId_++}function PW(n,e,t){let r=fW(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{let o=Ze(i).withIndex(e._queryParams.getIndex());XE(n.serverSyncTree_,e,t,!0);let s;if(e._queryParams.loadsAllData())s=zc(n.serverSyncTree_,e._path,o);else{let a=Lc(n.serverSyncTree_,e);s=EP(n.serverSyncTree_,e._path,o,a)}return wn(n.eventQueue_,e._path,s),Gp(n.serverSyncTree_,e,t,null,!0),o},i=>(Qa(n,"get for query "+ut(e)+" failed: "+i),Promise.reject(new Error(i))))}function HI(n,e,t,r,i){Qa(n,"set",{path:e.toString(),value:t,priority:r});let o=Yc(n),s=Ze(t,r),a=rg(n.serverSyncTree_,e),l=LI(s,a,o),c=ug(n),d=kI(n.serverSyncTree_,e,l,c,!0);lg(n.eventQueue_,d),n.server_.put(e.toString(),s.val(!0),(g,m)=>{let v=g==="ok";v||Lt("set at "+e+" failed: "+g);let D=Oi(n.serverSyncTree_,c,!v);wn(n.eventQueue_,e,D),Ui(n,i,g,m)});let h=GI(n,e);Ha(n,h),wn(n.eventQueue_,h,[])}function kW(n,e,t,r){Qa(n,"update",{path:e.toString(),value:t});let i=!0,o=Yc(n),s={};if(Ct(t,(a,l)=>{i=!1,s[a]=TP(Ke(e,a),Ze(l),n.serverSyncTree_,o)}),i)It("update() called with empty data.  Don't do anything."),Ui(n,r,"ok",void 0);else{let a=ug(n),l=lW(n.serverSyncTree_,e,s,a);lg(n.eventQueue_,l),n.server_.merge(e.toString(),t,(c,d)=>{let h=c==="ok";h||Lt("update at "+e+" failed: "+c);let g=Oi(n.serverSyncTree_,a,!h),m=g.length>0?Ha(n,e):e;wn(n.eventQueue_,m,g),Ui(n,r,c,d)}),Ct(t,c=>{let d=GI(n,Ke(e,c));Ha(n,d)}),wn(n.eventQueue_,e,[])}}function OW(n){Qa(n,"onDisconnectEvents");let e=Yc(n),t=Op();BE(n.onDisconnect_,Ne(),(i,o)=>{let s=TP(i,o,n.serverSyncTree_,e);za(t,i,s)});let r=[];BE(t,Ne(),(i,o)=>{r=r.concat(zc(n.serverSyncTree_,i,o));let s=GI(n,i);Ha(n,s)}),n.onDisconnect_=Op(),wn(n.eventQueue_,Ne(),r)}function FW(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&jE(n.onDisconnect_,e),Ui(n,t,r,i)})}function xN(n,e,t,r){let i=Ze(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(o,s)=>{o==="ok"&&za(n.onDisconnect_,e,i),Ui(n,r,o,s)})}function VW(n,e,t,r,i){let o=Ze(t,r);n.server_.onDisconnectPut(e.toString(),o.val(!0),(s,a)=>{s==="ok"&&za(n.onDisconnect_,e,o),Ui(n,i,s,a)})}function LW(n,e,t,r){if(uh(t)){It("onDisconnect().update() called with empty data.  Don't do anything."),Ui(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,o)=>{i==="ok"&&Ct(t,(s,a)=>{let l=Ze(a);za(n.onDisconnect_,Ke(e,s),l)}),Ui(n,r,i,o)})}function jW(n,e,t){let r;ye(e._path)===".info"?r=XE(n.infoSyncTree_,e,t):r=XE(n.serverSyncTree_,e,t),xP(n.eventQueue_,e._path,r)}function oI(n,e,t){let r;ye(e._path)===".info"?r=Gp(n.infoSyncTree_,e,t):r=Gp(n.serverSyncTree_,e,t),xP(n.eventQueue_,e._path,r)}function OP(n){n.persistentConnection_&&n.persistentConnection_.interrupt(PP)}function BW(n){n.persistentConnection_&&n.persistentConnection_.resume(PP)}function Qa(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),It(t,...e)}function Ui(n,e,t,r){e&&Ga(()=>{if(t==="ok")e(null);else{let i=(t||"error").toUpperCase(),o=i;r&&(o+=": "+r);let s=new Error(o);s.code=i,e(s)}})}function UW(n,e,t,r,i,o){Qa(n,"transaction on "+e);let s={path:e,update:t,onComplete:r,status:null,order:kN(),applyLocally:o,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=qI(n,e,void 0);s.currentInputSnapshot=a;let l=s.update(a.val());if(l===void 0)s.unwatcher(),s.currentOutputSnapshotRaw=null,s.currentOutputSnapshotResolved=null,s.onComplete&&s.onComplete(null,!1,s.currentInputSnapshot);else{Kc("transaction failed: Data returned ",l,s.path),s.status=0;let c=og(n.transactionQueueTree_,e),d=ts(c)||[];d.push(s),BI(c,d);let h;typeof l=="object"&&l!==null&&Tn(l,".priority")?(h=gi(l,".priority"),L(Bc(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(rg(n.serverSyncTree_,e)||he.EMPTY_NODE).getPriority().val();let g=Yc(n),m=Ze(l,h),v=LI(m,a,g);s.currentOutputSnapshotRaw=m,s.currentOutputSnapshotResolved=v,s.currentWriteId=ug(n);let D=kI(n.serverSyncTree_,e,v,s.currentWriteId,s.applyLocally);wn(n.eventQueue_,e,D),cg(n,n.transactionQueueTree_)}}function qI(n,e,t){return rg(n.serverSyncTree_,e,t)||he.EMPTY_NODE}function cg(n,e=n.transactionQueueTree_){if(e||dg(n,e),ts(e)){let t=VP(n,e);L(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&$W(n,Wc(e),t)}else bP(e)&&sg(e,t=>{cg(n,t)})}function $W(n,e,t){let r=t.map(c=>c.currentWriteId),i=qI(n,e,r),o=i,s=i.hash();for(let c=0;c<t.length;c++){let d=t[c];L(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let h=Yt(e,d.path);o=o.updateChild(h,d.currentOutputSnapshotRaw)}let a=o.val(!0),l=e;n.server_.put(l.toString(),a,c=>{Qa(n,"transaction put response",{path:l.toString(),status:c});let d=[];if(c==="ok"){let h=[];for(let g=0;g<t.length;g++)t[g].status=2,d=d.concat(Oi(n.serverSyncTree_,t[g].currentWriteId)),t[g].onComplete&&h.push(()=>t[g].onComplete(null,!0,t[g].currentOutputSnapshotResolved)),t[g].unwatcher();dg(n,og(n.transactionQueueTree_,e)),cg(n,n.transactionQueueTree_),wn(n.eventQueue_,e,d);for(let g=0;g<h.length;g++)Ga(h[g])}else{if(c==="datastale")for(let h=0;h<t.length;h++)t[h].status===3?t[h].status=4:t[h].status=0;else{Lt("transaction at "+l.toString()+" failed: "+c);for(let h=0;h<t.length;h++)t[h].status=4,t[h].abortReason=c}Ha(n,e)}},s)}function Ha(n,e){let t=FP(n,e),r=Wc(t),i=VP(n,t);return HW(n,i,r),r}function HW(n,e,t){if(e.length===0)return;let r=[],i=[],s=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let l=e[a],c=Yt(t,l.path),d=!1,h;if(L(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)d=!0,h=l.abortReason,i=i.concat(Oi(n.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=RW)d=!0,h="maxretry",i=i.concat(Oi(n.serverSyncTree_,l.currentWriteId,!0));else{let g=qI(n,l.path,s);l.currentInputSnapshot=g;let m=e[a].update(g.val());if(m!==void 0){Kc("transaction failed: Data returned ",m,l.path);let v=Ze(m);typeof m=="object"&&m!=null&&Tn(m,".priority")||(v=v.updatePriority(g.getPriority()));let S=l.currentWriteId,P=Yc(n),j=LI(v,g,P);l.currentOutputSnapshotRaw=v,l.currentOutputSnapshotResolved=j,l.currentWriteId=ug(n),s.splice(s.indexOf(S),1),i=i.concat(kI(n.serverSyncTree_,l.path,j,l.currentWriteId,l.applyLocally)),i=i.concat(Oi(n.serverSyncTree_,S,!0))}else d=!0,h="nodata",i=i.concat(Oi(n.serverSyncTree_,l.currentWriteId,!0))}wn(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(g){setTimeout(g,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}dg(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)Ga(r[a]);cg(n,n.transactionQueueTree_)}function FP(n,e){let t,r=n.transactionQueueTree_;for(t=ye(e);t!==null&&ts(r)===void 0;)r=og(r,t),e=Ue(e),t=ye(e);return r}function VP(n,e){let t=[];return LP(n,e,t),t.sort((r,i)=>r.order-i.order),t}function LP(n,e,t){let r=ts(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);sg(e,i=>{LP(n,i,t)})}function dg(n,e){let t=ts(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,BI(e,t.length>0?t:void 0)}sg(e,r=>{dg(n,r)})}function GI(n,e){let t=Wc(FP(n,e)),r=og(n.transactionQueueTree_,e);return IW(r,i=>{pE(n,i)}),pE(n,r),SP(r,i=>{pE(n,i)}),t}function pE(n,e){let t=ts(e);if(t){let r=[],i=[],o=-1;for(let s=0;s<t.length;s++)t[s].status===3||(t[s].status===1?(L(o===s-1,"All SENT items should be at beginning of queue."),o=s,t[s].status=3,t[s].abortReason="set"):(L(t[s].status===0,"Unexpected transaction status in abort"),t[s].unwatcher(),i=i.concat(Oi(n.serverSyncTree_,t[s].currentWriteId,!0)),t[s].onComplete&&r.push(t[s].onComplete.bind(null,new Error("set"),!1,null))));o===-1?BI(e,void 0):t.length=o+1,wn(n.eventQueue_,Wc(e),i);for(let s=0;s<r.length;s++)Ga(r[s])}}function qW(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function GW(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Lt(`Invalid query segment '${t}' in query '${n}'`)}return e}var sI=function(n,e){let t=zW(n),r=t.namespace;t.domain==="firebase.com"&&vr(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&vr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||I4();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Sp(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new Pe(t.pathString)}},zW=function(n){let e="",t="",r="",i="",o="",s=!0,a="https",l=443;if(typeof n=="string"){let c=n.indexOf("//");c>=0&&(a=n.substring(0,c-1),n=n.substring(c+2));let d=n.indexOf("/");d===-1&&(d=n.length);let h=n.indexOf("?");h===-1&&(h=n.length),e=n.substring(0,Math.min(d,h)),d<h&&(i=qW(n.substring(d,h)));let g=GW(n.substring(Math.min(n.length,h)));c=e.indexOf(":"),c>=0?(s=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;let m=e.slice(0,c);if(m.toLowerCase()==="localhost")t="localhost";else if(m.split(".").length<=2)t=m;else{let v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),t=e.substring(v+1),o=r}"ns"in g&&(o=g.ns)}return{host:e,port:l,domain:t,subdomain:r,secure:s,scheme:a,pathString:i,namespace:o}};var NN="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",WW=function(){let n=0,e=[];return function(t){let r=t===n;n=t;let i,o=new Array(8);for(i=7;i>=0;i--)o[i]=NN.charAt(t%64),t=Math.floor(t/64);L(t===0,"Cannot push at time == 0");let s=o.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)s+=NN.charAt(e[i]);return L(s.length===20,"nextPushId: Length should be 20."),s}}();var zp=class{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ut(this.snapshot.exportVal())}},Wp=class{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Uc=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return L(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Kp=class{constructor(e,t){this._repo=e,this._path=t}cancel(){let e=new Et;return FW(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){vn("OnDisconnect.remove",this._path);let e=new Et;return xN(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){vn("OnDisconnect.set",this._path),Er("OnDisconnect.set",e,this._path,!1);let t=new Et;return xN(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){vn("OnDisconnect.setWithPriority",this._path),Er("OnDisconnect.setWithPriority",e,this._path,!1),UI("OnDisconnect.setWithPriority",t,!1);let r=new Et;return VW(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){vn("OnDisconnect.update",this._path),MP("OnDisconnect.update",e,this._path,!1);let t=new Et;return LW(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};var Jt=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return _e(this._path)?null:CI(this._path)}get ref(){return new En(this._repo,this._path)}get _queryIdentifier(){let e=_N(this._queryParams),t=EI(e);return t==="{}"?"default":t}get _queryObject(){return _N(this._queryParams)}isEqual(e){if(e=we(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=DI(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+ez(this._path)}};function hg(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Hi(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===_r){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Li)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==Zr)throw new Error(r);if(typeof t!="string")throw new Error(i)}}else if(n.getIndex()===He){if(e!=null&&!Bc(e)||t!=null&&!Bc(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(L(n.getIndex()instanceof xc||n.getIndex()===SI,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function fg(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var En=class n extends Jt{constructor(e,t){super(e,t,new Oc,!1)}get parent(){let e=tP(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},qa=class n{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new Pe(e),r=$i(this.ref,e);return new n(this._node.getChild(t),r,He)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new n(i,$i(this.ref,r),He)))}hasChild(e){let t=new Pe(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function zI(n,e){return n=we(n),n._checkNotDeleted("ref"),e!==void 0?$i(n._root,e):n._root}function WI(n,e){n=we(n),n._checkNotDeleted("refFromURL");let t=sI(e,n._repo.repoInfo_.nodeAdmin);RP("refFromURL",t);let r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&vr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),zI(n,t.path.toString())}function $i(n,e){return n=we(n),ye(n._path)===null?AW("child","path",e,!1):Ka("child","path",e,!1),new En(n._repo,Ke(n._path,e))}function jP(n,e){n=we(n),vn("push",n._path),Er("push",e,n._path,!0);let t=kP(n._repo),r=WW(t),i=$i(n,r),o=$i(n,r),s;return e!=null?s=pg(o,e).then(()=>o):s=Promise.resolve(o),i.then=s.then.bind(s),i.catch=s.then.bind(s,void 0),i}function BP(n){return vn("remove",n._path),pg(n,null)}function pg(n,e){n=we(n),vn("set",n._path),Er("set",e,n._path,!1);let t=new Et;return HI(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function UP(n,e){n=we(n),vn("setPriority",n._path),UI("setPriority",e,!1);let t=new Et;return HI(n._repo,Ke(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function $P(n,e,t){if(vn("setWithPriority",n._path),Er("setWithPriority",e,n._path,!1),UI("setWithPriority",t,!1),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";let r=new Et;return HI(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function HP(n,e){MP("update",e,n._path,!1);let t=new Et;return kW(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function qP(n){n=we(n);let e=new Uc(()=>{}),t=new $c(e);return PW(n._repo,n,t).then(r=>new qa(r,new En(n._repo,n._path),n._queryParams.getIndex()))}var $c=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let r=t._queryParams.getIndex();return new zp("value",this,new qa(e.snapshotNode,new En(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Wp(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},Qp=class n{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Wp(this,e,t):null}createEvent(e,t){L(e.childName!=null,"Child events should have a childName.");let r=$i(new En(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new zp(e.type,this,new qa(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof n?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Zc(n,e,t,r,i){let o;if(typeof r=="object"&&(o=void 0,i=r),typeof r=="function"&&(o=r),i&&i.onlyOnce){let l=t,c=(d,h)=>{oI(n._repo,n,a),l(d,h)};c.userCallback=t.userCallback,c.context=t.context,t=c}let s=new Uc(t,o||void 0),a=e==="value"?new $c(s):new Qp(e,s);return jW(n._repo,n,a),()=>oI(n._repo,n,a)}function gg(n,e,t,r){return Zc(n,"value",e,t,r)}function KI(n,e,t,r){return Zc(n,"child_added",e,t,r)}function QI(n,e,t,r){return Zc(n,"child_changed",e,t,r)}function YI(n,e,t,r){return Zc(n,"child_moved",e,t,r)}function ZI(n,e,t,r){return Zc(n,"child_removed",e,t,r)}function JI(n,e,t){let r=null,i=t?new Uc(t):null;e==="value"?r=new $c(i):e&&(r=new Qp(e,i)),oI(n._repo,n,r)}var In=class{},Yp=class extends In{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){Er("endAt",this._value,e._path,!0);let t=FE(e._queryParams,this._value,this._key);if(fg(t),Hi(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Jt(e._repo,e._path,t,e._orderByCalled)}};function GP(n,e){return Qc("endAt","key",e,!0),new Yp(n,e)}var aI=class extends In{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){Er("endBefore",this._value,e._path,!1);let t=vz(e._queryParams,this._value,this._key);if(fg(t),Hi(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Jt(e._repo,e._path,t,e._orderByCalled)}};function zP(n,e){return Qc("endBefore","key",e,!0),new aI(n,e)}var Zp=class extends In{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){Er("startAt",this._value,e._path,!0);let t=OE(e._queryParams,this._value,this._key);if(fg(t),Hi(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Jt(e._repo,e._path,t,e._orderByCalled)}};function WP(n=null,e){return Qc("startAt","key",e,!0),new Zp(n,e)}var lI=class extends In{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){Er("startAfter",this._value,e._path,!1);let t=_z(e._queryParams,this._value,this._key);if(fg(t),Hi(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Jt(e._repo,e._path,t,e._orderByCalled)}};function KP(n,e){return Qc("startAfter","key",e,!0),new lI(n,e)}var uI=class extends In{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Jt(e._repo,e._path,mz(e._queryParams,this._limit),e._orderByCalled)}};function QP(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new uI(n)}var cI=class extends In{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Jt(e._repo,e._path,yz(e._queryParams,this._limit),e._orderByCalled)}};function YP(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new cI(n)}var dI=class extends In{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){hg(e,"orderByChild");let t=new Pe(this._path);if(_e(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new xc(t),i=Xp(e._queryParams,r);return Hi(i),new Jt(e._repo,e._path,i,!0)}};function ZP(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Ka("orderByChild","path",n,!1),new dI(n)}var hI=class extends In{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){hg(e,"orderByKey");let t=Xp(e._queryParams,_r);return Hi(t),new Jt(e._repo,e._path,t,!0)}};function JP(){return new hI}var fI=class extends In{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){hg(e,"orderByPriority");let t=Xp(e._queryParams,He);return Hi(t),new Jt(e._repo,e._path,t,!0)}};function XP(){return new fI}var pI=class extends In{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){hg(e,"orderByValue");let t=Xp(e._queryParams,SI);return Hi(t),new Jt(e._repo,e._path,t,!0)}};function ek(){return new pI}var gI=class extends In{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(Er("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Yp(this._value,this._key)._apply(new Zp(this._value,this._key)._apply(e))}};function tk(n,e){return Qc("equalTo","key",e,!0),new gI(n,e)}function Ln(n,...e){let t=we(n);for(let r of e)t=r._apply(t);return t}eW(En);oW(En);var KW="FIREBASE_DATABASE_EMULATOR_HOST",mI={},QW=!1;function YW(n,e,t,r){n.repoInfo_=new Sp(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function XI(n,e,t,r,i){let o=r||n.options.databaseURL;o===void 0&&(n.options.projectId||vr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),It("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let s=sI(o,i),a=s.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[KW]),c?(l=!0,o=`http://${c}?ns=${a.namespace}`,s=sI(o,i),a=s.repoInfo):l=!s.repoInfo.secure;let d=i&&l?new Tc(Tc.OWNER):new wE(n.name,n.options,e);RP("Invalid Firebase Database URL",s),_e(s.path)||vr("Database URL must point to the root of a Firebase Database (not including a child path).");let h=JW(a,n,d,new vE(n.name,t));return new yI(h,n)}function ZW(n,e){let t=mI[e];(!t||t[n.key]!==n)&&vr(`Database ${e}(${n.repoInfo_}) has already been deleted.`),OP(n),delete t[n.key]}function JW(n,e,t,r){let i=mI[e.name];i||(i={},mI[e.name]=i);let o=i[n.toURLString()];return o&&vr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new iI(n,QW,t,r),i[n.toURLString()]=o,o}var yI=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(xW(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new En(this._repo,Ne())),this._rootInternal}_delete(){return this._rootInternal!==null&&(ZW(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&vr("Cannot call "+e+" on a deleted database.")}};function nk(){eP.IS_TRANSPORT_INITIALIZED&&Lt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function rk(){nk(),Mc.forceDisallow()}function ik(){nk(),ka.forceDisallow(),Mc.forceAllow()}function ok(n,e,t,r={}){n=we(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&vr("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,o;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&vr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Tc(Tc.OWNER);else if(r.mockUserToken){let s=typeof r.mockUserToken=="string"?r.mockUserToken:sh(r.mockUserToken,n.app.options.projectId);o=new Tc(s)}YW(i,e,t,o)}function sk(n){n=we(n),n._checkNotDeleted("goOffline"),OP(n._repo)}function ak(n){n=we(n),n._checkNotDeleted("goOnline"),BW(n._repo)}function lk(n,e){FN(n,e)}function XW(n){wI(dh),go(new dn("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return XI(r,i,o,t)},"PUBLIC").setMultipleInstances(!0)),$n(tN,nN,n),$n(tN,nN,"esm2017")}var e3={".sv":"timestamp"};function uk(){return e3}function ck(n){return{".sv":{increment:n}}}var _I=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function dk(n,e,t){var r;if(n=we(n),vn("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";let i=(r=t?.applyLocally)!==null&&r!==void 0?r:!0,o=new Et,s=(l,c,d)=>{let h=null;l?o.reject(l):(h=new qa(d,new En(n._repo,n._path),He),o.resolve(new _I(c,h)))},a=gg(n,()=>{});return UW(n._repo,n._path,e,s,a,i),o.promise}TI.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};TI.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};XW();var t3="@firebase/database-compat",n3="2.0.2";var r3=new mi("@firebase/database-compat"),hk=function(n){let e="FIREBASE WARNING: "+n;r3.warn(e)};var i3=function(n,e,t,r){if(!(r&&t===void 0)&&typeof t!="boolean")throw new Error(tn(n,e)+"must be a boolean.")},o3=function(n,e,t){if(!(t&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(tn(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var eC=class{constructor(e){this._delegate=e}cancel(e){oe("OnDisconnect.cancel",0,1,arguments.length),gt("OnDisconnect.cancel","onComplete",e,!0);let t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){oe("OnDisconnect.remove",0,1,arguments.length),gt("OnDisconnect.remove","onComplete",e,!0);let t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){oe("OnDisconnect.set",1,2,arguments.length),gt("OnDisconnect.set","onComplete",t,!0);let r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){oe("OnDisconnect.setWithPriority",2,3,arguments.length),gt("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),o=>r(o)),i}update(e,t){if(oe("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let o=0;o<e.length;++o)i[""+o]=e[o];e=i,hk("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}gt("OnDisconnect.update","onComplete",t,!0);let r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}};var tC=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return oe("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var ns=class n{constructor(e,t){this._database=e,this._delegate=t}val(){return oe("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return oe("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return oe("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return oe("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return oe("DataSnapshot.child",0,1,arguments.length),e=String(e),Ka("DataSnapshot.child","path",e,!1),new n(this._database,this._delegate.child(e))}hasChild(e){return oe("DataSnapshot.hasChild",1,1,arguments.length),Ka("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return oe("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return oe("DataSnapshot.forEach",1,1,arguments.length),gt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new n(this._database,t)))}hasChildren(){return oe("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return oe("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return oe("DataSnapshot.ref",0,0,arguments.length),new Jr(this._database,this._delegate.ref)}get ref(){return this.getRef()}},mg=class n{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var o;oe("Query.on",2,4,arguments.length),gt("Query.on","callback",t,!1);let s=n.getCancelAndContextArgs_("Query.on",r,i),a=(c,d)=>{t.call(s.context,new ns(this.database,c),d)};a.userCallback=t,a.context=s.context;let l=(o=s.cancel)===null||o===void 0?void 0:o.bind(s.context);switch(e){case"value":return gg(this._delegate,a,l),t;case"child_added":return KI(this._delegate,a,l),t;case"child_removed":return ZI(this._delegate,a,l),t;case"child_changed":return QI(this._delegate,a,l),t;case"child_moved":return YI(this._delegate,a,l),t;default:throw new Error(tn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(oe("Query.off",0,3,arguments.length),o3("Query.off",e,!0),gt("Query.off","callback",t,!0),Ey("Query.off","context",r,!0),t){let i=()=>{};i.userCallback=t,i.context=r,JI(this._delegate,e,i)}else JI(this._delegate,e)}get(){return qP(this._delegate).then(e=>new ns(this.database,e))}once(e,t,r,i){oe("Query.once",1,4,arguments.length),gt("Query.once","callback",t,!0);let o=n.getCancelAndContextArgs_("Query.once",r,i),s=new Et,a=(c,d)=>{let h=new ns(this.database,c);t&&t.call(o.context,h,d),s.resolve(h)};a.userCallback=t,a.context=o.context;let l=c=>{o.cancel&&o.cancel.call(o.context,c),s.reject(c)};switch(e){case"value":gg(this._delegate,a,l,{onlyOnce:!0});break;case"child_added":KI(this._delegate,a,l,{onlyOnce:!0});break;case"child_removed":ZI(this._delegate,a,l,{onlyOnce:!0});break;case"child_changed":QI(this._delegate,a,l,{onlyOnce:!0});break;case"child_moved":YI(this._delegate,a,l,{onlyOnce:!0});break;default:throw new Error(tn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return s.promise}limitToFirst(e){return oe("Query.limitToFirst",1,1,arguments.length),new n(this.database,Ln(this._delegate,QP(e)))}limitToLast(e){return oe("Query.limitToLast",1,1,arguments.length),new n(this.database,Ln(this._delegate,YP(e)))}orderByChild(e){return oe("Query.orderByChild",1,1,arguments.length),new n(this.database,Ln(this._delegate,ZP(e)))}orderByKey(){return oe("Query.orderByKey",0,0,arguments.length),new n(this.database,Ln(this._delegate,JP()))}orderByPriority(){return oe("Query.orderByPriority",0,0,arguments.length),new n(this.database,Ln(this._delegate,XP()))}orderByValue(){return oe("Query.orderByValue",0,0,arguments.length),new n(this.database,Ln(this._delegate,ek()))}startAt(e=null,t){return oe("Query.startAt",0,2,arguments.length),new n(this.database,Ln(this._delegate,WP(e,t)))}startAfter(e=null,t){return oe("Query.startAfter",0,2,arguments.length),new n(this.database,Ln(this._delegate,KP(e,t)))}endAt(e=null,t){return oe("Query.endAt",0,2,arguments.length),new n(this.database,Ln(this._delegate,GP(e,t)))}endBefore(e=null,t){return oe("Query.endBefore",0,2,arguments.length),new n(this.database,Ln(this._delegate,zP(e,t)))}equalTo(e,t){return oe("Query.equalTo",1,2,arguments.length),new n(this.database,Ln(this._delegate,tk(e,t)))}toString(){return oe("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return oe("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(oe("Query.isEqual",1,1,arguments.length),!(e instanceof n)){let t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){let i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,gt(e,"cancel",i.cancel,!0),i.context=r,Ey(e,"context",i.context,!0);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(tn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new Jr(this.database,new En(this._delegate._repo,this._delegate._path))}},Jr=class n extends mg{constructor(e,t){super(e,new Jt(t._repo,t._path,new Oc,!1)),this.database=e,this._delegate=t}getKey(){return oe("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return oe("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new n(this.database,$i(this._delegate,e))}getParent(){oe("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new n(this.database,e):null}getRoot(){return oe("Reference.root",0,0,arguments.length),new n(this.database,this._delegate.root)}set(e,t){oe("Reference.set",1,2,arguments.length),gt("Reference.set","onComplete",t,!0);let r=pg(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if(oe("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let o=0;o<e.length;++o)i[""+o]=e[o];e=i,hk("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}vn("Reference.update",this._delegate._path),gt("Reference.update","onComplete",t,!0);let r=HP(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){oe("Reference.setWithPriority",2,3,arguments.length),gt("Reference.setWithPriority","onComplete",r,!0);let i=$P(this._delegate,e,t);return r&&i.then(()=>r(null),o=>r(o)),i}remove(e){oe("Reference.remove",0,1,arguments.length),gt("Reference.remove","onComplete",e,!0);let t=BP(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){oe("Reference.transaction",1,3,arguments.length),gt("Reference.transaction","transactionUpdate",e,!1),gt("Reference.transaction","onComplete",t,!0),i3("Reference.transaction","applyLocally",r,!0);let i=dk(this._delegate,e,{applyLocally:r}).then(o=>new tC(o.committed,new ns(this.database,o.snapshot)));return t&&i.then(o=>t(null,o.committed,o.snapshot),o=>t(o,!1,null)),i}setPriority(e,t){oe("Reference.setPriority",1,2,arguments.length),gt("Reference.setPriority","onComplete",t,!0);let r=UP(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){oe("Reference.push",0,2,arguments.length),gt("Reference.push","onComplete",t,!0);let r=jP(this._delegate,e),i=r.then(s=>new n(this.database,s));t&&i.then(()=>t(null),s=>t(s));let o=new n(this.database,r);return o.then=i.then.bind(i),o.catch=i.catch.bind(i,void 0),o}onDisconnect(){return vn("Reference.onDisconnect",this._delegate._path),new eC(new Kp(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var rs=class{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:rk,forceLongPolling:ik}}useEmulator(e,t,r={}){ok(this._delegate,e,t,r)}ref(e){if(oe("database.ref",0,1,arguments.length),e instanceof Jr){let t=WI(this._delegate,e.toString());return new Jr(this,t)}else{let t=zI(this._delegate,e);return new Jr(this,t)}}refFromURL(e){oe("database.refFromURL",1,1,arguments.length);let r=WI(this._delegate,e);return new Jr(this,r)}goOffline(){return oe("database.goOffline",0,0,arguments.length),sk(this._delegate)}goOnline(){return oe("database.goOnline",0,0,arguments.length),ak(this._delegate)}};rs.ServerValue={TIMESTAMP:uk(),increment:n=>ck(n)};function s3({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:o,nodeAdmin:s=!1}){wI(t);let a=new Iy("database-standalone"),l=new ch("auth-internal",a);l.setComponent(new dn("auth-internal",()=>r,"PRIVATE"));let c;return i&&(c=new ch("app-check-internal",a),c.setComponent(new dn("app-check-internal",()=>i,"PRIVATE"))),{instance:new rs(XI(n,l,c,e,s),n),namespace:o}}var a3=Object.freeze({__proto__:null,initStandalone:s3});var l3=rs.ServerValue;function u3(n){n.INTERNAL.registerComponent(new dn("database-compat",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new rs(i,r)},"PUBLIC").setServiceProps({Reference:Jr,Query:mg,Database:rs,DataSnapshot:ns,enableLogging:lk,INTERNAL:a3,ServerValue:l3}).setMultipleInstances(!0)),n.registerVersion(t3,n3)}u3(Tt);function Jc(n,e,t="on",r=wo){return new de(i=>{let o=null;return o=n[t](e,(s,a)=>{r.schedule(()=>{i.next({snapshot:s,prevKey:a})}),t==="once"&&r.schedule(()=>i.complete())},s=>{r.schedule(()=>i.error(s))}),t==="on"?{unsubscribe(){o!=null&&n.off(e,o)}}:{unsubscribe(){}}}).pipe(J(i=>{let{snapshot:o,prevKey:s}=i,a=null;return o.exists()&&(a=o.key),{type:e,payload:o,prevKey:s,key:a}}),pu())}function c3(n){return typeof n=="string"}function d3(n){return typeof n.exportVal=="function"}function yk(n){return n==null}function _k(n){return typeof n.set=="function"}function fk(n,e){return _k(e)?e:n.ref(e)}function vk(n,e){if(c3(n))return e.stringCase();if(_k(n))return e.firebaseCase();if(d3(n))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof n}`)}function wk(n){return(yk(n)||n.length===0)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function Ek(n,e,t){e=wk(e);let r=e.map(i=>Jc(n,i,"on",t));return Gs(...r)}function h3(n,e,t){let r=Ek(n,e).pipe(lr((i,o)=>[...i,o],[]));return p3(n,r,t)}function f3(n,e){return Jc(n,"value","on",e).pipe(J(t=>{let r;return t.payload.forEach(i=>(r=i.key,!1)),{data:t,lastKeyToLoad:r}}))}function p3(n,e,t){return f3(n,t).pipe(Yy(e),J(([i,o])=>{let s=i.lastKeyToLoad,a=o.map(l=>l.key);return{actions:o,lastKeyToLoad:s,loadedKeys:a}}),Ky(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),J(i=>i.actions))}function pk(n,e){return function(r,i){return vk(r,{stringCase:()=>n.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function g3(n){return function(t){return t?vk(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function m3(n,e,t){return Jc(n,"value","once",t).pipe(Ye(r=>{let i=[re(r)];return e.forEach(o=>i.push(Jc(n,o,"on",t))),Gs(...i).pipe(lr(_3,[]))}),du())}function Ik(n,e){let t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function y3(n,e){if(yk(e))return 0;{let t=Ik(n,e);return t===-1?n.length:t+1}}function _3(n,e){let{payload:t,prevKey:r,key:i}=e,o=Ik(n,i),s=y3(n,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(l=>{let c={payload:l,type:"value",prevKey:a,key:l.key};return a=l.key,n=[...n,c],!1})}return n;case"child_added":if(o>-1)(n[o-1]?.key||null)!==r&&(n=n.filter(l=>l.payload.key!==t.key),n.splice(s,0,e));else{if(r==null)return[e,...n];n=n.slice(),n.splice(s,0,e)}return n;case"child_removed":return n.filter(a=>a.payload.key!==t.key);case"child_changed":return n.map(a=>a.payload.key===i?e:a);case"child_moved":if(o>-1){let a=n.splice(o,1)[0];return n=n.slice(),n.splice(s,0,a),n}return n;default:return n}}function gk(n,e,t){return e=wk(e),m3(n,e,t)}function v3(n,e,t){let r=e.schedulers.outsideAngular,i=V(Se).run(()=>n.ref);return{query:n,update:pk(i,"update"),set:pk(i,"set"),push:o=>i.push(o),remove:g3(i),snapshotChanges(o){return gk(n,o,r).pipe(nt(t))},stateChanges(o){return Ek(n,o,r).pipe(nt(t))},auditTrail(o){return h3(n,o,r).pipe(nt(t))},valueChanges(o,s){return gk(n,o,r).pipe(J(l=>l.map(c=>s&&s.idField?pe($({},c.payload.val()),{[s.idField]:c.key}):c.payload.val())),nt(t))}}}function mk(n,e){return function(){return Jc(n,"value","on",e)}}function w3(n,e,t){return{query:n,snapshotChanges(){return mk(n,e.schedulers.outsideAngular)().pipe(nt(t))},update(r){return n.ref.update(r)},set(r){return n.ref.set(r)},remove(){return n.ref.remove()},valueChanges(){return mk(n,e.schedulers.outsideAngular)().pipe(nt(t),J(i=>i.payload.exists()?i.payload.val():null))}}}var E3=new Q("angularfire2.realtimeDatabaseURL"),I3=new Q("angularfire2.database.use-emulator"),yg=(()=>{class n{schedulers;database;injector=V(it);constructor(t,r,i,o,s,a,l,c,d,h,g,m,v,D,S){this.schedulers=a;let P=l,j=Ko(t,s,r);c&&_c(j,s,d,g,m,v,h,D),this.database=Na(`${j.name}.database.${i}`,"AngularFireDatabase",j.name,()=>{let O=s.runOutsideAngular(()=>j.database(i||void 0));return P&&O.useEmulator(...P),O},[P])}list(t,r){let i=V(Se).runOutsideAngular(()=>fk(this.database,t)),o=i;return r&&(o=r(i)),v3(o,this,this.injector)}object(t){let r=V(Se).runOutsideAngular(()=>fk(this.database,t));return w3(r,this,this.injector)}createPushId(){return V(Se).runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||n)(B(Pi),B(ki,8),B(E3,8),B(sn),B(Se),B(Wo),B(I3,8),B(vc,8),B(hc,8),B(fc,8),B(pc,8),B(gc,8),B(mc,8),B(yc,8),B(Ni,8))};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var Ck=(()=>{class n{constructor(t){this.db=t,this.dbPath="/PowerData",this.lastKey=null,this.database=t.list(this.dbPath),this.data=this.db.list(this.dbPath,r=>r.orderByChild("timestamp").limitToLast(1)).snapshotChanges().pipe(J(r=>r.map(i=>{let o=i.payload.val();return o&&typeof o=="object"?$({key:i.payload.key},o):null})[0]))}getFilteredMonitoringView(t,r,i){return new de(o=>{let s=this.convertToFirebaseDate(t);this.database.query.ref.orderByChild("current_date").equalTo(s).once("value",a=>{if(!a.exists()){o.next([]),o.complete();return}let l=Object.values(a.val()).filter(c=>this.isTimeInRange(c?.current_time,r,i));o.next(l),o.complete()},a=>o.error(a))})}getLatestMonitoringView(){return this.data}convertToFirebaseDate(t){let r=new Date(t);return`${r.getMonth()+1}/${r.getDate()}/${r.getFullYear()}`}isTimeInRange(t,r,i){if(!t)return!1;let[o,s]=t.split(":").map(Number),[a,l]=r.split(":").map(Number),[c,d]=i.split(":").map(Number),h=o*60+s,g=a*60+l,m=c*60+d;return h>=g&&h<=m}static{this.\u0275fac=function(r){return new(r||n)(B(yg))}}static{this.\u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function T3(n,e){if(n&1&&(G(0,"option",34),Z(1),z()),n&2){let t=e.$implicit;Nn("value",t),De(),Qt(" ",t," kWh ")}}function b3(n,e){n&1&&(G(0,"tbody")(1,"tr")(2,"td",35),Z(3," Loading data, please wait... "),G(4,"div",36)(5,"span",37),Z(6,"Loading..."),z()()()()())}function S3(n,e){if(n&1&&(G(0,"tr")(1,"td"),Z(2),z(),G(3,"td",8),Z(4),z(),G(5,"td"),Z(6),z(),G(7,"td",8),Z(8),z(),G(9,"td"),Z(10),z(),G(11,"td"),Z(12),z(),G(13,"td"),Z(14),z(),G(15,"td"),Z(16),z()()),n&2){let t=e.$implicit,r=$v(2);De(2),Gr(t.current_date+" "+t.current_time),De(),Nn("ngClass",r.getVoltageClass(t.voltage_V)),De(),Qt("",t.voltage_V," V"),De(2),Qt("",t.current_A," A"),De(),Nn("ngClass",r.getPowerFactorClass(t.power_factor)),De(),Gr(t.power_factor),De(2),Qt("",t.frequency_Hz," Hz"),De(2),Qt("",t.phase_angle_deg,"\xB0"),De(2),Qt("",t.active_power_W," W"),De(2),Qt("",t.energy_kWh," kWh")}}function A3(n,e){if(n&1&&(G(0,"tbody"),xu(1,S3,17,10,"tr",38),z()),n&2){let t=$v();De(),Nn("ngForOf",t.filteredMonitoringViewList)}}var Dk=(()=>{class n{constructor(t){this.monitoringService=t,this.filteredMonitoringViewList=[],this.monitoringViewList=[],this.monitoringView={active_power_W:0,apparent_power_VA:0,current_A:0,current_date:"",current_time:"",energy_kWh:0,frequency_Hz:0,phase_angle_deg:0,power_factor:0,voltage_V:0},this.loading=!1,this.inputCost=0,this.consumptionKwh=0,this.filterDate="",this.startTime="",this.endTime="",this.selectedEnergy=0,this.uniqueEnergyList=[]}ngOnInit(){this.getLatestMonitoringView()}preventInvalidInput(t){(t.key==="e"||t.key==="-"||t.key==="+")&&t.preventDefault()}getLatestMonitoringView(){this.monitoringService.getLatestMonitoringView().subscribe({next:t=>{this.monitoringView=t},error:t=>{},complete:()=>{}})}onFilter(){this.filterDate&&this.startTime&&this.endTime&&this.loadData()}loadData(){this.filterDate&&this.startTime&&this.endTime?(this.loading=!0,this.monitoringService.getFilteredMonitoringView(this.filterDate,this.startTime,this.endTime).subscribe({next:t=>{this.filteredMonitoringViewList=t,this.uniqueEnergyList=[...new Set(this.filteredMonitoringViewList.map(r=>r.energy_kWh))],this.loading=!1},error:()=>{this.loading=!1}})):this.filteredMonitoringViewList=[]}calculate(){this.inputCost>0&&(this.consumptionKwh=this.inputCost*this.selectedEnergy)}resetConsumption(){this.inputCost=0,this.consumptionKwh=0}convertDateTime(t){let r=t.substring(0,2),i=t.substring(2,4),o=t.substring(4,8),s=t.substring(8,10),a=t.substring(10,12);return`${r}/${i}/${o} ${s}:${a}`}getVoltageClass(t){return t===220?"green":t>=198&&t<220||t>220&&t<=242?"yellow":t<198||t>242?"red":""}getPowerFactorClass(t){return t>=.95&&t<=1?"green":t>=.85&&t<=.94?"yellow":t<.85?"red":""}updateEnergy(){this.monitoringView.energy_kWh=this.selectedEnergy}static{this.\u0275fac=function(r){return new(r||n)(Te(Ck))}}static{this.\u0275cmp=ga({type:n,selectors:[["app-monitoring-view"]],decls:164,vars:29,consts:[[1,"container","mt-4"],[1,"row","mb-4"],[1,"col-12"],[1,"text-center"],[1,"row"],[1,"col-12","col-md-6"],[1,"table","table-bordered"],["colspan","2",1,"text-center"],[3,"ngClass"],[1,"wider-dropdown",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"input-group"],["min","0","type","number","placeholder","Unit Value kWh","name","inputCost",1,"form-control",3,"ngModelChange","keydown","ngModel"],[1,"btn","btn-sm","btn-primary",3,"click"],["type","text","readonly","","disabled","",1,"form-control",3,"value"],[1,"d-flex","justify-content-between","align-items-center"],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"table","table-bordered","legend-table","mt-3"],[1,"green"],[1,"yellow"],[1,"red"],[1,"filters","mt-4"],[1,"filter-row"],[1,"filter-item"],["for","filterDate"],["type","date","id","filterDate",3,"ngModelChange","ngModel"],["for","startTime"],["type","time","id","startTime",3,"ngModelChange","ngModel"],["for","endTime"],["type","time","id","endTime",3,"ngModelChange","ngModel"],[1,"button","btn","btn-primary","mt-3",3,"click","disabled"],[1,"table-container","mt-3"],[1,"table","table-striped","table-bordered"],[4,"ngIf"],[3,"value"],["colspan","8",1,"text-center"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[4,"ngFor","ngForOf"]],template:function(r,i){r&1&&(G(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),Z(4,"REMOTE ELECTRICAL ANALYZER AND LOGGER"),z()()(),G(5,"div",4)(6,"div",5)(7,"table",6)(8,"thead")(9,"tr")(10,"th",7),Z(11,"Electrical Measurements"),z()()(),G(12,"tbody")(13,"tr")(14,"td"),Z(15,"Date"),z(),G(16,"td"),Z(17),z()(),G(18,"tr")(19,"td"),Z(20,"Time"),z(),G(21,"td"),Z(22),z()(),G(23,"tr")(24,"td"),Z(25,"Voltage"),z(),G(26,"td",8),Z(27),z()(),G(28,"tr")(29,"td"),Z(30,"Current"),z(),G(31,"td"),Z(32),z()(),G(33,"tr")(34,"td"),Z(35,"Frequency"),z(),G(36,"td"),Z(37),z()(),G(38,"tr")(39,"td"),Z(40,"Active Power"),z(),G(41,"td"),Z(42),z()(),G(43,"tr")(44,"td"),Z(45,"Power Factor"),z(),G(46,"td",8),Z(47),z()(),G(48,"tr")(49,"td"),Z(50,"Phase Angle"),z(),G(51,"td"),Z(52),z()()()()(),G(53,"div",5)(54,"table",6)(55,"thead")(56,"tr")(57,"th",7),Z(58,"Cost Calculation"),z()()(),G(59,"tbody")(60,"tr")(61,"td"),Z(62,"Energy Used"),z(),G(63,"td")(64,"select",9),Lo("ngModelChange",function(s){return ya(i.selectedEnergy,s)||(i.selectedEnergy=s),s}),an("change",function(){return i.updateEnergy()}),xu(65,T3,2,2,"option",10),z()()(),G(66,"tr")(67,"td"),Z(68,"Input Cost Per kWh"),z(),G(69,"td")(70,"div",11)(71,"input",12),Lo("ngModelChange",function(s){return ya(i.inputCost,s)||(i.inputCost=s),s}),an("keydown",function(s){return i.preventInvalidInput(s)}),z(),G(72,"button",13),an("click",function(){return i.calculate()}),Z(73,"Send"),z()()()(),G(74,"tr")(75,"td"),Z(76,"Cost Per kWh"),z(),G(77,"td"),Fo(78,"input",14),z()(),G(79,"tr")(80,"td"),Z(81,"Consumption in PHP"),z(),G(82,"td")(83,"div",15)(84,"span"),Z(85),qv(86,"number"),z(),G(87,"button",16),an("click",function(){return i.resetConsumption()}),Z(88,"Reset"),z()()()(),G(89,"tr")(90,"td"),Z(91,"Consumption in PHP"),z(),G(92,"td")(93,"div",15)(94,"span"),Z(95),qv(96,"number"),z(),G(97,"button",16),an("click",function(){return i.resetConsumption()}),Z(98,"Reset"),z()()()()()(),G(99,"table",17)(100,"thead")(101,"tr")(102,"th",7),Z(103,"Legend"),z()(),G(104,"tr")(105,"th"),Z(106,"Status"),z(),G(107,"th"),Z(108,"Color"),z()()(),G(109,"tbody")(110,"tr")(111,"td"),Z(112,"Ideal"),z(),G(113,"td",18),Z(114,"Green"),z()(),G(115,"tr")(116,"td"),Z(117,"Fair"),z(),G(118,"td",19),Z(119,"Yellow"),z()(),G(120,"tr")(121,"td"),Z(122,"Poor"),z(),G(123,"td",20),Z(124,"Red"),z()()()()()(),G(125,"div",21)(126,"div",22)(127,"div",23)(128,"label",24),Z(129,"Select Date:"),z(),G(130,"input",25),Lo("ngModelChange",function(s){return ya(i.filterDate,s)||(i.filterDate=s),s}),z()()(),G(131,"div",22)(132,"div",23)(133,"label",26),Z(134,"Start Time:"),z(),G(135,"input",27),Lo("ngModelChange",function(s){return ya(i.startTime,s)||(i.startTime=s),s}),z()(),G(136,"div",23)(137,"label",28),Z(138,"End Time:"),z(),G(139,"input",29),Lo("ngModelChange",function(s){return ya(i.endTime,s)||(i.endTime=s),s}),z()()(),G(140,"button",30),an("click",function(){return i.onFilter()}),Z(141," Apply Filter "),z()(),G(142,"div",31)(143,"table",32)(144,"thead")(145,"tr")(146,"th"),Z(147,"DateTime"),z(),G(148,"th"),Z(149,"Voltage (V)"),z(),G(150,"th"),Z(151,"Current (A)"),z(),G(152,"th"),Z(153,"Power Factor"),z(),G(154,"th"),Z(155,"Frequency (Hz)"),z(),G(156,"th"),Z(157,"Phase Angle (\xB0)"),z(),G(158,"th"),Z(159,"Active Power (W)"),z(),G(160,"th"),Z(161,"Energy (kWh)"),z()()(),xu(162,b3,7,0,"tbody",33)(163,A3,2,1,"tbody",33),z()()()),r&2&&(De(17),Gr(i.monitoringView.current_date),De(5),Gr(i.monitoringView.current_time),De(4),Nn("ngClass",i.getVoltageClass(i.monitoringView.voltage_V)),De(),Qt("",i.monitoringView.voltage_V," V"),De(5),Qt("",i.monitoringView.current_A," A"),De(5),Qt("",i.monitoringView.frequency_Hz," Hz"),De(5),Qt("",i.monitoringView.active_power_W," kW"),De(4),Nn("ngClass",i.getPowerFactorClass(i.monitoringView.power_factor)),De(),Gr(i.monitoringView.power_factor),De(5),Qt("",i.monitoringView.phase_angle_deg," \xB0"),De(12),Vo("ngModel",i.selectedEnergy),De(),Nn("ngForOf",i.uniqueEnergyList),De(6),Vo("ngModel",i.inputCost),De(7),Hv("value","1 kWh = \u20B1",i.inputCost,""),De(7),Gr(Gv(86,23,i.consumptionKwh,"1.2-2")),De(10),Gr(Gv(96,26,i.consumptionKwh,"1.2-2")),De(35),Vo("ngModel",i.filterDate),De(5),Vo("ngModel",i.startTime),De(4),Vo("ngModel",i.endTime),De(),Nn("disabled",!i.filterDate||!i.startTime||!i.endTime),De(22),Nn("ngIf",i.loading),De(),Nn("ngIf",!i.loading))},dependencies:[Ox,Nx,kx,vp,Zw,Ep,Ax,Jw,Yw,Vu,cR,dR,hR,fR],styles:[".filters[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;margin-top:50px}.filter-row[_ngcontent-%COMP%]{display:flex;gap:1rem;flex-wrap:wrap}.filter-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1}.filters[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:.25rem}.button-row[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:10px}button.small[_ngcontent-%COMP%]{font-size:.875rem;padding:.4rem 1rem}button[_ngcontent-%COMP%]{padding:.6rem 1.2rem;font-size:1rem}.table-container[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto;overflow-x:auto;margin-top:15px;width:100%;display:block}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;table-layout:auto}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{word-wrap:break-word;text-overflow:ellipsis;overflow:hidden}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #ddd}.green[_ngcontent-%COMP%]{color:#57a857}.yellow[_ngcontent-%COMP%]{color:gold}.red[_ngcontent-%COMP%]{color:red}@media (max-width: 768px){.col-md-6[_ngcontent-%COMP%]{width:100%}.filter-row[_ngcontent-%COMP%], .button-row[_ngcontent-%COMP%]{flex-direction:column}.wider-dropdown[_ngcontent-%COMP%]{width:100%}.table-container[_ngcontent-%COMP%]{max-height:350px}}@media (max-width: 576px){button[_ngcontent-%COMP%]{width:50%}.table-container[_ngcontent-%COMP%]{max-height:350px;overflow-x:auto;overflow-y:visible;width:100%}table[_ngcontent-%COMP%]{min-width:600px}}.legend-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .legend-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:center;vertical-align:middle;padding:4px}.legend-table[_ngcontent-%COMP%]   td.green[_ngcontent-%COMP%]{background-color:#57a857;color:#fff}.legend-table[_ngcontent-%COMP%]   td.yellow[_ngcontent-%COMP%]{background-color:gold;color:#000}.legend-table[_ngcontent-%COMP%]   td.red[_ngcontent-%COMP%]{background-color:red;color:#fff}.legend-table[_ngcontent-%COMP%]{text-align:center}"]})}}return n})();var Tk=[{path:"",component:Dk}];var bk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Sk={};var Xr,nC;(function(){var n;function e(I,_){function E(){}E.prototype=_.prototype,I.D=_.prototype,I.prototype=new E,I.prototype.constructor=I,I.C=function(C,T,A){for(var w=Array(arguments.length-2),xr=2;xr<arguments.length;xr++)w[xr-2]=arguments[xr];return _.prototype[T].apply(C,w)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,_,E){E||(E=0);var C=Array(16);if(typeof _=="string")for(var T=0;16>T;++T)C[T]=_.charCodeAt(E++)|_.charCodeAt(E++)<<8|_.charCodeAt(E++)<<16|_.charCodeAt(E++)<<24;else for(T=0;16>T;++T)C[T]=_[E++]|_[E++]<<8|_[E++]<<16|_[E++]<<24;_=I.g[0],E=I.g[1],T=I.g[2];var A=I.g[3],w=_+(A^E&(T^A))+C[0]+3614090360&4294967295;_=E+(w<<7&4294967295|w>>>25),w=A+(T^_&(E^T))+C[1]+3905402710&4294967295,A=_+(w<<12&4294967295|w>>>20),w=T+(E^A&(_^E))+C[2]+606105819&4294967295,T=A+(w<<17&4294967295|w>>>15),w=E+(_^T&(A^_))+C[3]+3250441966&4294967295,E=T+(w<<22&4294967295|w>>>10),w=_+(A^E&(T^A))+C[4]+4118548399&4294967295,_=E+(w<<7&4294967295|w>>>25),w=A+(T^_&(E^T))+C[5]+1200080426&4294967295,A=_+(w<<12&4294967295|w>>>20),w=T+(E^A&(_^E))+C[6]+2821735955&4294967295,T=A+(w<<17&4294967295|w>>>15),w=E+(_^T&(A^_))+C[7]+4249261313&4294967295,E=T+(w<<22&4294967295|w>>>10),w=_+(A^E&(T^A))+C[8]+1770035416&4294967295,_=E+(w<<7&4294967295|w>>>25),w=A+(T^_&(E^T))+C[9]+2336552879&4294967295,A=_+(w<<12&4294967295|w>>>20),w=T+(E^A&(_^E))+C[10]+4294925233&4294967295,T=A+(w<<17&4294967295|w>>>15),w=E+(_^T&(A^_))+C[11]+2304563134&4294967295,E=T+(w<<22&4294967295|w>>>10),w=_+(A^E&(T^A))+C[12]+1804603682&4294967295,_=E+(w<<7&4294967295|w>>>25),w=A+(T^_&(E^T))+C[13]+4254626195&4294967295,A=_+(w<<12&4294967295|w>>>20),w=T+(E^A&(_^E))+C[14]+2792965006&4294967295,T=A+(w<<17&4294967295|w>>>15),w=E+(_^T&(A^_))+C[15]+1236535329&4294967295,E=T+(w<<22&4294967295|w>>>10),w=_+(T^A&(E^T))+C[1]+4129170786&4294967295,_=E+(w<<5&4294967295|w>>>27),w=A+(E^T&(_^E))+C[6]+3225465664&4294967295,A=_+(w<<9&4294967295|w>>>23),w=T+(_^E&(A^_))+C[11]+643717713&4294967295,T=A+(w<<14&4294967295|w>>>18),w=E+(A^_&(T^A))+C[0]+3921069994&4294967295,E=T+(w<<20&4294967295|w>>>12),w=_+(T^A&(E^T))+C[5]+3593408605&4294967295,_=E+(w<<5&4294967295|w>>>27),w=A+(E^T&(_^E))+C[10]+38016083&4294967295,A=_+(w<<9&4294967295|w>>>23),w=T+(_^E&(A^_))+C[15]+3634488961&4294967295,T=A+(w<<14&4294967295|w>>>18),w=E+(A^_&(T^A))+C[4]+3889429448&4294967295,E=T+(w<<20&4294967295|w>>>12),w=_+(T^A&(E^T))+C[9]+568446438&4294967295,_=E+(w<<5&4294967295|w>>>27),w=A+(E^T&(_^E))+C[14]+3275163606&4294967295,A=_+(w<<9&4294967295|w>>>23),w=T+(_^E&(A^_))+C[3]+4107603335&4294967295,T=A+(w<<14&4294967295|w>>>18),w=E+(A^_&(T^A))+C[8]+1163531501&4294967295,E=T+(w<<20&4294967295|w>>>12),w=_+(T^A&(E^T))+C[13]+2850285829&4294967295,_=E+(w<<5&4294967295|w>>>27),w=A+(E^T&(_^E))+C[2]+4243563512&4294967295,A=_+(w<<9&4294967295|w>>>23),w=T+(_^E&(A^_))+C[7]+1735328473&4294967295,T=A+(w<<14&4294967295|w>>>18),w=E+(A^_&(T^A))+C[12]+2368359562&4294967295,E=T+(w<<20&4294967295|w>>>12),w=_+(E^T^A)+C[5]+4294588738&4294967295,_=E+(w<<4&4294967295|w>>>28),w=A+(_^E^T)+C[8]+2272392833&4294967295,A=_+(w<<11&4294967295|w>>>21),w=T+(A^_^E)+C[11]+1839030562&4294967295,T=A+(w<<16&4294967295|w>>>16),w=E+(T^A^_)+C[14]+4259657740&4294967295,E=T+(w<<23&4294967295|w>>>9),w=_+(E^T^A)+C[1]+2763975236&4294967295,_=E+(w<<4&4294967295|w>>>28),w=A+(_^E^T)+C[4]+1272893353&4294967295,A=_+(w<<11&4294967295|w>>>21),w=T+(A^_^E)+C[7]+4139469664&4294967295,T=A+(w<<16&4294967295|w>>>16),w=E+(T^A^_)+C[10]+3200236656&4294967295,E=T+(w<<23&4294967295|w>>>9),w=_+(E^T^A)+C[13]+681279174&4294967295,_=E+(w<<4&4294967295|w>>>28),w=A+(_^E^T)+C[0]+3936430074&4294967295,A=_+(w<<11&4294967295|w>>>21),w=T+(A^_^E)+C[3]+3572445317&4294967295,T=A+(w<<16&4294967295|w>>>16),w=E+(T^A^_)+C[6]+76029189&4294967295,E=T+(w<<23&4294967295|w>>>9),w=_+(E^T^A)+C[9]+3654602809&4294967295,_=E+(w<<4&4294967295|w>>>28),w=A+(_^E^T)+C[12]+3873151461&4294967295,A=_+(w<<11&4294967295|w>>>21),w=T+(A^_^E)+C[15]+530742520&4294967295,T=A+(w<<16&4294967295|w>>>16),w=E+(T^A^_)+C[2]+3299628645&4294967295,E=T+(w<<23&4294967295|w>>>9),w=_+(T^(E|~A))+C[0]+4096336452&4294967295,_=E+(w<<6&4294967295|w>>>26),w=A+(E^(_|~T))+C[7]+1126891415&4294967295,A=_+(w<<10&4294967295|w>>>22),w=T+(_^(A|~E))+C[14]+2878612391&4294967295,T=A+(w<<15&4294967295|w>>>17),w=E+(A^(T|~_))+C[5]+4237533241&4294967295,E=T+(w<<21&4294967295|w>>>11),w=_+(T^(E|~A))+C[12]+1700485571&4294967295,_=E+(w<<6&4294967295|w>>>26),w=A+(E^(_|~T))+C[3]+2399980690&4294967295,A=_+(w<<10&4294967295|w>>>22),w=T+(_^(A|~E))+C[10]+4293915773&4294967295,T=A+(w<<15&4294967295|w>>>17),w=E+(A^(T|~_))+C[1]+2240044497&4294967295,E=T+(w<<21&4294967295|w>>>11),w=_+(T^(E|~A))+C[8]+1873313359&4294967295,_=E+(w<<6&4294967295|w>>>26),w=A+(E^(_|~T))+C[15]+4264355552&4294967295,A=_+(w<<10&4294967295|w>>>22),w=T+(_^(A|~E))+C[6]+2734768916&4294967295,T=A+(w<<15&4294967295|w>>>17),w=E+(A^(T|~_))+C[13]+1309151649&4294967295,E=T+(w<<21&4294967295|w>>>11),w=_+(T^(E|~A))+C[4]+4149444226&4294967295,_=E+(w<<6&4294967295|w>>>26),w=A+(E^(_|~T))+C[11]+3174756917&4294967295,A=_+(w<<10&4294967295|w>>>22),w=T+(_^(A|~E))+C[2]+718787259&4294967295,T=A+(w<<15&4294967295|w>>>17),w=E+(A^(T|~_))+C[9]+3951481745&4294967295,I.g[0]=I.g[0]+_&4294967295,I.g[1]=I.g[1]+(T+(w<<21&4294967295|w>>>11))&4294967295,I.g[2]=I.g[2]+T&4294967295,I.g[3]=I.g[3]+A&4294967295}r.prototype.u=function(I,_){_===void 0&&(_=I.length);for(var E=_-this.blockSize,C=this.B,T=this.h,A=0;A<_;){if(T==0)for(;A<=E;)i(this,I,A),A+=this.blockSize;if(typeof I=="string"){for(;A<_;)if(C[T++]=I.charCodeAt(A++),T==this.blockSize){i(this,C),T=0;break}}else for(;A<_;)if(C[T++]=I[A++],T==this.blockSize){i(this,C),T=0;break}}this.h=T,this.o+=_},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var _=1;_<I.length-8;++_)I[_]=0;var E=8*this.o;for(_=I.length-8;_<I.length;++_)I[_]=E&255,E/=256;for(this.u(I),I=Array(16),_=E=0;4>_;++_)for(var C=0;32>C;C+=8)I[E++]=this.g[_]>>>C&255;return I};function o(I,_){var E=a;return Object.prototype.hasOwnProperty.call(E,I)?E[I]:E[I]=_(I)}function s(I,_){this.h=_;for(var E=[],C=!0,T=I.length-1;0<=T;T--){var A=I[T]|0;C&&A==_||(E[T]=A,C=!1)}this.g=E}var a={};function l(I){return-128<=I&&128>I?o(I,function(_){return new s([_|0],0>_?-1:0)}):new s([I|0],0>I?-1:0)}function c(I){if(isNaN(I)||!isFinite(I))return h;if(0>I)return S(c(-I));for(var _=[],E=1,C=0;I>=E;C++)_[C]=I/E|0,E*=4294967296;return new s(_,0)}function d(I,_){if(I.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(I.charAt(0)=="-")return S(d(I.substring(1),_));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=c(Math.pow(_,8)),C=h,T=0;T<I.length;T+=8){var A=Math.min(8,I.length-T),w=parseInt(I.substring(T,T+A),_);8>A?(A=c(Math.pow(_,A)),C=C.j(A).add(c(w))):(C=C.j(E),C=C.add(c(w)))}return C}var h=l(0),g=l(1),m=l(16777216);n=s.prototype,n.m=function(){if(D(this))return-S(this).m();for(var I=0,_=1,E=0;E<this.g.length;E++){var C=this.i(E);I+=(0<=C?C:4294967296+C)*_,_*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(v(this))return"0";if(D(this))return"-"+S(this).toString(I);for(var _=c(Math.pow(I,6)),E=this,C="";;){var T=K(E,_).g;E=P(E,T.j(_));var A=((0<E.g.length?E.g[0]:E.h)>>>0).toString(I);if(E=T,v(E))return A+C;for(;6>A.length;)A="0"+A;C=A+C}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function v(I){if(I.h!=0)return!1;for(var _=0;_<I.g.length;_++)if(I.g[_]!=0)return!1;return!0}function D(I){return I.h==-1}n.l=function(I){return I=P(this,I),D(I)?-1:v(I)?0:1};function S(I){for(var _=I.g.length,E=[],C=0;C<_;C++)E[C]=~I.g[C];return new s(E,~I.h).add(g)}n.abs=function(){return D(this)?S(this):this},n.add=function(I){for(var _=Math.max(this.g.length,I.g.length),E=[],C=0,T=0;T<=_;T++){var A=C+(this.i(T)&65535)+(I.i(T)&65535),w=(A>>>16)+(this.i(T)>>>16)+(I.i(T)>>>16);C=w>>>16,A&=65535,w&=65535,E[T]=w<<16|A}return new s(E,E[E.length-1]&-2147483648?-1:0)};function P(I,_){return I.add(S(_))}n.j=function(I){if(v(this)||v(I))return h;if(D(this))return D(I)?S(this).j(S(I)):S(S(this).j(I));if(D(I))return S(this.j(S(I)));if(0>this.l(m)&&0>I.l(m))return c(this.m()*I.m());for(var _=this.g.length+I.g.length,E=[],C=0;C<2*_;C++)E[C]=0;for(C=0;C<this.g.length;C++)for(var T=0;T<I.g.length;T++){var A=this.i(C)>>>16,w=this.i(C)&65535,xr=I.i(T)>>>16,Vl=I.i(T)&65535;E[2*C+2*T]+=w*Vl,j(E,2*C+2*T),E[2*C+2*T+1]+=A*Vl,j(E,2*C+2*T+1),E[2*C+2*T+1]+=w*xr,j(E,2*C+2*T+1),E[2*C+2*T+2]+=A*xr,j(E,2*C+2*T+2)}for(C=0;C<_;C++)E[C]=E[2*C+1]<<16|E[2*C];for(C=_;C<2*_;C++)E[C]=0;return new s(E,0)};function j(I,_){for(;(I[_]&65535)!=I[_];)I[_+1]+=I[_]>>>16,I[_]&=65535,_++}function O(I,_){this.g=I,this.h=_}function K(I,_){if(v(_))throw Error("division by zero");if(v(I))return new O(h,h);if(D(I))return _=K(S(I),_),new O(S(_.g),S(_.h));if(D(_))return _=K(I,S(_)),new O(S(_.g),_.h);if(30<I.g.length){if(D(I)||D(_))throw Error("slowDivide_ only works with positive integers.");for(var E=g,C=_;0>=C.l(I);)E=ie(E),C=ie(C);var T=ee(E,1),A=ee(C,1);for(C=ee(C,2),E=ee(E,2);!v(C);){var w=A.add(C);0>=w.l(I)&&(T=T.add(E),A=w),C=ee(C,1),E=ee(E,1)}return _=P(I,T.j(_)),new O(T,_)}for(T=h;0<=I.l(_);){for(E=Math.max(1,Math.floor(I.m()/_.m())),C=Math.ceil(Math.log(E)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),A=c(E),w=A.j(_);D(w)||0<w.l(I);)E-=C,A=c(E),w=A.j(_);v(A)&&(A=g),T=T.add(A),I=P(I,w)}return new O(T,I)}n.A=function(I){return K(this,I).h},n.and=function(I){for(var _=Math.max(this.g.length,I.g.length),E=[],C=0;C<_;C++)E[C]=this.i(C)&I.i(C);return new s(E,this.h&I.h)},n.or=function(I){for(var _=Math.max(this.g.length,I.g.length),E=[],C=0;C<_;C++)E[C]=this.i(C)|I.i(C);return new s(E,this.h|I.h)},n.xor=function(I){for(var _=Math.max(this.g.length,I.g.length),E=[],C=0;C<_;C++)E[C]=this.i(C)^I.i(C);return new s(E,this.h^I.h)};function ie(I){for(var _=I.g.length+1,E=[],C=0;C<_;C++)E[C]=I.i(C)<<1|I.i(C-1)>>>31;return new s(E,I.h)}function ee(I,_){var E=_>>5;_%=32;for(var C=I.g.length-E,T=[],A=0;A<C;A++)T[A]=0<_?I.i(A+E)>>>_|I.i(A+E+1)<<32-_:I.i(A+E);return new s(T,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,nC=Sk.Md5=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=c,s.fromString=d,Xr=Sk.Integer=s}).apply(typeof bk<"u"?bk:typeof self<"u"?self:typeof window<"u"?window:{});var _g=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ei={};var rC,M3,Ya,iC,Xc,vg,oC,sC,aC;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,f,p){return u==Array.prototype||u==Object.prototype||(u[f]=p.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof _g=="object"&&_g];for(var f=0;f<u.length;++f){var p=u[f];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function i(u,f){if(f)e:{var p=r;u=u.split(".");for(var y=0;y<u.length-1;y++){var b=u[y];if(!(b in p))break e;p=p[b]}u=u[u.length-1],y=p[u],f=f(y),f!=y&&f!=null&&e(p,u,{configurable:!0,writable:!0,value:f})}}function o(u,f){u instanceof String&&(u+="");var p=0,y=!1,b={next:function(){if(!y&&p<u.length){var R=p++;return{value:f(R,u[R]),done:!1}}return y=!0,{done:!0,value:void 0}}};return b[Symbol.iterator]=function(){return b},b}i("Array.prototype.values",function(u){return u||function(){return o(this,function(f,p){return p})}});var s=s||{},a=this||self;function l(u){var f=typeof u;return f=f!="object"?f:u?Array.isArray(u)?"array":f:"null",f=="array"||f=="object"&&typeof u.length=="number"}function c(u){var f=typeof u;return f=="object"&&u!=null||f=="function"}function d(u,f,p){return u.call.apply(u.bind,arguments)}function h(u,f,p){if(!u)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(b,y),u.apply(f,b)}}return function(){return u.apply(f,arguments)}}function g(u,f,p){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,g.apply(null,arguments)}function m(u,f){var p=Array.prototype.slice.call(arguments,1);return function(){var y=p.slice();return y.push.apply(y,arguments),u.apply(this,y)}}function v(u,f){function p(){}p.prototype=f.prototype,u.aa=f.prototype,u.prototype=new p,u.prototype.constructor=u,u.Qb=function(y,b,R){for(var U=Array(arguments.length-2),Le=2;Le<arguments.length;Le++)U[Le-2]=arguments[Le];return f.prototype[b].apply(y,U)}}function D(u){let f=u.length;if(0<f){let p=Array(f);for(let y=0;y<f;y++)p[y]=u[y];return p}return[]}function S(u,f){for(let p=1;p<arguments.length;p++){let y=arguments[p];if(l(y)){let b=u.length||0,R=y.length||0;u.length=b+R;for(let U=0;U<R;U++)u[b+U]=y[U]}else u.push(y)}}class P{constructor(f,p){this.i=f,this.j=p,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function j(u){return/^[\s\xa0]*$/.test(u)}function O(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function K(u){return K[" "](u),u}K[" "]=function(){};var ie=O().indexOf("Gecko")!=-1&&!(O().toLowerCase().indexOf("webkit")!=-1&&O().indexOf("Edge")==-1)&&!(O().indexOf("Trident")!=-1||O().indexOf("MSIE")!=-1)&&O().indexOf("Edge")==-1;function ee(u,f,p){for(let y in u)f.call(p,u[y],y,u)}function I(u,f){for(let p in u)f.call(void 0,u[p],p,u)}function _(u){let f={};for(let p in u)f[p]=u[p];return f}let E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(u,f){let p,y;for(let b=1;b<arguments.length;b++){y=arguments[b];for(p in y)u[p]=y[p];for(let R=0;R<E.length;R++)p=E[R],Object.prototype.hasOwnProperty.call(y,p)&&(u[p]=y[p])}}function T(u){var f=1;u=u.split(":");let p=[];for(;0<f&&u.length;)p.push(u.shift()),f--;return u.length&&p.push(u.join(":")),p}function A(u){a.setTimeout(()=>{throw u},0)}function w(){var u=zm;let f=null;return u.g&&(f=u.g,u.g=u.g.next,u.g||(u.h=null),f.next=null),f}class xr{constructor(){this.h=this.g=null}add(f,p){let y=Vl.get();y.set(f,p),this.h?this.h.next=y:this.g=y,this.h=y}}var Vl=new P(()=>new uV,u=>u.reset());class uV{constructor(){this.next=this.g=this.h=null}set(f,p){this.h=f,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let Ll,jl=!1,zm=new xr,lb=()=>{let u=a.Promise.resolve(void 0);Ll=()=>{u.then(cV)}};var cV=()=>{for(var u;u=w();){try{u.h.call(u.g)}catch(p){A(p)}var f=Vl;f.j(u),100>f.h&&(f.h++,u.next=f.g,f.g=u)}jl=!1};function di(){this.s=this.s,this.C=this.C}di.prototype.s=!1,di.prototype.ma=function(){this.s||(this.s=!0,this.N())},di.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Pt(u,f){this.type=u,this.g=this.target=f,this.defaultPrevented=!1}Pt.prototype.h=function(){this.defaultPrevented=!0};var dV=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,f=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let p=()=>{};a.addEventListener("test",p,f),a.removeEventListener("test",p,f)}catch{}return u}();function Bl(u,f){if(Pt.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var p=this.type=u.type,y=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=f,f=u.relatedTarget){if(ie){e:{try{K(f.nodeName);var b=!0;break e}catch{}b=!1}b||(f=null)}}else p=="mouseover"?f=u.fromElement:p=="mouseout"&&(f=u.toElement);this.relatedTarget=f,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:hV[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Bl.aa.h.call(this)}}v(Bl,Pt);var hV={2:"touch",3:"pen",4:"mouse"};Bl.prototype.h=function(){Bl.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Ul="closure_listenable_"+(1e6*Math.random()|0),fV=0;function pV(u,f,p,y,b){this.listener=u,this.proxy=null,this.src=f,this.type=p,this.capture=!!y,this.ha=b,this.key=++fV,this.da=this.fa=!1}function Ud(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function $d(u){this.src=u,this.g={},this.h=0}$d.prototype.add=function(u,f,p,y,b){var R=u.toString();u=this.g[R],u||(u=this.g[R]=[],this.h++);var U=Km(u,f,y,b);return-1<U?(f=u[U],p||(f.fa=!1)):(f=new pV(f,this.src,R,!!y,b),f.fa=p,u.push(f)),f};function Wm(u,f){var p=f.type;if(p in u.g){var y=u.g[p],b=Array.prototype.indexOf.call(y,f,void 0),R;(R=0<=b)&&Array.prototype.splice.call(y,b,1),R&&(Ud(f),u.g[p].length==0&&(delete u.g[p],u.h--))}}function Km(u,f,p,y){for(var b=0;b<u.length;++b){var R=u[b];if(!R.da&&R.listener==f&&R.capture==!!p&&R.ha==y)return b}return-1}var Qm="closure_lm_"+(1e6*Math.random()|0),Ym={};function ub(u,f,p,y,b){if(y&&y.once)return db(u,f,p,y,b);if(Array.isArray(f)){for(var R=0;R<f.length;R++)ub(u,f[R],p,y,b);return null}return p=ey(p),u&&u[Ul]?u.K(f,p,c(y)?!!y.capture:!!y,b):cb(u,f,p,!1,y,b)}function cb(u,f,p,y,b,R){if(!f)throw Error("Invalid event type");var U=c(b)?!!b.capture:!!b,Le=Jm(u);if(Le||(u[Qm]=Le=new $d(u)),p=Le.add(f,p,y,U,R),p.proxy)return p;if(y=gV(),p.proxy=y,y.src=u,y.listener=p,u.addEventListener)dV||(b=U),b===void 0&&(b=!1),u.addEventListener(f.toString(),y,b);else if(u.attachEvent)u.attachEvent(fb(f.toString()),y);else if(u.addListener&&u.removeListener)u.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return p}function gV(){function u(p){return f.call(u.src,u.listener,p)}let f=mV;return u}function db(u,f,p,y,b){if(Array.isArray(f)){for(var R=0;R<f.length;R++)db(u,f[R],p,y,b);return null}return p=ey(p),u&&u[Ul]?u.L(f,p,c(y)?!!y.capture:!!y,b):cb(u,f,p,!0,y,b)}function hb(u,f,p,y,b){if(Array.isArray(f))for(var R=0;R<f.length;R++)hb(u,f[R],p,y,b);else y=c(y)?!!y.capture:!!y,p=ey(p),u&&u[Ul]?(u=u.i,f=String(f).toString(),f in u.g&&(R=u.g[f],p=Km(R,p,y,b),-1<p&&(Ud(R[p]),Array.prototype.splice.call(R,p,1),R.length==0&&(delete u.g[f],u.h--)))):u&&(u=Jm(u))&&(f=u.g[f.toString()],u=-1,f&&(u=Km(f,p,y,b)),(p=-1<u?f[u]:null)&&Zm(p))}function Zm(u){if(typeof u!="number"&&u&&!u.da){var f=u.src;if(f&&f[Ul])Wm(f.i,u);else{var p=u.type,y=u.proxy;f.removeEventListener?f.removeEventListener(p,y,u.capture):f.detachEvent?f.detachEvent(fb(p),y):f.addListener&&f.removeListener&&f.removeListener(y),(p=Jm(f))?(Wm(p,u),p.h==0&&(p.src=null,f[Qm]=null)):Ud(u)}}}function fb(u){return u in Ym?Ym[u]:Ym[u]="on"+u}function mV(u,f){if(u.da)u=!0;else{f=new Bl(f,this);var p=u.listener,y=u.ha||u.src;u.fa&&Zm(u),u=p.call(y,f)}return u}function Jm(u){return u=u[Qm],u instanceof $d?u:null}var Xm="__closure_events_fn_"+(1e9*Math.random()>>>0);function ey(u){return typeof u=="function"?u:(u[Xm]||(u[Xm]=function(f){return u.handleEvent(f)}),u[Xm])}function kt(){di.call(this),this.i=new $d(this),this.M=this,this.F=null}v(kt,di),kt.prototype[Ul]=!0,kt.prototype.removeEventListener=function(u,f,p,y){hb(this,u,f,p,y)};function $t(u,f){var p,y=u.F;if(y)for(p=[];y;y=y.F)p.push(y);if(u=u.M,y=f.type||f,typeof f=="string")f=new Pt(f,u);else if(f instanceof Pt)f.target=f.target||u;else{var b=f;f=new Pt(y,u),C(f,b)}if(b=!0,p)for(var R=p.length-1;0<=R;R--){var U=f.g=p[R];b=Hd(U,y,!0,f)&&b}if(U=f.g=u,b=Hd(U,y,!0,f)&&b,b=Hd(U,y,!1,f)&&b,p)for(R=0;R<p.length;R++)U=f.g=p[R],b=Hd(U,y,!1,f)&&b}kt.prototype.N=function(){if(kt.aa.N.call(this),this.i){var u=this.i,f;for(f in u.g){for(var p=u.g[f],y=0;y<p.length;y++)Ud(p[y]);delete u.g[f],u.h--}}this.F=null},kt.prototype.K=function(u,f,p,y){return this.i.add(String(u),f,!1,p,y)},kt.prototype.L=function(u,f,p,y){return this.i.add(String(u),f,!0,p,y)};function Hd(u,f,p,y){if(f=u.i.g[String(f)],!f)return!0;f=f.concat();for(var b=!0,R=0;R<f.length;++R){var U=f[R];if(U&&!U.da&&U.capture==p){var Le=U.listener,Dt=U.ha||U.src;U.fa&&Wm(u.i,U),b=Le.call(Dt,y)!==!1&&b}}return b&&!y.defaultPrevented}function pb(u,f,p){if(typeof u=="function")p&&(u=g(u,p));else if(u&&typeof u.handleEvent=="function")u=g(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(u,f||0)}function gb(u){u.g=pb(()=>{u.g=null,u.i&&(u.i=!1,gb(u))},u.l);let f=u.h;u.h=null,u.m.apply(null,f)}class yV extends di{constructor(f,p){super(),this.m=f,this.l=p,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:gb(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $l(u){di.call(this),this.h=u,this.g={}}v($l,di);var mb=[];function yb(u){ee(u.g,function(f,p){this.g.hasOwnProperty(p)&&Zm(f)},u),u.g={}}$l.prototype.N=function(){$l.aa.N.call(this),yb(this)},$l.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ty=a.JSON.stringify,_V=a.JSON.parse,vV=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function ny(){}ny.prototype.h=null;function _b(u){return u.h||(u.h=u.i())}function vb(){}var Hl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ry(){Pt.call(this,"d")}v(ry,Pt);function iy(){Pt.call(this,"c")}v(iy,Pt);var co={},wb=null;function qd(){return wb=wb||new kt}co.La="serverreachability";function Eb(u){Pt.call(this,co.La,u)}v(Eb,Pt);function ql(u){let f=qd();$t(f,new Eb(f))}co.STAT_EVENT="statevent";function Ib(u,f){Pt.call(this,co.STAT_EVENT,u),this.stat=f}v(Ib,Pt);function Ht(u){let f=qd();$t(f,new Ib(f,u))}co.Ma="timingevent";function Cb(u,f){Pt.call(this,co.Ma,u),this.size=f}v(Cb,Pt);function Gl(u,f){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},f)}function zl(){this.g=!0}zl.prototype.xa=function(){this.g=!1};function wV(u,f,p,y,b,R){u.info(function(){if(u.g)if(R)for(var U="",Le=R.split("&"),Dt=0;Dt<Le.length;Dt++){var xe=Le[Dt].split("=");if(1<xe.length){var Ot=xe[0];xe=xe[1];var Ft=Ot.split("_");U=2<=Ft.length&&Ft[1]=="type"?U+(Ot+"="+xe+"&"):U+(Ot+"=redacted&")}}else U=null;else U=R;return"XMLHTTP REQ ("+y+") [attempt "+b+"]: "+f+`
`+p+`
`+U})}function EV(u,f,p,y,b,R,U){u.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+b+"]: "+f+`
`+p+`
`+R+" "+U})}function As(u,f,p,y){u.info(function(){return"XMLHTTP TEXT ("+f+"): "+CV(u,p)+(y?" "+y:"")})}function IV(u,f){u.info(function(){return"TIMEOUT: "+f})}zl.prototype.info=function(){};function CV(u,f){if(!u.g)return f;if(!f)return null;try{var p=JSON.parse(f);if(p){for(u=0;u<p.length;u++)if(Array.isArray(p[u])){var y=p[u];if(!(2>y.length)){var b=y[1];if(Array.isArray(b)&&!(1>b.length)){var R=b[0];if(R!="noop"&&R!="stop"&&R!="close")for(var U=1;U<b.length;U++)b[U]=""}}}}return ty(p)}catch{return f}}var Gd={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Db={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},oy;function zd(){}v(zd,ny),zd.prototype.g=function(){return new XMLHttpRequest},zd.prototype.i=function(){return{}},oy=new zd;function hi(u,f,p,y){this.j=u,this.i=f,this.l=p,this.R=y||1,this.U=new $l(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Tb}function Tb(){this.i=null,this.g="",this.h=!1}var bb={},sy={};function ay(u,f,p){u.L=1,u.v=Yd(Nr(f)),u.m=p,u.P=!0,Sb(u,null)}function Sb(u,f){u.F=Date.now(),Wd(u),u.A=Nr(u.v);var p=u.A,y=u.R;Array.isArray(y)||(y=[String(y)]),Ub(p.i,"t",y),u.C=0,p=u.j.J,u.h=new Tb,u.g=o0(u.j,p?f:null,!u.m),0<u.O&&(u.M=new yV(g(u.Y,u,u.g),u.O)),f=u.U,p=u.g,y=u.ca;var b="readystatechange";Array.isArray(b)||(b&&(mb[0]=b.toString()),b=mb);for(var R=0;R<b.length;R++){var U=ub(p,b[R],y||f.handleEvent,!1,f.h||f);if(!U)break;f.g[U.key]=U}f=u.H?_(u.H):{},u.m?(u.u||(u.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,f)):(u.u="GET",u.g.ea(u.A,u.u,null,f)),ql(),wV(u.i,u.u,u.A,u.l,u.R,u.m)}hi.prototype.ca=function(u){u=u.target;let f=this.M;f&&Pr(u)==3?f.j():this.Y(u)},hi.prototype.Y=function(u){try{if(u==this.g)e:{let Ft=Pr(this.g);var f=this.g.Ba();let xs=this.g.Z();if(!(3>Ft)&&(Ft!=3||this.g&&(this.h.h||this.g.oa()||Kb(this.g)))){this.J||Ft!=4||f==7||(f==8||0>=xs?ql(3):ql(2)),ly(this);var p=this.g.Z();this.X=p;t:if(Ab(this)){var y=Kb(this.g);u="";var b=y.length,R=Pr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ho(this),Wl(this);var U="";break t}this.h.i=new a.TextDecoder}for(f=0;f<b;f++)this.h.h=!0,u+=this.h.i.decode(y[f],{stream:!(R&&f==b-1)});y.length=0,this.h.g+=u,this.C=0,U=this.h.g}else U=this.g.oa();if(this.o=p==200,EV(this.i,this.u,this.A,this.l,this.R,Ft,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Le,Dt=this.g;if((Le=Dt.g?Dt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(Le)){var xe=Le;break t}}xe=null}if(p=xe)As(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,uy(this,p);else{this.o=!1,this.s=3,Ht(12),ho(this),Wl(this);break e}}if(this.P){p=!0;let Un;for(;!this.J&&this.C<U.length;)if(Un=DV(this,U),Un==sy){Ft==4&&(this.s=4,Ht(14),p=!1),As(this.i,this.l,null,"[Incomplete Response]");break}else if(Un==bb){this.s=4,Ht(15),As(this.i,this.l,U,"[Invalid Chunk]"),p=!1;break}else As(this.i,this.l,Un,null),uy(this,Un);if(Ab(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ft!=4||U.length!=0||this.h.h||(this.s=1,Ht(16),p=!1),this.o=this.o&&p,!p)As(this.i,this.l,U,"[Invalid Chunked Response]"),ho(this),Wl(this);else if(0<U.length&&!this.W){this.W=!0;var Ot=this.j;Ot.g==this&&Ot.ba&&!Ot.M&&(Ot.j.info("Great, no buffering proxy detected. Bytes received: "+U.length),gy(Ot),Ot.M=!0,Ht(11))}}else As(this.i,this.l,U,null),uy(this,U);Ft==4&&ho(this),this.o&&!this.J&&(Ft==4?t0(this.j,this):(this.o=!1,Wd(this)))}else UV(this.g),p==400&&0<U.indexOf("Unknown SID")?(this.s=3,Ht(12)):(this.s=0,Ht(13)),ho(this),Wl(this)}}}catch{}finally{}};function Ab(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function DV(u,f){var p=u.C,y=f.indexOf(`
`,p);return y==-1?sy:(p=Number(f.substring(p,y)),isNaN(p)?bb:(y+=1,y+p>f.length?sy:(f=f.slice(y,y+p),u.C=y+p,f)))}hi.prototype.cancel=function(){this.J=!0,ho(this)};function Wd(u){u.S=Date.now()+u.I,Mb(u,u.I)}function Mb(u,f){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Gl(g(u.ba,u),f)}function ly(u){u.B&&(a.clearTimeout(u.B),u.B=null)}hi.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(IV(this.i,this.A),this.L!=2&&(ql(),Ht(17)),ho(this),this.s=2,Wl(this)):Mb(this,this.S-u)};function Wl(u){u.j.G==0||u.J||t0(u.j,u)}function ho(u){ly(u);var f=u.M;f&&typeof f.ma=="function"&&f.ma(),u.M=null,yb(u.U),u.g&&(f=u.g,u.g=null,f.abort(),f.ma())}function uy(u,f){try{var p=u.j;if(p.G!=0&&(p.g==u||cy(p.h,u))){if(!u.K&&cy(p.h,u)&&p.G==3){try{var y=p.Da.g.parse(f)}catch{y=null}if(Array.isArray(y)&&y.length==3){var b=y;if(b[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<u.F)th(p),Xd(p);else break e;py(p),Ht(18)}}else p.za=b[1],0<p.za-p.T&&37500>b[2]&&p.F&&p.v==0&&!p.C&&(p.C=Gl(g(p.Za,p),6e3));if(1>=Nb(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else po(p,11)}else if((u.K||p.g==u)&&th(p),!j(f))for(b=p.Da.g.parse(f),f=0;f<b.length;f++){let xe=b[f];if(p.T=xe[0],xe=xe[1],p.G==2)if(xe[0]=="c"){p.K=xe[1],p.ia=xe[2];let Ot=xe[3];Ot!=null&&(p.la=Ot,p.j.info("VER="+p.la));let Ft=xe[4];Ft!=null&&(p.Aa=Ft,p.j.info("SVER="+p.Aa));let xs=xe[5];xs!=null&&typeof xs=="number"&&0<xs&&(y=1.5*xs,p.L=y,p.j.info("backChannelRequestTimeoutMs_="+y)),y=p;let Un=u.g;if(Un){let rh=Un.g?Un.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(rh){var R=y.h;R.g||rh.indexOf("spdy")==-1&&rh.indexOf("quic")==-1&&rh.indexOf("h2")==-1||(R.j=R.l,R.g=new Set,R.h&&(dy(R,R.h),R.h=null))}if(y.D){let my=Un.g?Un.g.getResponseHeader("X-HTTP-Session-Id"):null;my&&(y.ya=my,Ge(y.I,y.D,my))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-u.F,p.j.info("Handshake RTT: "+p.R+"ms")),y=p;var U=u;if(y.qa=i0(y,y.J?y.ia:null,y.W),U.K){Pb(y.h,U);var Le=U,Dt=y.L;Dt&&(Le.I=Dt),Le.B&&(ly(Le),Wd(Le)),y.g=U}else Xb(y);0<p.i.length&&eh(p)}else xe[0]!="stop"&&xe[0]!="close"||po(p,7);else p.G==3&&(xe[0]=="stop"||xe[0]=="close"?xe[0]=="stop"?po(p,7):fy(p):xe[0]!="noop"&&p.l&&p.l.ta(xe),p.v=0)}}ql(4)}catch{}}var TV=class{constructor(u,f){this.g=u,this.map=f}};function Rb(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function xb(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Nb(u){return u.h?1:u.g?u.g.size:0}function cy(u,f){return u.h?u.h==f:u.g?u.g.has(f):!1}function dy(u,f){u.g?u.g.add(f):u.h=f}function Pb(u,f){u.h&&u.h==f?u.h=null:u.g&&u.g.has(f)&&u.g.delete(f)}Rb.prototype.cancel=function(){if(this.i=kb(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function kb(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let f=u.i;for(let p of u.g.values())f=f.concat(p.D);return f}return D(u.i)}function bV(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var f=[],p=u.length,y=0;y<p;y++)f.push(u[y]);return f}f=[],p=0;for(y in u)f[p++]=u[y];return f}function SV(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var f=[];u=u.length;for(var p=0;p<u;p++)f.push(p);return f}f=[],p=0;for(let y in u)f[p++]=y;return f}}}function Ob(u,f){if(u.forEach&&typeof u.forEach=="function")u.forEach(f,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,f,void 0);else for(var p=SV(u),y=bV(u),b=y.length,R=0;R<b;R++)f.call(void 0,y[R],p&&p[R],u)}var Fb=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function AV(u,f){if(u){u=u.split("&");for(var p=0;p<u.length;p++){var y=u[p].indexOf("="),b=null;if(0<=y){var R=u[p].substring(0,y);b=u[p].substring(y+1)}else R=u[p];f(R,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function fo(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof fo){this.h=u.h,Kd(this,u.j),this.o=u.o,this.g=u.g,Qd(this,u.s),this.l=u.l;var f=u.i,p=new Yl;p.i=f.i,f.g&&(p.g=new Map(f.g),p.h=f.h),Vb(this,p),this.m=u.m}else u&&(f=String(u).match(Fb))?(this.h=!1,Kd(this,f[1]||"",!0),this.o=Kl(f[2]||""),this.g=Kl(f[3]||"",!0),Qd(this,f[4]),this.l=Kl(f[5]||"",!0),Vb(this,f[6]||"",!0),this.m=Kl(f[7]||"")):(this.h=!1,this.i=new Yl(null,this.h))}fo.prototype.toString=function(){var u=[],f=this.j;f&&u.push(Ql(f,Lb,!0),":");var p=this.g;return(p||f=="file")&&(u.push("//"),(f=this.o)&&u.push(Ql(f,Lb,!0),"@"),u.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&u.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&u.push("/"),u.push(Ql(p,p.charAt(0)=="/"?xV:RV,!0))),(p=this.i.toString())&&u.push("?",p),(p=this.m)&&u.push("#",Ql(p,PV)),u.join("")};function Nr(u){return new fo(u)}function Kd(u,f,p){u.j=p?Kl(f,!0):f,u.j&&(u.j=u.j.replace(/:$/,""))}function Qd(u,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);u.s=f}else u.s=null}function Vb(u,f,p){f instanceof Yl?(u.i=f,kV(u.i,u.h)):(p||(f=Ql(f,NV)),u.i=new Yl(f,u.h))}function Ge(u,f,p){u.i.set(f,p)}function Yd(u){return Ge(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Kl(u,f){return u?f?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Ql(u,f,p){return typeof u=="string"?(u=encodeURI(u).replace(f,MV),p&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function MV(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Lb=/[#\/\?@]/g,RV=/[#\?:]/g,xV=/[#\?]/g,NV=/[#\?@]/g,PV=/#/g;function Yl(u,f){this.h=this.g=null,this.i=u||null,this.j=!!f}function fi(u){u.g||(u.g=new Map,u.h=0,u.i&&AV(u.i,function(f,p){u.add(decodeURIComponent(f.replace(/\+/g," ")),p)}))}n=Yl.prototype,n.add=function(u,f){fi(this),this.i=null,u=Ms(this,u);var p=this.g.get(u);return p||this.g.set(u,p=[]),p.push(f),this.h+=1,this};function jb(u,f){fi(u),f=Ms(u,f),u.g.has(f)&&(u.i=null,u.h-=u.g.get(f).length,u.g.delete(f))}function Bb(u,f){return fi(u),f=Ms(u,f),u.g.has(f)}n.forEach=function(u,f){fi(this),this.g.forEach(function(p,y){p.forEach(function(b){u.call(f,b,y,this)},this)},this)},n.na=function(){fi(this);let u=Array.from(this.g.values()),f=Array.from(this.g.keys()),p=[];for(let y=0;y<f.length;y++){let b=u[y];for(let R=0;R<b.length;R++)p.push(f[y])}return p},n.V=function(u){fi(this);let f=[];if(typeof u=="string")Bb(this,u)&&(f=f.concat(this.g.get(Ms(this,u))));else{u=Array.from(this.g.values());for(let p=0;p<u.length;p++)f=f.concat(u[p])}return f},n.set=function(u,f){return fi(this),this.i=null,u=Ms(this,u),Bb(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[f]),this.h+=1,this},n.get=function(u,f){return u?(u=this.V(u),0<u.length?String(u[0]):f):f};function Ub(u,f,p){jb(u,f),0<p.length&&(u.i=null,u.g.set(Ms(u,f),D(p)),u.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],f=Array.from(this.g.keys());for(var p=0;p<f.length;p++){var y=f[p];let R=encodeURIComponent(String(y)),U=this.V(y);for(y=0;y<U.length;y++){var b=R;U[y]!==""&&(b+="="+encodeURIComponent(String(U[y]))),u.push(b)}}return this.i=u.join("&")};function Ms(u,f){return f=String(f),u.j&&(f=f.toLowerCase()),f}function kV(u,f){f&&!u.j&&(fi(u),u.i=null,u.g.forEach(function(p,y){var b=y.toLowerCase();y!=b&&(jb(this,y),Ub(this,b,p))},u)),u.j=f}function OV(u,f){let p=new zl;if(a.Image){let y=new Image;y.onload=m(pi,p,"TestLoadImage: loaded",!0,f,y),y.onerror=m(pi,p,"TestLoadImage: error",!1,f,y),y.onabort=m(pi,p,"TestLoadImage: abort",!1,f,y),y.ontimeout=m(pi,p,"TestLoadImage: timeout",!1,f,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=u}else f(!1)}function FV(u,f){let p=new zl,y=new AbortController,b=setTimeout(()=>{y.abort(),pi(p,"TestPingServer: timeout",!1,f)},1e4);fetch(u,{signal:y.signal}).then(R=>{clearTimeout(b),R.ok?pi(p,"TestPingServer: ok",!0,f):pi(p,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(b),pi(p,"TestPingServer: error",!1,f)})}function pi(u,f,p,y,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),y(p)}catch{}}function VV(){this.g=new vV}function LV(u,f,p){let y=p||"";try{Ob(u,function(b,R){let U=b;c(b)&&(U=ty(b)),f.push(y+R+"="+encodeURIComponent(U))})}catch(b){throw f.push(y+"type="+encodeURIComponent("_badmap")),b}}function Zl(u){this.l=u.Ub||null,this.j=u.eb||!1}v(Zl,ny),Zl.prototype.g=function(){return new Zd(this.l,this.j)},Zl.prototype.i=function(u){return function(){return u}}({});function Zd(u,f){kt.call(this),this.D=u,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(Zd,kt),n=Zd.prototype,n.open=function(u,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=f,this.readyState=1,Xl(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(f.body=u),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Jl(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Xl(this)),this.g&&(this.readyState=3,Xl(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;$b(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function $b(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var f=u.value?u.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!u.done}))&&(this.response=this.responseText+=f)}u.done?Jl(this):Xl(this),this.readyState==3&&$b(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Jl(this))},n.Qa=function(u){this.g&&(this.response=u,Jl(this))},n.ga=function(){this.g&&Jl(this)};function Jl(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Xl(u)}n.setRequestHeader=function(u,f){this.u.append(u,f)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],f=this.h.entries();for(var p=f.next();!p.done;)p=p.value,u.push(p[0]+": "+p[1]),p=f.next();return u.join(`\r
`)};function Xl(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Zd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Hb(u){let f="";return ee(u,function(p,y){f+=y,f+=":",f+=p,f+=`\r
`}),f}function hy(u,f,p){e:{for(y in p){var y=!1;break e}y=!0}y||(p=Hb(p),typeof u=="string"?p!=null&&encodeURIComponent(String(p)):Ge(u,f,p))}function et(u){kt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(et,kt);var jV=/^https?$/i,BV=["POST","PUT"];n=et.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,f,p,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);f=f?f.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():oy.g(),this.v=this.o?_b(this.o):_b(oy),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(f,String(u),!0),this.B=!1}catch(R){qb(this,R);return}if(u=p||"",p=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var b in y)p.set(b,y[b]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(let R of y.keys())p.set(R,y.get(R));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(p.keys()).find(R=>R.toLowerCase()=="content-type"),b=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(BV,f,void 0))||y||b||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[R,U]of p)this.g.setRequestHeader(R,U);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Wb(this),this.u=!0,this.g.send(u),this.u=!1}catch(R){qb(this,R)}};function qb(u,f){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=f,u.m=5,Gb(u),Jd(u)}function Gb(u){u.A||(u.A=!0,$t(u,"complete"),$t(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,$t(this,"complete"),$t(this,"abort"),Jd(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Jd(this,!0)),et.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?zb(this):this.bb())},n.bb=function(){zb(this)};function zb(u){if(u.h&&typeof s<"u"&&(!u.v[1]||Pr(u)!=4||u.Z()!=2)){if(u.u&&Pr(u)==4)pb(u.Ea,0,u);else if($t(u,"readystatechange"),Pr(u)==4){u.h=!1;try{let U=u.Z();e:switch(U){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var p;if(!(p=f)){var y;if(y=U===0){var b=String(u.D).match(Fb)[1]||null;!b&&a.self&&a.self.location&&(b=a.self.location.protocol.slice(0,-1)),y=!jV.test(b?b.toLowerCase():"")}p=y}if(p)$t(u,"complete"),$t(u,"success");else{u.m=6;try{var R=2<Pr(u)?u.g.statusText:""}catch{R=""}u.l=R+" ["+u.Z()+"]",Gb(u)}}finally{Jd(u)}}}}function Jd(u,f){if(u.g){Wb(u);let p=u.g,y=u.v[0]?()=>{}:null;u.g=null,u.v=null,f||$t(u,"ready");try{p.onreadystatechange=y}catch{}}}function Wb(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Pr(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Pr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var f=this.g.responseText;return u&&f.indexOf(u)==0&&(f=f.substring(u.length)),_V(f)}};function Kb(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function UV(u){let f={};u=(u.g&&2<=Pr(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<u.length;y++){if(j(u[y]))continue;var p=T(u[y]);let b=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();let R=f[b]||[];f[b]=R,R.push(p)}I(f,function(y){return y.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function eu(u,f,p){return p&&p.internalChannelParams&&p.internalChannelParams[u]||f}function Qb(u){this.Aa=0,this.i=[],this.j=new zl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=eu("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=eu("baseRetryDelayMs",5e3,u),this.cb=eu("retryDelaySeedMs",1e4,u),this.Wa=eu("forwardChannelMaxRetries",2,u),this.wa=eu("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Rb(u&&u.concurrentRequestLimit),this.Da=new VV,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Qb.prototype,n.la=8,n.G=1,n.connect=function(u,f,p,y){Ht(0),this.W=u,this.H=f||{},p&&y!==void 0&&(this.H.OSID=p,this.H.OAID=y),this.F=this.X,this.I=i0(this,null,this.W),eh(this)};function fy(u){if(Yb(u),u.G==3){var f=u.U++,p=Nr(u.I);if(Ge(p,"SID",u.K),Ge(p,"RID",f),Ge(p,"TYPE","terminate"),tu(u,p),f=new hi(u,u.j,f),f.L=2,f.v=Yd(Nr(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=f.v,p=!0),p||(f.g=o0(f.j,null),f.g.ea(f.v)),f.F=Date.now(),Wd(f)}r0(u)}function Xd(u){u.g&&(gy(u),u.g.cancel(),u.g=null)}function Yb(u){Xd(u),u.u&&(a.clearTimeout(u.u),u.u=null),th(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function eh(u){if(!xb(u.h)&&!u.s){u.s=!0;var f=u.Ga;Ll||lb(),jl||(Ll(),jl=!0),zm.add(f,u),u.B=0}}function $V(u,f){return Nb(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=f.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Gl(g(u.Ga,u,f),n0(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let b=new hi(this,this.j,u),R=this.o;if(this.S&&(R?(R=_(R),C(R,this.S)):R=this.S),this.m!==null||this.O||(b.H=R,R=null),this.P)e:{for(var f=0,p=0;p<this.i.length;p++){t:{var y=this.i[p];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(f+=y,4096<f){f=p;break e}if(f===4096||p===this.i.length-1){f=p+1;break e}}f=1e3}else f=1e3;f=Jb(this,b,f),p=Nr(this.I),Ge(p,"RID",u),Ge(p,"CVER",22),this.D&&Ge(p,"X-HTTP-Session-Id",this.D),tu(this,p),R&&(this.O?f="headers="+encodeURIComponent(String(Hb(R)))+"&"+f:this.m&&hy(p,this.m,R)),dy(this.h,b),this.Ua&&Ge(p,"TYPE","init"),this.P?(Ge(p,"$req",f),Ge(p,"SID","null"),b.T=!0,ay(b,p,null)):ay(b,p,f),this.G=2}}else this.G==3&&(u?Zb(this,u):this.i.length==0||xb(this.h)||Zb(this))};function Zb(u,f){var p;f?p=f.l:p=u.U++;let y=Nr(u.I);Ge(y,"SID",u.K),Ge(y,"RID",p),Ge(y,"AID",u.T),tu(u,y),u.m&&u.o&&hy(y,u.m,u.o),p=new hi(u,u.j,p,u.B+1),u.m===null&&(p.H=u.o),f&&(u.i=f.D.concat(u.i)),f=Jb(u,p,1e3),p.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),dy(u.h,p),ay(p,y,f)}function tu(u,f){u.H&&ee(u.H,function(p,y){Ge(f,y,p)}),u.l&&Ob({},function(p,y){Ge(f,y,p)})}function Jb(u,f,p){p=Math.min(u.i.length,p);var y=u.l?g(u.l.Na,u.l,u):null;e:{var b=u.i;let R=-1;for(;;){let U=["count="+p];R==-1?0<p?(R=b[0].g,U.push("ofs="+R)):R=0:U.push("ofs="+R);let Le=!0;for(let Dt=0;Dt<p;Dt++){let xe=b[Dt].g,Ot=b[Dt].map;if(xe-=R,0>xe)R=Math.max(0,b[Dt].g-100),Le=!1;else try{LV(Ot,U,"req"+xe+"_")}catch{y&&y(Ot)}}if(Le){y=U.join("&");break e}}}return u=u.i.splice(0,p),f.D=u,y}function Xb(u){if(!u.g&&!u.u){u.Y=1;var f=u.Fa;Ll||lb(),jl||(Ll(),jl=!0),zm.add(f,u),u.v=0}}function py(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Gl(g(u.Fa,u),n0(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,e0(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Gl(g(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ht(10),Xd(this),e0(this))};function gy(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function e0(u){u.g=new hi(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var f=Nr(u.qa);Ge(f,"RID","rpc"),Ge(f,"SID",u.K),Ge(f,"AID",u.T),Ge(f,"CI",u.F?"0":"1"),!u.F&&u.ja&&Ge(f,"TO",u.ja),Ge(f,"TYPE","xmlhttp"),tu(u,f),u.m&&u.o&&hy(f,u.m,u.o),u.L&&(u.g.I=u.L);var p=u.g;u=u.ia,p.L=1,p.v=Yd(Nr(f)),p.m=null,p.P=!0,Sb(p,u)}n.Za=function(){this.C!=null&&(this.C=null,Xd(this),py(this),Ht(19))};function th(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function t0(u,f){var p=null;if(u.g==f){th(u),gy(u),u.g=null;var y=2}else if(cy(u.h,f))p=f.D,Pb(u.h,f),y=1;else return;if(u.G!=0){if(f.o)if(y==1){p=f.m?f.m.length:0,f=Date.now()-f.F;var b=u.B;y=qd(),$t(y,new Cb(y,p)),eh(u)}else Xb(u);else if(b=f.s,b==3||b==0&&0<f.X||!(y==1&&$V(u,f)||y==2&&py(u)))switch(p&&0<p.length&&(f=u.h,f.i=f.i.concat(p)),b){case 1:po(u,5);break;case 4:po(u,10);break;case 3:po(u,6);break;default:po(u,2)}}}function n0(u,f){let p=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(p*=2),p*f}function po(u,f){if(u.j.info("Error code "+f),f==2){var p=g(u.fb,u),y=u.Xa;let b=!y;y=new fo(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Kd(y,"https"),Yd(y),b?OV(y.toString(),p):FV(y.toString(),p)}else Ht(2);u.G=0,u.l&&u.l.sa(f),r0(u),Yb(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Ht(2)):(this.j.info("Failed to ping google.com"),Ht(1))};function r0(u){if(u.G=0,u.ka=[],u.l){let f=kb(u.h);(f.length!=0||u.i.length!=0)&&(S(u.ka,f),S(u.ka,u.i),u.h.i.length=0,D(u.i),u.i.length=0),u.l.ra()}}function i0(u,f,p){var y=p instanceof fo?Nr(p):new fo(p);if(y.g!="")f&&(y.g=f+"."+y.g),Qd(y,y.s);else{var b=a.location;y=b.protocol,f=f?f+"."+b.hostname:b.hostname,b=+b.port;var R=new fo(null);y&&Kd(R,y),f&&(R.g=f),b&&Qd(R,b),p&&(R.l=p),y=R}return p=u.D,f=u.ya,p&&f&&Ge(y,p,f),Ge(y,"VER",u.la),tu(u,y),y}function o0(u,f,p){if(f&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=u.Ca&&!u.pa?new et(new Zl({eb:p})):new et(u.pa),f.Ha(u.J),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function s0(){}n=s0.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function nh(){}nh.prototype.g=function(u,f){return new cn(u,f)};function cn(u,f){kt.call(this),this.g=new Qb(f),this.l=u,this.h=f&&f.messageUrlParams||null,u=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(u?u["X-WebChannel-Content-Type"]=f.messageContentType:u={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(u?u["X-WebChannel-Client-Profile"]=f.va:u={"X-WebChannel-Client-Profile":f.va}),this.g.S=u,(u=f&&f.Sb)&&!j(u)&&(this.g.m=u),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!j(f)&&(this.g.D=f,u=this.h,u!==null&&f in u&&(u=this.h,f in u&&delete u[f])),this.j=new Rs(this)}v(cn,kt),cn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},cn.prototype.close=function(){fy(this.g)},cn.prototype.o=function(u){var f=this.g;if(typeof u=="string"){var p={};p.__data__=u,u=p}else this.u&&(p={},p.__data__=ty(u),u=p);f.i.push(new TV(f.Ya++,u)),f.G==3&&eh(f)},cn.prototype.N=function(){this.g.l=null,delete this.j,fy(this.g),delete this.g,cn.aa.N.call(this)};function a0(u){ry.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var f=u.__sm__;if(f){e:{for(let p in f){u=p;break e}u=void 0}(this.i=u)&&(u=this.i,f=f!==null&&u in f?f[u]:void 0),this.data=f}else this.data=u}v(a0,ry);function l0(){iy.call(this),this.status=1}v(l0,iy);function Rs(u){this.g=u}v(Rs,s0),Rs.prototype.ua=function(){$t(this.g,"a")},Rs.prototype.ta=function(u){$t(this.g,new a0(u))},Rs.prototype.sa=function(u){$t(this.g,new l0)},Rs.prototype.ra=function(){$t(this.g,"b")},nh.prototype.createWebChannel=nh.prototype.g,cn.prototype.send=cn.prototype.o,cn.prototype.open=cn.prototype.m,cn.prototype.close=cn.prototype.close,aC=ei.createWebChannelTransport=function(){return new nh},sC=ei.getStatEventTarget=function(){return qd()},oC=ei.Event=co,vg=ei.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Gd.NO_ERROR=0,Gd.TIMEOUT=8,Gd.HTTP_ERROR=6,Xc=ei.ErrorCode=Gd,Db.COMPLETE="complete",iC=ei.EventType=Db,vb.EventType=Hl,Hl.OPEN="a",Hl.CLOSE="b",Hl.ERROR="c",Hl.MESSAGE="d",kt.prototype.listen=kt.prototype.K,Ya=ei.WebChannel=vb,M3=ei.FetchXmlHttpFactory=Zl,et.prototype.listenOnce=et.prototype.L,et.prototype.getLastError=et.prototype.Ka,et.prototype.getLastErrorCode=et.prototype.Ba,et.prototype.getStatus=et.prototype.Z,et.prototype.getResponseJson=et.prototype.Oa,et.prototype.getResponseText=et.prototype.oa,et.prototype.send=et.prototype.ea,et.prototype.setWithCredentials=et.prototype.Ha,rC=ei.XhrIo=et}).apply(typeof _g<"u"?_g:typeof self<"u"?self:typeof window<"u"?window:{});var Ak="@firebase/firestore";var ft=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ft.UNAUTHENTICATED=new ft(null),ft.GOOGLE_CREDENTIALS=new ft("google-credentials-uid"),ft.FIRST_PARTY=new ft("first-party-uid"),ft.MOCK_USER=new ft("mock-user");var Sl="11.2.0";var Yi=new mi("@firebase/firestore");function tl(){return Yi.logLevel}function RO(n){Yi.setLogLevel(n)}function F(n,...e){if(Yi.logLevel<=bn.DEBUG){let t=e.map(dT);Yi.debug(`Firestore (${Sl}): ${n}`,...t)}}function ot(n,...e){if(Yi.logLevel<=bn.ERROR){let t=e.map(dT);Yi.error(`Firestore (${Sl}): ${n}`,...t)}}function Xn(n,...e){if(Yi.logLevel<=bn.WARN){let t=e.map(dT);Yi.warn(`Firestore (${Sl}): ${n}`,...t)}}function dT(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function W(n="Unexpected state"){let e=`FIRESTORE (${Sl}) INTERNAL ASSERTION FAILED: `+n;throw ot(e),new Error(e)}function Y(n,e){n||W()}function xO(n,e){n||W()}function H(n,e){return n}var N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},k=class extends g0{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var vt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var xg=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},fC=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ft.UNAUTHENTICATED))}shutdown(){}},pC=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},gC=class{constructor(e){this.t=e,this.currentUser=ft.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Y(this.o===void 0);let r=this.i,i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve(),o=new vt;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new vt,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let l=o;e.enqueueRetryable(()=>x(this,null,function*(){yield l.promise,yield i(this.currentUser)}))},a=l=>{F("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?a(l):(F("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new vt)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(F("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Y(typeof r.accessToken=="string"),new xg(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return Y(e===null||typeof e=="string"),new ft(e)}},mC=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=ft.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);let e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}},yC=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new mC(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(ft.FIRST_PARTY))}shutdown(){}invalidateToken(){}},_C=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},vC=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Y(this.o===void 0);let r=o=>{o.error!=null&&F("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.R;return this.R=o.token,F("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{F("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):F("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Y(typeof t.token=="string"),this.R=t.token,new _C(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function R3(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Ng=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=R3(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function le(n,e){return n<e?-1:n>e?1:0}function cl(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function NO(n){return n+"\0"}var Je=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new k(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new k(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new k(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new k(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?le(this.nanoseconds,e.nanoseconds):le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var X=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Je(0,0))}static max(){return new n(new Je(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Pg=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&W(),r===void 0?r=e.length-t:r>e.length-t&&W(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=n.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return Math.sign(e.length-t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):e<t?-1:e>t?1:0}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Xr.fromString(e.substring(4,e.length-2))}},Me=class n extends Pg{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new k(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},x3=/^[_a-zA-Z][_a-zA-Z0-9]*$/,st=class n extends Pg{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return x3.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new k(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new k(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new k(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new k(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var q=class n{constructor(e){this.path=e}static fromPath(e){return new n(Me.fromString(e))}static fromName(e){return new n(Me.fromString(e).popFirst(5))}static empty(){return new n(Me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Me.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Me.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Me(e.slice()))}};var dl=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function wC(n){return n.fields.find(e=>e.kind===2)}function os(n){return n.fields.filter(e=>e.kind!==2)}dl.UNKNOWN_ID=-1;var al=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var dd=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,jn.min())}};function PO(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=X.fromTimestamp(r===1e9?new Je(t+1,0):new Je(t,r));return new jn(i,q.empty(),e)}function kO(n){return new jn(n.readTime,n.key,-1)}var jn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(X.min(),q.empty(),-1)}static max(){return new n(X.max(),q.empty(),-1)}};function hT(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=q.comparator(n.documentKey,e.documentKey),t!==0?t:le(n.largestBatchId,e.largestBatchId))}var OO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",kg=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function so(n){return x(this,null,function*(){if(n.code!==N.FAILED_PRECONDITION||n.message!==OO)throw n;F("LocalStore","Unexpectedly lost primary lease")})}var M=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&W(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},l=>r(l))}),s=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,s=new Array(o),a=0;for(let l=0;l<o;l++){let c=l;t(e[c]).next(d=>{s[c]=d,++a,a===o&&r(s)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};var Og=class n{static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(o){throw new ds(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new vt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new ds(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=fT(r.target.error);this.V.reject(new ds(e,i))}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(F("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new IC(t)}},Zi=class n{static delete(e){return F("SimpleDb","Removing database:",e),ss(window.indexedDB.deleteDatabase(e)).toPromise()}static p(){if(!ah())return!1;if(n.S())return!0;let e=nu(),t=n.D(e),r=0<t&&t<10,i=FO(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static S(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static C(e,t){return e.store(t)}static D(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.F=r,n.D(nu())===12.2&&ot("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}M(e){return x(this,null,function*(){return this.db||(F("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{let s=o.target.result;t(s)},i.onblocked=()=>{r(new ds(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{let s=o.target.error;s.name==="VersionError"?r(new k(N.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s.name==="InvalidStateError"?r(new k(N.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+s)):r(new ds(e,s))},i.onupgradeneeded=o=>{F("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);let s=o.target.result;this.F.O(s,i.transaction,o.oldVersion,this.version).next(()=>{F("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}B(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return x(this,null,function*(){let o=t==="readonly",s=0;for(;;){++s;try{this.db=yield this.M(e);let a=Og.open(this.db,e,o?"readonly":"readwrite",r),l=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),M.reject(c))).toPromise();return l.catch(()=>{}),yield a.m,l}catch(a){let l=a,c=l.name!=="FirebaseError"&&s<3;if(F("SimpleDb","Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function FO(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var EC=class{constructor(e){this.L=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.L=e}done(){this.k=!0}$(e){this.q=e}delete(){return ss(this.L.delete())}},ds=class extends k{constructor(e,t){super(N.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function ao(n){return n.name==="IndexedDbTransactionError"}var IC=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(F("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(F("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ss(r)}add(e){return F("SimpleDb","ADD",this.store.name,e,e),ss(this.store.add(e))}get(e){return ss(this.store.get(e)).next(t=>(t===void 0&&(t=null),F("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return F("SimpleDb","DELETE",this.store.name,e),ss(this.store.delete(e))}count(){return F("SimpleDb","COUNT",this.store.name),ss(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let o=i.getAll(r.range);return new M((s,a)=>{o.onerror=l=>{a(l.target.error)},o.onsuccess=l=>{s(l.target.result)}})}{let o=this.cursor(r),s=[];return this.W(o,(a,l)=>{s.push(l)}).next(()=>s)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new M((i,o)=>{r.onerror=s=>{o(s.target.error)},r.onsuccess=s=>{i(s.target.result)}})}j(e,t){F("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(o,s,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new M((r,i)=>{t.onerror=o=>{let s=fT(o.target.error);i(s)},t.onsuccess=o=>{let s=o.target.result;s?e(s.primaryKey,s.value).next(a=>{a?s.continue():r()}):r()}})}W(e,t){let r=[];return new M((i,o)=>{e.onerror=s=>{o(s.target.error)},e.onsuccess=s=>{let a=s.target.result;if(!a)return void i();let l=new EC(a),c=t(a.primaryKey,a.value,l);if(c instanceof M){let d=c.catch(h=>(l.done(),M.reject(h)));r.push(d)}l.isDone?i():l.K===null?a.continue():a.continue(l.K)}}).next(()=>M.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function ss(n){return new M((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=fT(r.target.error);t(i)}})}var Mk=!1;function fT(n){let e=Zi.D(nu());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new k("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Mk||(Mk=!0,setTimeout(()=>{throw r},0)),r}}return n}var CC=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){F("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>x(this,null,function*(){this.task=null;try{F("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){ao(t)?F("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield so(t)}yield this.X(6e4)}))}},DC=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return x(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,o=!0;return M.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(s=>{if(s!==null&&!r.has(s))return F("IndexBackfiller",`Processing collection: ${s}`),this.ne(e,s,i).next(a=>{i-=a,r.add(s)});o=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(o=>{let s=o.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next(()=>this.re(i,o)).next(a=>(F("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>s.size)}))}re(e,t){let r=e;return t.changes.forEach((i,o)=>{let s=kO(o);hT(s,r)>0&&(r=s)}),new jn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Cn=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Pd(n){return n==null}function hd(n){return n===0&&1/n==-1/0}function VO(n){return typeof n=="number"&&Number.isInteger(n)&&!hd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Ut(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Rk(e)),e=N3(n.get(t),e);return Rk(e)}function N3(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case"":t+="";break;default:t+=o}}return t}function Rk(n){return n+""}function Ir(n){let e=n.length;if(Y(e>=2),e===2)return Y(n.charAt(0)===""&&n.charAt(1)===""),Me.emptyPath();let t=e-2,r=[],i="";for(let o=0;o<e;){let s=n.indexOf("",o);switch((s<0||s>t)&&W(),n.charAt(s+1)){case"":let a=n.substring(o,s),l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=n.substring(o,s),i+="\0";break;case"":i+=n.substring(o,s+1);break;default:W()}o=s+2}return new Me(r)}var xk=["userId","batchId"];function Tg(n,e){return[n,Ut(e)]}function LO(n,e,t){return[n,Ut(e),t]}var P3={},k3=["prefixPath","collectionGroup","readTime","documentId"],O3=["prefixPath","collectionGroup","documentId"],F3=["collectionGroup","readTime","prefixPath","documentId"],V3=["canonicalId","targetId"],L3=["targetId","path"],j3=["path","targetId"],B3=["collectionId","parent"],U3=["indexId","uid"],$3=["uid","sequenceNumber"],H3=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],q3=["indexId","uid","orderedDocumentKey"],G3=["userId","collectionPath","documentId"],z3=["userId","collectionPath","largestBatchId"],W3=["userId","collectionGroup","largestBatchId"],jO=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],K3=[...jO,"documentOverlays"],BO=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],UO=BO,pT=[...UO,"indexConfiguration","indexState","indexEntries"],Q3=pT,Y3=[...pT,"globals"];var fd=class extends kg{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function wt(n,e){let t=H(n);return Zi.C(t._e,e)}function Nk(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function lo(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function $O(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var We=class n{constructor(e,t){this.comparator=e,this.root=t||Dr.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Dr.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Dr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new sl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new sl(this.root,e,this.comparator,!1)}getReverseIterator(){return new sl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new sl(this.root,e,this.comparator,!0)}},sl=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Dr=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw W();let e=this.left.check();if(e!==this.right.check())throw W();return e+(this.isRed()?0:1)}};Dr.EMPTY=null,Dr.RED=!0,Dr.BLACK=!1;Dr.EMPTY=new class{constructor(){this.size=0}get key(){throw W()}get value(){throw W()}get color(){throw W()}get left(){throw W()}get right(){throw W()}copy(e,t,r,i,o){return this}insert(e,t,r){return new Dr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ve=class n{constructor(e){this.comparator=e,this.data=new We(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Fg(this.data.getIterator())}getIteratorFrom(e){return new Fg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Fg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Za(n){return n.hasNext()?n.getNext():void 0}var Dn=class n{constructor(e){this.fields=e,e.sort(st.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ve(st.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return cl(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Vg=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function HO(){return typeof atob<"u"}var lt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Vg("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};lt.EMPTY_BYTE_STRING=new lt("");var Z3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ri(n){if(Y(!!n),typeof n=="string"){let e=0,t=Z3.exec(n);if(Y(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Qe(n.seconds),nanos:Qe(n.nanos)}}function Qe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ii(n){return typeof n=="string"?lt.fromBase64String(n):lt.fromUint8Array(n)}function Mm(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Rm(n){let e=n.mapValue.fields.__previous_value__;return Mm(e)?Rm(e):e}function pd(n){let e=ri(n.mapValue.fields.__local_write_time__.timestampValue);return new Je(e.seconds,e.nanos)}var TC=class{constructor(e,t,r,i,o,s,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}},Ji=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Ki={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},bg={nullValue:"NULL_VALUE"};function Xi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Mm(n)?4:qO(n)?9007199254740991:xm(n)?10:11:W()}function Sr(n,e){if(n===e)return!0;let t=Xi(n);if(t!==Xi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return pd(n).isEqual(pd(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let s=ri(i.timestampValue),a=ri(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return ii(i.bytesValue).isEqual(ii(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return Qe(i.geoPointValue.latitude)===Qe(o.geoPointValue.latitude)&&Qe(i.geoPointValue.longitude)===Qe(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Qe(i.integerValue)===Qe(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let s=Qe(i.doubleValue),a=Qe(o.doubleValue);return s===a?hd(s)===hd(a):isNaN(s)&&isNaN(a)}return!1}(n,e);case 9:return cl(n.arrayValue.values||[],e.arrayValue.values||[],Sr);case 10:case 11:return function(i,o){let s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(Nk(s)!==Nk(a))return!1;for(let l in s)if(s.hasOwnProperty(l)&&(a[l]===void 0||!Sr(s[l],a[l])))return!1;return!0}(n,e);default:return W()}}function gd(n,e){return(n.values||[]).find(t=>Sr(t,e))!==void 0}function eo(n,e){if(n===e)return 0;let t=Xi(n),r=Xi(e);if(t!==r)return le(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return le(n.booleanValue,e.booleanValue);case 2:return function(o,s){let a=Qe(o.integerValue||o.doubleValue),l=Qe(s.integerValue||s.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return Pk(n.timestampValue,e.timestampValue);case 4:return Pk(pd(n),pd(e));case 5:return le(n.stringValue,e.stringValue);case 6:return function(o,s){let a=ii(o),l=ii(s);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(o,s){let a=o.split("/"),l=s.split("/");for(let c=0;c<a.length&&c<l.length;c++){let d=le(a[c],l[c]);if(d!==0)return d}return le(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,s){let a=le(Qe(o.latitude),Qe(s.latitude));return a!==0?a:le(Qe(o.longitude),Qe(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return kk(n.arrayValue,e.arrayValue);case 10:return function(o,s){var a,l,c,d;let h=o.fields||{},g=s.fields||{},m=(a=h.value)===null||a===void 0?void 0:a.arrayValue,v=(l=g.value)===null||l===void 0?void 0:l.arrayValue,D=le(((c=m?.values)===null||c===void 0?void 0:c.length)||0,((d=v?.values)===null||d===void 0?void 0:d.length)||0);return D!==0?D:kk(m,v)}(n.mapValue,e.mapValue);case 11:return function(o,s){if(o===Ki.mapValue&&s===Ki.mapValue)return 0;if(o===Ki.mapValue)return 1;if(s===Ki.mapValue)return-1;let a=o.fields||{},l=Object.keys(a),c=s.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){let g=le(l[h],d[h]);if(g!==0)return g;let m=eo(a[l[h]],c[d[h]]);if(m!==0)return m}return le(l.length,d.length)}(n.mapValue,e.mapValue);default:throw W()}}function Pk(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return le(n,e);let t=ri(n),r=ri(e),i=le(t.seconds,r.seconds);return i!==0?i:le(t.nanos,r.nanos)}function kk(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=eo(t[i],r[i]);if(o)return o}return le(t.length,r.length)}function hl(n){return bC(n)}function bC(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=ri(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return ii(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return q.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=bC(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let s of r)o?o=!1:i+=",",i+=`${s}:${bC(t.fields[s])}`;return i+"}"}(n.mapValue):W()}function Sg(n){switch(Xi(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Rm(n);return e?16+Sg(e):16;case 5:return 2*n.stringValue.length;case 6:return ii(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,o)=>i+Sg(o),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return lo(r.fields,(o,s)=>{i+=o.length+Sg(s)}),i}(n.mapValue);default:throw W()}}function hs(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function SC(n){return!!n&&"integerValue"in n}function md(n){return!!n&&"arrayValue"in n}function Ok(n){return!!n&&"nullValue"in n}function Fk(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ag(n){return!!n&&"mapValue"in n}function xm(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function sd(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return lo(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=sd(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=sd(n.arrayValue.values[t]);return e}return Object.assign({},n)}function qO(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var GO={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function J3(n){return"nullValue"in n?bg:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?hs(Ji.empty(),q.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?xm(n)?GO:{mapValue:{}}:W()}function X3(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?hs(Ji.empty(),q.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?GO:"mapValue"in n?xm(n)?{mapValue:{}}:Ki:W()}function Vk(n,e){let t=eo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Lk(n,e){let t=eo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var Bt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Ag(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=sd(t)}setAll(e){let t=st.emptyPath(),r={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=sd(s):i.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());Ag(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Sr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Ag(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){lo(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(sd(this.value))}};function zO(n){let e=[];return lo(n.fields,(t,r)=>{let i=new st([t]);if(Ag(r)){let o=zO(r.mapValue).fields;if(o.length===0)e.push(i);else for(let s of o)e.push(i.child(s))}else e.push(i)}),new Dn(e)}var pt=class n{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,X.min(),X.min(),X.min(),Bt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,X.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,X.min(),X.min(),Bt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,X.min(),X.min(),Bt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(X.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=X.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Ar=class{constructor(e,t){this.position=e,this.inclusive=t}};function jk(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],s=n.position[i];if(o.field.isKeyField()?r=q.comparator(q.fromName(s.referenceValue),t.key):r=eo(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function Bk(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Sr(n.position[t],e.position[t]))return!1;return!0}var fs=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function e9(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Lg=class{},Ie=class n extends Lg{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new RC(e,t,r):t==="array-contains"?new PC(e,r):t==="in"?new jg(e,r):t==="not-in"?new kC(e,r):t==="array-contains-any"?new OC(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new xC(e,r):new NC(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(eo(t,this.value)):t!==null&&Xi(this.value)===Xi(t)&&this.matchesComparison(eo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return W()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Fe=class n extends Lg{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return fl(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function fl(n){return n.op==="and"}function AC(n){return n.op==="or"}function gT(n){return WO(n)&&fl(n)}function WO(n){for(let e of n.filters)if(e instanceof Fe)return!1;return!0}function MC(n){if(n instanceof Ie)return n.field.canonicalString()+n.op.toString()+hl(n.value);if(gT(n))return n.filters.map(e=>MC(e)).join(",");{let e=n.filters.map(t=>MC(t)).join(",");return`${n.op}(${e})`}}function KO(n,e){return n instanceof Ie?function(r,i){return i instanceof Ie&&r.op===i.op&&r.field.isEqual(i.field)&&Sr(r.value,i.value)}(n,e):n instanceof Fe?function(r,i){return i instanceof Fe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,a)=>o&&KO(s,i.filters[a]),!0):!1}(n,e):void W()}function QO(n,e){let t=n.filters.concat(e);return Fe.create(t,n.op)}function YO(n){return n instanceof Ie?function(t){return`${t.field.canonicalString()} ${t.op} ${hl(t.value)}`}(n):n instanceof Fe?function(t){return t.op.toString()+" {"+t.getFilters().map(YO).join(" ,")+"}"}(n):"Filter"}var RC=class extends Ie{constructor(e,t,r){super(e,t,r),this.key=q.fromName(r.referenceValue)}matches(e){let t=q.comparator(e.key,this.key);return this.matchesComparison(t)}},xC=class extends Ie{constructor(e,t){super(e,"in",t),this.keys=ZO("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},NC=class extends Ie{constructor(e,t){super(e,"not-in",t),this.keys=ZO("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function ZO(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>q.fromName(r.referenceValue))}var PC=class extends Ie{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return md(t)&&gd(t.arrayValue,this.value)}},jg=class extends Ie{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&gd(this.value.arrayValue,t)}},kC=class extends Ie{constructor(e,t){super(e,"not-in",t)}matches(e){if(gd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!gd(this.value.arrayValue,t)}},OC=class extends Ie{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!md(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>gd(this.value.arrayValue,r))}};var FC=class{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.ue=null}};function VC(n,e=null,t=[],r=[],i=null,o=null,s=null){return new FC(n,e,t,r,i,o,s)}function ps(n){let e=H(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>MC(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),Pd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>hl(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>hl(r)).join(",")),e.ue=t}return e.ue}function kd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!e9(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!KO(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Bk(n.startAt,e.startAt)&&Bk(n.endAt,e.endAt)}function Bg(n){return q.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Ug(n,e){return n.filters.filter(t=>t instanceof Ie&&t.field.isEqual(e))}function Uk(n,e,t){let r=bg,i=!0;for(let o of Ug(n,e)){let s=bg,a=!0;switch(o.op){case"<":case"<=":s=J3(o.value);break;case"==":case"in":case">=":s=o.value;break;case">":s=o.value,a=!1;break;case"!=":case"not-in":s=bg}Vk({value:r,inclusive:i},{value:s,inclusive:a})<0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];Vk({value:r,inclusive:i},{value:s,inclusive:t.inclusive})<0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}function $k(n,e,t){let r=Ki,i=!0;for(let o of Ug(n,e)){let s=Ki,a=!0;switch(o.op){case">=":case">":s=X3(o.value),a=!1;break;case"==":case"in":case"<=":s=o.value;break;case"<":s=o.value,a=!1;break;case"!=":case"not-in":s=Ki}Lk({value:r,inclusive:i},{value:s,inclusive:a})>0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];Lk({value:r,inclusive:i},{value:s,inclusive:t.inclusive})>0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}var er=class{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function JO(n,e,t,r,i,o,s,a){return new er(n,e,t,r,i,o,s,a)}function Al(n){return new er(n)}function Hk(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function mT(n){return n.collectionGroup!==null}function ll(n){let e=H(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Ve(st.comparator);return s.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new fs(o,r))}),t.has(st.keyField().canonicalString())||e.ce.push(new fs(st.keyField(),r))}return e.ce}function Xt(n){let e=H(n);return e.le||(e.le=t9(e,ll(n))),e.le}function t9(n,e){if(n.limitType==="F")return VC(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new fs(i.field,o)});let t=n.endAt?new Ar(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ar(n.startAt.position,n.startAt.inclusive):null;return VC(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function LC(n,e){let t=n.filters.concat([e]);return new er(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function $g(n,e,t){return new er(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Od(n,e){return kd(Xt(n),Xt(e))&&n.limitType===e.limitType}function XO(n){return`${ps(Xt(n))}|lt:${n.limitType}`}function nl(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>YO(i)).join(", ")}]`),Pd(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>hl(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>hl(i)).join(",")),`Target(${r})`}(Xt(n))}; limitType=${n.limitType})`}function Fd(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):q.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of ll(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(s,a,l){let c=jk(s,a,l);return s.inclusive?c<=0:c<0}(r.startAt,ll(r),i)||r.endAt&&!function(s,a,l){let c=jk(s,a,l);return s.inclusive?c>=0:c>0}(r.endAt,ll(r),i))}(n,e)}function e1(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function t1(n){return(e,t)=>{let r=!1;for(let i of ll(n)){let o=n9(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function n9(n,e,t){let r=n.field.isKeyField()?q.comparator(e.key,t.key):function(o,s,a){let l=s.data.field(o),c=a.data.field(o);return l!==null&&c!==null?eo(l,c):W()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return W()}}var tr=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){lo(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return $O(this.inner)}size(){return this.innerSize}};var r9=new We(q.comparator);function un(){return r9}var n1=new We(q.comparator);function id(...n){let e=n1;for(let t of n)e=e.insert(t.key,t);return e}function r1(n){let e=n1;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Cr(){return ad()}function i1(){return ad()}function ad(){return new tr(n=>n.toString(),(n,e)=>n.isEqual(e))}var i9=new We(q.comparator),o9=new Ve(q.comparator);function fe(...n){let e=o9;for(let t of n)e=e.add(t);return e}var s9=new Ve(le);function yT(){return s9}function _T(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:hd(e)?"-0":e}}function o1(n){return{integerValue:""+n}}function s1(n,e){return VO(e)?o1(e):_T(n,e)}var pl=class{constructor(){this._=void 0}};function a9(n,e,t){return n instanceof to?function(i,o){let s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Mm(o)&&(o=Rm(o)),o&&(s.fields.__previous_value__=o),{mapValue:s}}(t,e):n instanceof oi?l1(n,e):n instanceof si?u1(n,e):function(i,o){let s=a1(i,o),a=qk(s)+qk(i.Pe);return SC(s)&&SC(i.Pe)?o1(a):_T(i.serializer,a)}(n,e)}function l9(n,e,t){return n instanceof oi?l1(n,e):n instanceof si?u1(n,e):t}function a1(n,e){return n instanceof no?function(r){return SC(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var to=class extends pl{},oi=class extends pl{constructor(e){super(),this.elements=e}};function l1(n,e){let t=c1(e);for(let r of n.elements)t.some(i=>Sr(i,r))||t.push(r);return{arrayValue:{values:t}}}var si=class extends pl{constructor(e){super(),this.elements=e}};function u1(n,e){let t=c1(e);for(let r of n.elements)t=t.filter(i=>!Sr(i,r));return{arrayValue:{values:t}}}var no=class extends pl{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function qk(n){return Qe(n.integerValue||n.doubleValue)}function c1(n){return md(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var gs=class{constructor(e,t){this.field=e,this.transform=t}};function u9(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof oi&&i instanceof oi||r instanceof si&&i instanceof si?cl(r.elements,i.elements,Sr):r instanceof no&&i instanceof no?Sr(r.Pe,i.Pe):r instanceof to&&i instanceof to}(n.transform,e.transform)}var jC=class{constructor(e,t){this.version=e,this.transformResults=t}},rt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Mg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var gl=class{};function d1(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new io(n.key,rt.none()):new ro(n.key,n.data,rt.none());{let t=n.data,r=Bt.empty(),i=new Ve(st.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new nr(n.key,r,new Dn(i.toArray()),rt.none())}}function c9(n,e,t){n instanceof ro?function(i,o,s){let a=i.value.clone(),l=zk(i.fieldTransforms,o,s.transformResults);a.setAll(l),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):n instanceof nr?function(i,o,s){if(!Mg(i.precondition,o))return void o.convertToUnknownDocument(s.version);let a=zk(i.fieldTransforms,o,s.transformResults),l=o.data;l.setAll(h1(i)),l.setAll(a),o.convertToFoundDocument(s.version,l).setHasCommittedMutations()}(n,e,t):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function ld(n,e,t,r){return n instanceof ro?function(o,s,a,l){if(!Mg(o.precondition,s))return a;let c=o.value.clone(),d=Wk(o.fieldTransforms,l,s);return c.setAll(d),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof nr?function(o,s,a,l){if(!Mg(o.precondition,s))return a;let c=Wk(o.fieldTransforms,l,s),d=s.data;return d.setAll(h1(o)),d.setAll(c),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(o,s,a){return Mg(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a}(n,e,t)}function d9(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=a1(r.transform,i||null);o!=null&&(t===null&&(t=Bt.empty()),t.set(r.field,o))}return t||null}function Gk(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&cl(r,i,(o,s)=>u9(o,s))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var ro=class extends gl{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},nr=class extends gl{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function h1(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function zk(n,e,t){let r=new Map;Y(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,l9(s,a,t[i]))}return r}function Wk(n,e,t){let r=new Map;for(let i of n){let o=i.transform,s=t.data.field(i.field);r.set(i.field,a9(o,s,e))}return r}var io=class extends gl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},yd=class extends gl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var _d=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&c9(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=ld(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=ld(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=i1();return this.mutations.forEach(i=>{let o=e.get(i.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;let l=d1(s,a);l!==null&&r.set(i.key,l),s.isValidDocument()||s.convertToNoDocument(X.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),fe())}isEqual(e){return this.batchId===e.batchId&&cl(this.mutations,e.mutations,(t,r)=>Gk(t,r))&&cl(this.baseMutations,e.baseMutations,(t,r)=>Gk(t,r))}},BC=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Y(e.mutations.length===r.length);let i=function(){return i9}(),o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new n(e,t,r,i)}};var vd=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var UC=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var dt,Ae;function f1(n){switch(n){default:return W();case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0}}function p1(n){if(n===void 0)return ot("GRPC error has no .code"),N.UNKNOWN;switch(n){case dt.OK:return N.OK;case dt.CANCELLED:return N.CANCELLED;case dt.UNKNOWN:return N.UNKNOWN;case dt.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case dt.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case dt.INTERNAL:return N.INTERNAL;case dt.UNAVAILABLE:return N.UNAVAILABLE;case dt.UNAUTHENTICATED:return N.UNAUTHENTICATED;case dt.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case dt.NOT_FOUND:return N.NOT_FOUND;case dt.ALREADY_EXISTS:return N.ALREADY_EXISTS;case dt.PERMISSION_DENIED:return N.PERMISSION_DENIED;case dt.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case dt.ABORTED:return N.ABORTED;case dt.OUT_OF_RANGE:return N.OUT_OF_RANGE;case dt.UNIMPLEMENTED:return N.UNIMPLEMENTED;case dt.DATA_LOSS:return N.DATA_LOSS;default:return W()}}(Ae=dt||(dt={}))[Ae.OK=0]="OK",Ae[Ae.CANCELLED=1]="CANCELLED",Ae[Ae.UNKNOWN=2]="UNKNOWN",Ae[Ae.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ae[Ae.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ae[Ae.NOT_FOUND=5]="NOT_FOUND",Ae[Ae.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ae[Ae.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ae[Ae.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ae[Ae.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ae[Ae.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ae[Ae.ABORTED=10]="ABORTED",Ae[Ae.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ae[Ae.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ae[Ae.INTERNAL=13]="INTERNAL",Ae[Ae.UNAVAILABLE=14]="UNAVAILABLE",Ae[Ae.DATA_LOSS=15]="DATA_LOSS";var Kk=null;function g1(){return new TextEncoder}var h9=new Xr([4294967295,4294967295],0);function Qk(n){let e=g1().encode(n),t=new nC;return t.update(e),new Uint8Array(t.digest())}function Yk(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Xr([t,r],0),new Xr([i,o],0)]}var $C=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new cs(`Invalid padding: ${t}`);if(r<0)throw new cs(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new cs(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new cs(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ie=Xr.fromNumber(this.Te)}de(e,t,r){let i=e.add(t.multiply(Xr.fromNumber(r)));return i.compare(h9)===1&&(i=new Xr([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ie).toNumber()}Ee(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let t=Qk(e),[r,i]=Yk(t);for(let o=0;o<this.hashCount;o++){let s=this.de(r,i,o);if(!this.Ee(s))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,i,t);return r.forEach(a=>s.insert(a)),s}insert(e){if(this.Te===0)return;let t=Qk(e),[r,i]=Yk(t);for(let o=0;o<this.hashCount;o++){let s=this.de(r,i,o);this.Ae(s)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},cs=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var wd=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Ed.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(X.min(),i,new We(le),un(),fe())}},Ed=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,fe(),fe(),fe())}};var ul=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Hg=class{constructor(e,t){this.targetId=e,this.me=t}},qg=class{constructor(e,t,r=lt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Gg=class{constructor(){this.fe=0,this.ge=Zk(),this.pe=lt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=fe(),t=fe(),r=fe();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:W()}}),new Ed(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Zk()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Y(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},HC=class{constructor(e){this.Be=e,this.Le=new Map,this.ke=un(),this.qe=wg(),this.Qe=wg(),this.Ke=new We(le)}$e(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(t,e.Ve):this.We(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.We(t,e.key,e.Ve)}Ge(e){this.forEachTarget(e,t=>{let r=this.ze(t);switch(e.state){case 0:this.je(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.je(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),r.De(e.resumeToken));break;default:W()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Le.forEach((r,i)=>{this.je(i)&&t(i)})}Je(e){let t=e.targetId,r=e.me.count,i=this.Ye(t);if(i){let o=i.target;if(Bg(o))if(r===0){let s=new q(o.path);this.We(t,s,pt.newNoDocument(s,X.min()))}else Y(r===1);else{let s=this.Ze(t);if(s!==r){let a=this.Xe(e),l=a?this.et(a,e,s):1;if(l!==0){this.He(t);let c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,c)}Kk?.tt(function(d,h,g,m,v){var D,S,P,j,O,K;let ie={localCacheCount:d,existenceFilterCount:h.count,databaseId:g.database,projectId:g.projectId},ee=h.unchangedNames;return ee&&(ie.bloomFilter={applied:v===0,hashCount:(D=ee?.hashCount)!==null&&D!==void 0?D:0,bitmapLength:(j=(P=(S=ee?.bits)===null||S===void 0?void 0:S.bitmap)===null||P===void 0?void 0:P.length)!==null&&j!==void 0?j:0,padding:(K=(O=ee?.bits)===null||O===void 0?void 0:O.padding)!==null&&K!==void 0?K:0,mightContain:I=>{var _;return(_=m?.mightContain(I))!==null&&_!==void 0&&_}}),ie}(s,e.me,this.Be.nt(),a,l))}}}}Xe(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,s,a;try{s=ii(r).toUint8Array()}catch(l){if(l instanceof Vg)return Xn("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new $C(s,i,o)}catch(l){return Xn(l instanceof cs?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Te===0?null:a}et(e,t,r){return t.me.count===r-this.rt(e,t.targetId)?0:2}rt(e,t){let r=this.Be.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let s=this.Be.nt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.We(t,o,null),i++)}),i}it(e){let t=new Map;this.Le.forEach((o,s)=>{let a=this.Ye(s);if(a){if(o.current&&Bg(a.target)){let l=new q(a.target.path);this.st(l).has(s)||this.ot(s,l)||this.We(s,l,pt.newNoDocument(l,e))}o.be&&(t.set(s,o.ve()),o.Ce())}});let r=fe();this.Qe.forEach((o,s)=>{let a=!0;s.forEachWhile(l=>{let c=this.Ye(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(o))}),this.ke.forEach((o,s)=>s.setReadTime(e));let i=new wd(e,t,this.Ke,this.ke,r);return this.ke=un(),this.qe=wg(),this.Qe=wg(),this.Ke=new We(le),i}Ue(e,t){if(!this.je(e))return;let r=this.ot(e,t.key)?2:0;this.ze(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e)),this.Qe=this.Qe.insert(t.key,this._t(t.key).add(e))}We(e,t,r){if(!this.je(e))return;let i=this.ze(e);this.ot(e,t)?i.Fe(t,1):i.Me(t),this.Qe=this.Qe.insert(t,this._t(t).delete(e)),this.Qe=this.Qe.insert(t,this._t(t).add(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Le.delete(e)}Ze(e){let t=this.ze(e).ve();return this.Be.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let t=this.Le.get(e);return t||(t=new Gg,this.Le.set(e,t)),t}_t(e){let t=this.Qe.get(e);return t||(t=new Ve(le),this.Qe=this.Qe.insert(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ve(le),this.qe=this.qe.insert(e,t)),t}je(e){let t=this.Ye(e)!==null;return t||F("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){let t=this.Le.get(e);return t&&t.Se?null:this.Be.ut(e)}He(e){this.Le.set(e,new Gg),this.Be.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}ot(e,t){return this.Be.getRemoteKeysForTarget(e).has(t)}};function wg(){return new We(q.comparator)}function Zk(){return new We(q.comparator)}var f9={asc:"ASCENDING",desc:"DESCENDING"},p9={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},g9={and:"AND",or:"OR"},qC=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function GC(n,e){return n.useProto3Json||Pd(e)?e:{value:e}}function ml(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function m1(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function m9(n,e){return ml(n,e.toTimestamp())}function at(n){return Y(!!n),X.fromTimestamp(function(t){let r=ri(t);return new Je(r.seconds,r.nanos)}(n))}function vT(n,e){return zC(n,e).canonicalString()}function zC(n,e){let t=function(i){return new Me(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function y1(n){let e=Me.fromString(n);return Y(S1(e)),e}function Id(n,e){return vT(n.databaseId,e.path)}function Tr(n,e){let t=y1(e);if(t.get(1)!==n.databaseId.projectId)throw new k(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new k(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new q(w1(t))}function _1(n,e){return vT(n.databaseId,e)}function v1(n){let e=y1(n);return e.length===4?Me.emptyPath():w1(e)}function WC(n){return new Me(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function w1(n){return Y(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Jk(n,e,t){return{name:Id(n,e),fields:t.value.mapValue.fields}}function E1(n,e,t){let r=Tr(n,e.name),i=at(e.updateTime),o=e.createTime?at(e.createTime):X.min(),s=new Bt({mapValue:{fields:e.fields}}),a=pt.newFoundDocument(r,i,o,s);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function y9(n,e){return"found"in e?function(r,i){Y(!!i.found),i.found.name,i.found.updateTime;let o=Tr(r,i.found.name),s=at(i.found.updateTime),a=i.found.createTime?at(i.found.createTime):X.min(),l=new Bt({mapValue:{fields:i.found.fields}});return pt.newFoundDocument(o,s,a,l)}(n,e):"missing"in e?function(r,i){Y(!!i.missing),Y(!!i.readTime);let o=Tr(r,i.missing),s=at(i.readTime);return pt.newNoDocument(o,s)}(n,e):W()}function _9(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:W()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(c,d){return c.useProto3Json?(Y(d===void 0||typeof d=="string"),lt.fromBase64String(d||"")):(Y(d===void 0||d instanceof Buffer||d instanceof Uint8Array),lt.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(c){let d=c.code===void 0?N.UNKNOWN:p1(c.code);return new k(d,c.message||"")}(s);t=new qg(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Tr(n,r.document.name),o=at(r.document.updateTime),s=r.document.createTime?at(r.document.createTime):X.min(),a=new Bt({mapValue:{fields:r.document.fields}}),l=pt.newFoundDocument(i,o,s,a),c=r.targetIds||[],d=r.removedTargetIds||[];t=new ul(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Tr(n,r.document),o=r.readTime?at(r.readTime):X.min(),s=pt.newNoDocument(i,o),a=r.removedTargetIds||[];t=new ul([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Tr(n,r.document),o=r.removedTargetIds||[];t=new ul([],o,i,null)}else{if(!("filter"in e))return W();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,s=new UC(i,o),a=r.targetId;t=new Hg(a,s)}}return t}function Cd(n,e){let t;if(e instanceof ro)t={update:Jk(n,e.key,e.value)};else if(e instanceof io)t={delete:Id(n,e.key)};else if(e instanceof nr)t={update:Jk(n,e.key,e.data),updateMask:D9(e.fieldMask)};else{if(!(e instanceof yd))return W();t={verify:Id(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,s){let a=s.transform;if(a instanceof to)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof oi)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof si)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof no)return{fieldPath:s.field.canonicalString(),increment:a.Pe};throw W()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:m9(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:W()}(n,e.precondition)),t}function KC(n,e){let t=e.currentDocument?function(o){return o.updateTime!==void 0?rt.updateTime(at(o.updateTime)):o.exists!==void 0?rt.exists(o.exists):rt.none()}(e.currentDocument):rt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,a){let l=null;if("setToServerValue"in a)Y(a.setToServerValue==="REQUEST_TIME"),l=new to;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];l=new oi(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];l=new si(d)}else"increment"in a?l=new no(s,a.increment):W();let c=st.fromServerFormat(a.fieldPath);return new gs(c,l)}(n,i)):[];if(e.update){e.update.name;let i=Tr(n,e.update.name),o=new Bt({mapValue:{fields:e.update.fields}});if(e.updateMask){let s=function(l){let c=l.fieldPaths||[];return new Dn(c.map(d=>st.fromServerFormat(d)))}(e.updateMask);return new nr(i,o,s,t,r)}return new ro(i,o,t,r)}if(e.delete){let i=Tr(n,e.delete);return new io(i,t)}if(e.verify){let i=Tr(n,e.verify);return new yd(i,t)}return W()}function v9(n,e){return n&&n.length>0?(Y(e!==void 0),n.map(t=>function(i,o){let s=i.updateTime?at(i.updateTime):at(o);return s.isEqual(X.min())&&(s=at(o)),new jC(s,i.transformResults||[])}(t,e))):[]}function I1(n,e){return{documents:[_1(n,e.path)]}}function C1(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=_1(n,i);let o=function(c){if(c.length!==0)return b1(Fe.create(c,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let s=function(c){if(c.length!==0)return c.map(d=>function(g){return{field:rl(g.field),direction:E9(g.dir)}}(d))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=GC(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ct:t,parent:i}}function D1(n){let e=v1(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){Y(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let o=[];t.where&&(o=function(h){let g=T1(h);return g instanceof Fe&&gT(g)?g.getFilters():[g]}(t.where));let s=[];t.orderBy&&(s=function(h){return h.map(g=>function(v){return new fs(il(v.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(g))}(t.orderBy));let a=null;t.limit&&(a=function(h){let g;return g=typeof h=="object"?h.value:h,Pd(g)?null:g}(t.limit));let l=null;t.startAt&&(l=function(h){let g=!!h.before,m=h.values||[];return new Ar(m,g)}(t.startAt));let c=null;return t.endAt&&(c=function(h){let g=!h.before,m=h.values||[];return new Ar(m,g)}(t.endAt)),JO(e,i,s,o,a,"F",l,c)}function w9(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return W()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function T1(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=il(t.unaryFilter.field);return Ie.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=il(t.unaryFilter.field);return Ie.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=il(t.unaryFilter.field);return Ie.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=il(t.unaryFilter.field);return Ie.create(s,"!=",{nullValue:"NULL_VALUE"});default:return W()}}(n):n.fieldFilter!==void 0?function(t){return Ie.create(il(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return W()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Fe.create(t.compositeFilter.filters.map(r=>T1(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return W()}}(t.compositeFilter.op))}(n):W()}function E9(n){return f9[n]}function I9(n){return p9[n]}function C9(n){return g9[n]}function rl(n){return{fieldPath:n.canonicalString()}}function il(n){return st.fromServerFormat(n.fieldPath)}function b1(n){return n instanceof Ie?function(t){if(t.op==="=="){if(Fk(t.value))return{unaryFilter:{field:rl(t.field),op:"IS_NAN"}};if(Ok(t.value))return{unaryFilter:{field:rl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Fk(t.value))return{unaryFilter:{field:rl(t.field),op:"IS_NOT_NAN"}};if(Ok(t.value))return{unaryFilter:{field:rl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:rl(t.field),op:I9(t.op),value:t.value}}}(n):n instanceof Fe?function(t){let r=t.getFilters().map(i=>b1(i));return r.length===1?r[0]:{compositeFilter:{op:C9(t.op),filters:r}}}(n):W()}function D9(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function S1(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var yl=class n{constructor(e,t,r,i,o=X.min(),s=X.min(),a=lt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var zg=class{constructor(e){this.ht=e}};function T9(n,e){let t;if(e.document)t=E1(n.ht,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=q.fromSegments(e.noDocument.path),i=ys(e.noDocument.readTime);t=pt.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return W();{let r=q.fromSegments(e.unknownDocument.path),i=ys(e.unknownDocument.version);t=pt.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let o=new Je(i[0],i[1]);return X.fromTimestamp(o)}(e.readTime)),t}function Xk(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Wg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,s){return{name:Id(o,s.key),fields:s.data.value.mapValue.fields,updateTime:ml(o,s.version.toTimestamp()),createTime:ml(o,s.createTime.toTimestamp())}}(n.ht,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:ms(e.version)};else{if(!e.isUnknownDocument())return W();r.unknownDocument={path:t.path.toArray(),version:ms(e.version)}}return r}function Wg(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function ms(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ys(n){let e=new Je(n.seconds,n.nanoseconds);return X.fromTimestamp(e)}function as(n,e){let t=(e.baseMutations||[]).map(o=>KC(n.ht,o));for(let o=0;o<e.mutations.length-1;++o){let s=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){let a=e.mutations[o+1];s.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}let r=e.mutations.map(o=>KC(n.ht,o)),i=Je.fromMillis(e.localWriteTimeMs);return new _d(e.batchId,i,t,r)}function od(n){let e=ys(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?ys(n.lastLimboFreeSnapshotVersion):X.min(),r;return r=function(o){return o.documents!==void 0}(n.query)?function(o){return Y(o.documents.length===1),Xt(Al(v1(o.documents[0])))}(n.query):function(o){return Xt(D1(o))}(n.query),new yl(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,lt.fromBase64String(n.resumeToken))}function A1(n,e){let t=ms(e.snapshotVersion),r=ms(e.lastLimboFreeSnapshotVersion),i;i=Bg(e.target)?I1(n.ht,e.target):C1(n.ht,e.target).ct;let o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ps(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function wT(n){let e=D1({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?$g(e,e.limit,"L"):e}function lC(n,e){return new vd(e.largestBatchId,KC(n.ht,e.overlayMutation))}function eO(n,e){let t=e.path.lastSegment();return[n,Ut(e.path.popLast()),t]}function tO(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:ms(r.readTime),documentKey:Ut(r.documentKey.path),largestBatchId:r.largestBatchId}}var QC=class{getBundleMetadata(e,t){return nO(e).get(t).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:ys(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,t){return nO(e).put(function(i){return{bundleId:i.id,createTime:ms(at(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return rO(e).get(t).next(r=>{if(r)return function(o){return{name:o.name,query:wT(o.bundledQuery),readTime:ys(o.readTime)}}(r)})}saveNamedQuery(e,t){return rO(e).put(function(i){return{name:i.name,readTime:ms(at(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function nO(n){return wt(n,"bundles")}function rO(n){return wt(n,"namedQueries")}var Kg=class n{constructor(e,t){this.serializer=e,this.userId=t}static Pt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return ed(e).get(eO(this.userId,t)).next(r=>r?lC(this.serializer,r):null)}getOverlays(e,t){let r=Cr();return M.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((o,s)=>{let a=new vd(t,s);i.push(this.Tt(e,a))}),M.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(s=>i.add(Ut(s.getCollectionPath())));let o=[];return i.forEach(s=>{let a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,r+1],!1,!0);o.push(ed(e).j("collectionPathOverlayIndex",a))}),M.waitFor(o)}getOverlaysForCollection(e,t,r){let i=Cr(),o=Ut(t),s=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return ed(e).U("collectionPathOverlayIndex",s).next(a=>{for(let l of a){let c=lC(this.serializer,l);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let o=Cr(),s,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ed(e).J({index:"collectionGroupOverlayIndex",range:a},(l,c,d)=>{let h=lC(this.serializer,c);o.size()<i||h.largestBatchId===s?(o.set(h.getKey(),h),s=h.largestBatchId):d.done()}).next(()=>o)}Tt(e,t){return ed(e).put(function(i,o,s){let[a,l,c]=eO(o,s.mutation.key);return{userId:o,collectionPath:l,documentId:c,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:Cd(i.ht,s.mutation)}}(this.serializer,this.userId,t))}};function ed(n){return wt(n,"documentOverlays")}var YC=class{It(e){return wt(e,"globals")}getSessionToken(e){return this.It(e).get("sessionToken").next(t=>{let r=t?.value;return r?lt.fromUint8Array(r):lt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.It(e).put({name:"sessionToken",value:t.toUint8Array()})}};var ti=class{constructor(){}dt(e,t){this.Et(e,t),t.At()}Et(e,t){if("nullValue"in e)this.Rt(t,5);else if("booleanValue"in e)this.Rt(t,10),t.Vt(e.booleanValue?1:0);else if("integerValue"in e)this.Rt(t,15),t.Vt(Qe(e.integerValue));else if("doubleValue"in e){let r=Qe(e.doubleValue);isNaN(r)?this.Rt(t,13):(this.Rt(t,15),hd(r)?t.Vt(0):t.Vt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Rt(t,20),typeof r=="string"&&(r=ri(r)),t.ft(`${r.seconds||""}`),t.Vt(r.nanos||0)}else if("stringValue"in e)this.gt(e.stringValue,t),this.yt(t);else if("bytesValue"in e)this.Rt(t,30),t.wt(ii(e.bytesValue)),this.yt(t);else if("referenceValue"in e)this.St(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Rt(t,45),t.Vt(r.latitude||0),t.Vt(r.longitude||0)}else"mapValue"in e?qO(e)?this.Rt(t,Number.MAX_SAFE_INTEGER):xm(e)?this.bt(e.mapValue,t):(this.Dt(e.mapValue,t),this.yt(t)):"arrayValue"in e?(this.vt(e.arrayValue,t),this.yt(t)):W()}gt(e,t){this.Rt(t,25),this.Ct(e,t)}Ct(e,t){t.ft(e)}Dt(e,t){let r=e.fields||{};this.Rt(t,55);for(let i of Object.keys(r))this.gt(i,t),this.Et(r[i],t)}bt(e,t){var r,i;let o=e.fields||{};this.Rt(t,53);let s="value",a=((i=(r=o[s].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Rt(t,15),t.Vt(Qe(a)),this.gt(s,t),this.Et(o[s],t)}vt(e,t){let r=e.values||[];this.Rt(t,50);for(let i of r)this.Et(i,t)}St(e,t){this.Rt(t,37),q.fromName(e).path.forEach(r=>{this.Rt(t,60),this.Ct(r,t)})}Rt(e,t){e.Vt(t)}yt(e){e.Vt(2)}};ti.Ft=new ti;function b9(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function iO(n){let e=64-function(r){let i=0;for(let o=0;o<8;++o){let s=b9(255&r[o]);if(i+=s,s!==8)break}return i}(n);return Math.ceil(e/8)}var ZC=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Mt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.xt(r.value),r=t.next();this.Ot()}Nt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Bt(r.value),r=t.next();this.Lt()}kt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.xt(r);else if(r<2048)this.xt(960|r>>>6),this.xt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.xt(480|r>>>12),this.xt(128|63&r>>>6),this.xt(128|63&r);else{let i=t.codePointAt(0);this.xt(240|i>>>18),this.xt(128|63&i>>>12),this.xt(128|63&i>>>6),this.xt(128|63&i)}}this.Ot()}qt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Bt(r);else if(r<2048)this.Bt(960|r>>>6),this.Bt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Bt(480|r>>>12),this.Bt(128|63&r>>>6),this.Bt(128|63&r);else{let i=t.codePointAt(0);this.Bt(240|i>>>18),this.Bt(128|63&i>>>12),this.Bt(128|63&i>>>6),this.Bt(128|63&i)}}this.Lt()}Qt(e){let t=this.Kt(e),r=iO(t);this.$t(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Ut(e){let t=this.Kt(e),r=iO(t);this.$t(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Wt(){this.Gt(255),this.Gt(255)}zt(){this.jt(255),this.jt(255)}reset(){this.position=0}seed(e){this.$t(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ht(){return this.buffer.slice(0,this.position)}Kt(e){let t=function(o){let s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,o,!1),new Uint8Array(s.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}xt(e){let t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(t)}Bt(e){let t=255&e;t===0?(this.jt(0),this.jt(255)):t===255?(this.jt(255),this.jt(0)):this.jt(e)}Ot(){this.Gt(0),this.Gt(1)}Lt(){this.jt(0),this.jt(1)}Gt(e){this.$t(1),this.buffer[this.position++]=e}jt(e){this.$t(1),this.buffer[this.position++]=~e}$t(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},JC=class{constructor(e){this.Jt=e}wt(e){this.Jt.Mt(e)}ft(e){this.Jt.kt(e)}Vt(e){this.Jt.Qt(e)}At(){this.Jt.Wt()}},XC=class{constructor(e){this.Jt=e}wt(e){this.Jt.Nt(e)}ft(e){this.Jt.qt(e)}Vt(e){this.Jt.Ut(e)}At(){this.Jt.zt()}},ls=class{constructor(){this.Jt=new ZC,this.Yt=new JC(this.Jt),this.Zt=new XC(this.Jt)}seed(e){this.Jt.seed(e)}Xt(e){return e===0?this.Yt:this.Zt}Ht(){return this.Jt.Ht()}reset(){this.Jt.reset()}};var us=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}en(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function qi(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=oO(n.arrayValue,e.arrayValue),t!==0?t:(t=oO(n.directionalValue,e.directionalValue),t!==0?t:q.comparator(n.documentKey,e.documentKey)))}function oO(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var Qg=class{constructor(e){this.tn=new Ve((t,r)=>st.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.nn=e.orderBy,this.rn=[];for(let t of e.filters){let r=t;r.isInequality()?this.tn=this.tn.add(r):this.rn.push(r)}}get sn(){return this.tn.size>1}on(e){if(Y(e.collectionGroup===this.collectionId),this.sn)return!1;let t=wC(e);if(t!==void 0&&!this._n(t))return!1;let r=os(e),i=new Set,o=0,s=0;for(;o<r.length&&this._n(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.tn.size>0){let a=this.tn.getIterator().getNext();if(!i.has(a.field.canonicalString())){let l=r[o];if(!this.an(a,l)||!this.un(this.nn[s++],l))return!1}++o}for(;o<r.length;++o){let a=r[o];if(s>=this.nn.length||!this.un(this.nn[s++],a))return!1}return!0}cn(){if(this.sn)return null;let e=new Ve(st.comparator),t=[];for(let r of this.rn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new al(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new al(r.field,0))}for(let r of this.nn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new al(r.field,r.dir==="asc"?0:1)));return new dl(dl.UNKNOWN_ID,this.collectionId,t,dd.empty())}_n(e){for(let t of this.rn)if(this.an(t,e))return!0;return!1}an(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}un(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function M1(n){var e,t;if(Y(n instanceof Ie||n instanceof Fe),n instanceof Ie){if(n instanceof jg){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(o=>Ie.create(n.field,"==",o)))||[];return Fe.create(i,"or")}return n}let r=n.filters.map(i=>M1(i));return Fe.create(r,n.op)}function S9(n){if(n.getFilters().length===0)return[];let e=nD(M1(n));return Y(R1(e)),eD(e)||tD(e)?[e]:e.getFilters()}function eD(n){return n instanceof Ie}function tD(n){return n instanceof Fe&&gT(n)}function R1(n){return eD(n)||tD(n)||function(t){if(t instanceof Fe&&AC(t)){for(let r of t.getFilters())if(!eD(r)&&!tD(r))return!1;return!0}return!1}(n)}function nD(n){if(Y(n instanceof Ie||n instanceof Fe),n instanceof Ie)return n;if(n.filters.length===1)return nD(n.filters[0]);let e=n.filters.map(r=>nD(r)),t=Fe.create(e,n.op);return t=Yg(t),R1(t)?t:(Y(t instanceof Fe),Y(fl(t)),Y(t.filters.length>1),t.filters.reduce((r,i)=>ET(r,i)))}function ET(n,e){let t;return Y(n instanceof Ie||n instanceof Fe),Y(e instanceof Ie||e instanceof Fe),t=n instanceof Ie?e instanceof Ie?function(i,o){return Fe.create([i,o],"and")}(n,e):sO(n,e):e instanceof Ie?sO(e,n):function(i,o){if(Y(i.filters.length>0&&o.filters.length>0),fl(i)&&fl(o))return QO(i,o.getFilters());let s=AC(i)?i:o,a=AC(i)?o:i,l=s.filters.map(c=>ET(c,a));return Fe.create(l,"or")}(n,e),Yg(t)}function sO(n,e){if(fl(e))return QO(e,n.getFilters());{let t=e.filters.map(r=>ET(n,r));return Fe.create(t,"or")}}function Yg(n){if(Y(n instanceof Ie||n instanceof Fe),n instanceof Ie)return n;let e=n.getFilters();if(e.length===1)return Yg(e[0]);if(WO(n))return n;let t=e.map(i=>Yg(i)),r=[];return t.forEach(i=>{i instanceof Ie?r.push(i):i instanceof Fe&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Fe.create(r,n.op)}var rD=class{constructor(){this.ln=new Dd}addToCollectionParentIndex(e,t){return this.ln.add(t),M.resolve()}getCollectionParents(e,t){return M.resolve(this.ln.getEntries(t))}addFieldIndex(e,t){return M.resolve()}deleteFieldIndex(e,t){return M.resolve()}deleteAllFieldIndexes(e){return M.resolve()}createTargetIndexes(e,t){return M.resolve()}getDocumentsMatchingTarget(e,t){return M.resolve(null)}getIndexType(e,t){return M.resolve(0)}getFieldIndexes(e,t){return M.resolve([])}getNextCollectionGroupToUpdate(e){return M.resolve(null)}getMinOffset(e,t){return M.resolve(jn.min())}getMinOffsetFromCollectionGroup(e,t){return M.resolve(jn.min())}updateCollectionGroup(e,t,r){return M.resolve()}updateIndexEntries(e,t){return M.resolve()}},Dd=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ve(Me.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ve(Me.comparator)).toArray()}};var Eg=new Uint8Array(0),iD=class{constructor(e,t){this.databaseId=t,this.hn=new Dd,this.Pn=new tr(r=>ps(r),(r,i)=>kd(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.hn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.hn.add(t)});let o={collectionId:r,parent:Ut(i)};return aO(e).put(o)}return M.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[NO(t),""],!1,!0);return aO(e).U(i).next(o=>{for(let s of o){if(s.collectionId!==t)break;r.push(Ir(s.parent))}return r})}addFieldIndex(e,t){let r=td(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(t);delete i.indexId;let o=r.add(i);if(t.indexState){let s=Xa(e);return o.next(a=>{s.put(tO(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){let r=td(e),i=Xa(e),o=Ja(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=td(e),r=Ja(e),i=Xa(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return M.forEach(this.Tn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let o=new Qg(r).cn();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){let r=Ja(e),i=!0,o=new Map;return M.forEach(this.Tn(t),s=>this.In(e,s).next(a=>{i&&(i=!!a),o.set(s,a)})).next(()=>{if(i){let s=fe(),a=[];return M.forEach(o,(l,c)=>{F("IndexedDbIndexManager",`Using index ${function(O){return`id=${O.indexId}|cg=${O.collectionGroup}|f=${O.fields.map(K=>`${K.fieldPath}:${K.kind}`).join(",")}`}(l)} to execute ${ps(t)}`);let d=function(O,K){let ie=wC(K);if(ie===void 0)return null;for(let ee of Ug(O,ie.fieldPath))switch(ee.op){case"array-contains-any":return ee.value.arrayValue.values||[];case"array-contains":return[ee.value]}return null}(c,l),h=function(O,K){let ie=new Map;for(let ee of os(K))for(let I of Ug(O,ee.fieldPath))switch(I.op){case"==":case"in":ie.set(ee.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return ie.set(ee.fieldPath.canonicalString(),I.value),Array.from(ie.values())}return null}(c,l),g=function(O,K){let ie=[],ee=!0;for(let I of os(K)){let _=I.kind===0?Uk(O,I.fieldPath,O.startAt):$k(O,I.fieldPath,O.startAt);ie.push(_.value),ee&&(ee=_.inclusive)}return new Ar(ie,ee)}(c,l),m=function(O,K){let ie=[],ee=!0;for(let I of os(K)){let _=I.kind===0?$k(O,I.fieldPath,O.endAt):Uk(O,I.fieldPath,O.endAt);ie.push(_.value),ee&&(ee=_.inclusive)}return new Ar(ie,ee)}(c,l),v=this.dn(l,c,g),D=this.dn(l,c,m),S=this.En(l,c,h),P=this.An(l.indexId,d,v,g.inclusive,D,m.inclusive,S);return M.forEach(P,j=>r.G(j,t.limit).next(O=>{O.forEach(K=>{let ie=q.fromSegments(K.documentKey);s.has(ie)||(s=s.add(ie),a.push(ie))})}))}).next(()=>a)}return M.resolve(null)})}Tn(e){let t=this.Pn.get(e);return t||(e.filters.length===0?t=[e]:t=S9(Fe.create(e.filters,"and")).map(r=>VC(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Pn.set(e,t),t)}An(e,t,r,i,o,s,a){let l=(t!=null?t.length:1)*Math.max(r.length,o.length),c=l/(t!=null?t.length:1),d=[];for(let h=0;h<l;++h){let g=t?this.Rn(t[h/c]):Eg,m=this.Vn(e,g,r[h%c],i),v=this.mn(e,g,o[h%c],s),D=a.map(S=>this.Vn(e,g,S,!0));d.push(...this.createRange(m,v,D))}return d}Vn(e,t,r,i){let o=new us(e,q.empty(),t,r);return i?o:o.en()}mn(e,t,r,i){let o=new us(e,q.empty(),t,r);return i?o.en():o}In(e,t){let r=new Qg(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let s=null;for(let a of o)r.on(a)&&(!s||a.fields.length>s.fields.length)&&(s=a);return s})}getIndexType(e,t){let r=2,i=this.Tn(t);return M.forEach(i,o=>this.In(e,o).next(s=>{s?r!==0&&s.fields.length<function(l){let c=new Ve(st.comparator),d=!1;for(let h of l.filters)for(let g of h.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?d=!0:c=c.add(g.field));for(let h of l.orderBy)h.field.isKeyField()||(c=c.add(h.field));return c.size+(d?1:0)}(o)&&(r=1):r=0})).next(()=>function(s){return s.limit!==null}(t)&&i.length>1&&r===2?1:r)}fn(e,t){let r=new ls;for(let i of os(e)){let o=t.data.field(i.fieldPath);if(o==null)return null;let s=r.Xt(i.kind);ti.Ft.dt(o,s)}return r.Ht()}Rn(e){let t=new ls;return ti.Ft.dt(e,t.Xt(0)),t.Ht()}gn(e,t){let r=new ls;return ti.Ft.dt(hs(this.databaseId,t),r.Xt(function(o){let s=os(o);return s.length===0?0:s[s.length-1].kind}(e))),r.Ht()}En(e,t,r){if(r===null)return[];let i=[];i.push(new ls);let o=0;for(let s of os(e)){let a=r[o++];for(let l of i)if(this.pn(t,s.fieldPath)&&md(a))i=this.yn(i,s,a);else{let c=l.Xt(s.kind);ti.Ft.dt(a,c)}}return this.wn(i)}dn(e,t,r){return this.En(e,t,r.position)}wn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Ht();return t}yn(e,t,r){let i=[...e],o=[];for(let s of r.arrayValue.values||[])for(let a of i){let l=new ls;l.seed(a.Ht()),ti.Ft.dt(s,l.Xt(t.kind)),o.push(l)}return o}pn(e,t){return!!e.filters.find(r=>r instanceof Ie&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=td(e),i=Xa(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(o=>{let s=[];return M.forEach(o,a=>i.get([a.indexId,this.uid]).next(l=>{s.push(function(d,h){let g=h?new dd(h.sequenceNumber,new jn(ys(h.readTime),new q(Ir(h.documentKey)),h.largestBatchId)):dd.empty(),m=d.fields.map(([v,D])=>new al(st.fromServerFormat(v),D));return new dl(d.indexId,d.collectionGroup,m,g)}(a,l))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:le(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=td(e),o=Xa(e);return this.Sn(e).next(s=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>M.forEach(a,l=>o.put(tO(l.indexId,this.uid,s,r)))))}updateIndexEntries(e,t){let r=new Map;return M.forEach(t,(i,o)=>{let s=r.get(i.collectionGroup);return(s?M.resolve(s):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),M.forEach(a,l=>this.bn(e,i,l).next(c=>{let d=this.Dn(o,l);return c.isEqual(d)?M.resolve():this.vn(e,o,l,c,d)}))))})}Cn(e,t,r,i){return Ja(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.gn(r,t.key),documentKey:t.key.path.toArray()})}Fn(e,t,r,i){return Ja(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.gn(r,t.key),t.key.path.toArray()])}bn(e,t,r){let i=Ja(e),o=new Ve(qi);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.gn(r,t)])},(s,a)=>{o=o.add(new us(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>o)}Dn(e,t){let r=new Ve(qi),i=this.fn(t,e);if(i==null)return r;let o=wC(t);if(o!=null){let s=e.data.field(o.fieldPath);if(md(s))for(let a of s.arrayValue.values||[])r=r.add(new us(t.indexId,e.key,this.Rn(a),i))}else r=r.add(new us(t.indexId,e.key,Eg,i));return r}vn(e,t,r,i,o){F("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let s=[];return function(l,c,d,h,g){let m=l.getIterator(),v=c.getIterator(),D=Za(m),S=Za(v);for(;D||S;){let P=!1,j=!1;if(D&&S){let O=d(D,S);O<0?j=!0:O>0&&(P=!0)}else D!=null?j=!0:P=!0;P?(h(S),S=Za(v)):j?(g(D),D=Za(m)):(D=Za(m),S=Za(v))}}(i,o,qi,a=>{s.push(this.Cn(e,t,r,a))},a=>{s.push(this.Fn(e,t,r,a))}),M.waitFor(s)}Sn(e){let t=1;return Xa(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((s,a)=>qi(s,a)).filter((s,a,l)=>!a||qi(s,l[a-1])!==0);let i=[];i.push(e);for(let s of r){let a=qi(s,e),l=qi(s,t);if(a===0)i[0]=e.en();else if(a>0&&l<0)i.push(s),i.push(s.en());else if(l>0)break}i.push(t);let o=[];for(let s=0;s<i.length;s+=2){if(this.Mn(i[s],i[s+1]))return[];let a=[i[s].indexId,this.uid,i[s].arrayValue,i[s].directionalValue,Eg,[]],l=[i[s+1].indexId,this.uid,i[s+1].arrayValue,i[s+1].directionalValue,Eg,[]];o.push(IDBKeyRange.bound(a,l))}return o}Mn(e,t){return qi(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(lO)}getMinOffset(e,t){return M.mapArray(this.Tn(t),r=>this.In(e,r).next(i=>i||W())).next(lO)}};function aO(n){return wt(n,"collectionParents")}function Ja(n){return wt(n,"indexEntries")}function td(n){return wt(n,"indexConfiguration")}function Xa(n){return wt(n,"indexState")}function lO(n){Y(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;hT(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new jn(e.readTime,e.documentKey,t)}var uO={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ln=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};function x1(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),o=[],s=IDBKeyRange.only(t.batchId),a=0,l=r.J({range:s},(d,h,g)=>(a++,g.delete()));o.push(l.next(()=>{Y(a===1)}));let c=[];for(let d of t.mutations){let h=LO(e,d.key.path,t.batchId);o.push(i.delete(h)),c.push(d.key)}return M.waitFor(o).next(()=>c)}function Zg(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw W();e=n.noDocument}return JSON.stringify(e).length}ln.DEFAULT_COLLECTION_PERCENTILE=10,ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ln.DEFAULT=new ln(41943040,ln.DEFAULT_COLLECTION_PERCENTILE,ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ln.DISABLED=new ln(-1,0,0);var Jg=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.xn={}}static Pt(e,t,r,i){Y(e.uid!=="");let o=e.isAuthenticated()?e.uid:"";return new n(o,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Gi(e).J({index:"userMutationsIndex",range:r},(i,o,s)=>{t=!1,s.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let o=ol(e),s=Gi(e);return s.add({}).next(a=>{Y(typeof a=="number");let l=new _d(a,t,r,i),c=function(m,v,D){let S=D.baseMutations.map(j=>Cd(m.ht,j)),P=D.mutations.map(j=>Cd(m.ht,j));return{userId:v,batchId:D.batchId,localWriteTimeMs:D.localWriteTime.toMillis(),baseMutations:S,mutations:P}}(this.serializer,this.userId,l),d=[],h=new Ve((g,m)=>le(g.canonicalString(),m.canonicalString()));for(let g of i){let m=LO(this.userId,g.key.path,a);h=h.add(g.key.path.popLast()),d.push(s.put(c)),d.push(o.put(m,P3))}return h.forEach(g=>{d.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.xn[a]=l.keys()}),M.waitFor(d).next(()=>l)})}lookupMutationBatch(e,t){return Gi(e).get(t).next(r=>r?(Y(r.userId===this.userId),as(this.serializer,r)):null)}On(e,t){return this.xn[t]?M.resolve(this.xn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.xn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Gi(e).J({index:"userMutationsIndex",range:i},(s,a,l)=>{a.userId===this.userId&&(Y(a.batchId>=r),o=as(this.serializer,a)),l.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Gi(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,o,s)=>{r=o.batchId,s.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Gi(e).U("userMutationsIndex",t).next(r=>r.map(i=>as(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=Tg(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return ol(e).J({range:i},(s,a,l)=>{let[c,d,h]=s,g=Ir(d);if(c===this.userId&&t.path.isEqual(g))return Gi(e).get(h).next(m=>{if(!m)throw W();Y(m.userId===this.userId),o.push(as(this.serializer,m))});l.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ve(le),i=[];return t.forEach(o=>{let s=Tg(this.userId,o.path),a=IDBKeyRange.lowerBound(s),l=ol(e).J({range:a},(c,d,h)=>{let[g,m,v]=c,D=Ir(m);g===this.userId&&o.path.isEqual(D)?r=r.add(v):h.done()});i.push(l)}),M.waitFor(i).next(()=>this.Nn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=Tg(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Ve(le);return ol(e).J({range:s},(l,c,d)=>{let[h,g,m]=l,v=Ir(g);h===this.userId&&r.isPrefixOf(v)?v.length===i&&(a=a.add(m)):d.done()}).next(()=>this.Nn(e,a))}Nn(e,t){let r=[],i=[];return t.forEach(o=>{i.push(Gi(e).get(o).next(s=>{if(s===null)throw W();Y(s.userId===this.userId),r.push(as(this.serializer,s))}))}),M.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return x1(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Bn(t.batchId)}),M.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Bn(e){delete this.xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return M.resolve();let r=IDBKeyRange.lowerBound(function(s){return[s]}(this.userId)),i=[];return ol(e).J({range:r},(o,s,a)=>{if(o[0]===this.userId){let l=Ir(o[1]);i.push(l)}else a.done()}).next(()=>{Y(i.length===0)})})}containsKey(e,t){return N1(e,this.userId,t)}Ln(e){return P1(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function N1(n,e,t){let r=Tg(e,t.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return ol(n).J({range:o,H:!0},(a,l,c)=>{let[d,h,g]=a;d===e&&h===i&&(s=!0),c.done()}).next(()=>s)}function Gi(n){return wt(n,"mutations")}function ol(n){return wt(n,"documentMutations")}function P1(n){return wt(n,"mutationQueues")}var _l=class n{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new n(0)}static Qn(){return new n(-1)}};var oD=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Kn(e).next(t=>{let r=new _l(t.highestTargetId);return t.highestTargetId=r.next(),this.$n(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Kn(e).next(t=>X.fromTimestamp(new Je(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Kn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Kn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.$n(e,i)))}addTargetData(e,t){return this.Un(e,t).next(()=>this.Kn(e).next(r=>(r.targetCount+=1,this.Wn(t,r),this.$n(e,r))))}updateTargetData(e,t){return this.Un(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>el(e).delete(t.targetId)).next(()=>this.Kn(e)).next(r=>(Y(r.targetCount>0),r.targetCount-=1,this.$n(e,r)))}removeTargets(e,t,r){let i=0,o=[];return el(e).J((s,a)=>{let l=od(a);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(i++,o.push(this.removeTargetData(e,l)))}).next(()=>M.waitFor(o)).next(()=>i)}forEachTarget(e,t){return el(e).J((r,i)=>{let o=od(i);t(o)})}Kn(e){return cO(e).get("targetGlobalKey").next(t=>(Y(t!==null),t))}$n(e,t){return cO(e).put("targetGlobalKey",t)}Un(e,t){return el(e).put(A1(this.serializer,t))}Wn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Kn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=ps(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return el(e).J({range:i,index:"queryTargetsIndex"},(s,a,l)=>{let c=od(a);kd(t,c.target)&&(o=c,l.done())}).next(()=>o)}addMatchingKeys(e,t,r){let i=[],o=zi(e);return t.forEach(s=>{let a=Ut(s.path);i.push(o.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,s))}),M.waitFor(i)}removeMatchingKeys(e,t,r){let i=zi(e);return M.forEach(t,o=>{let s=Ut(o.path);return M.waitFor([i.delete([r,s]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,t){let r=zi(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=zi(e),o=fe();return i.J({range:r,H:!0},(s,a,l)=>{let c=Ir(s[1]),d=new q(c);o=o.add(d)}).next(()=>o)}containsKey(e,t){let r=Ut(t.path),i=IDBKeyRange.bound([r],[NO(r)],!1,!0),o=0;return zi(e).J({index:"documentTargetsIndex",H:!0,range:i},([s,a],l,c)=>{s!==0&&(o++,c.done())}).next(()=>o>0)}ut(e,t){return el(e).get(t).next(r=>r?od(r):null)}};function el(n){return wt(n,"targets")}function cO(n){return wt(n,"targetGlobal")}function zi(n){return wt(n,"targetDocuments")}function dO([n,e],[t,r]){let i=le(n,t);return i===0?le(e,r):i}var sD=class{constructor(e){this.Gn=e,this.buffer=new Ve(dO),this.zn=0}jn(){return++this.zn}Hn(e){let t=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();dO(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Xg=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return this.Jn!==null}Yn(e){F("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>x(this,null,function*(){this.Jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){ao(t)?F("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield so(t)}yield this.Yn(3e5)}))}},aD=class{constructor(e,t){this.Zn=e,this.params=t}calculateTargetCount(e,t){return this.Zn.Xn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return M.resolve(Cn.oe);let r=new sD(t);return this.Zn.forEachTarget(e,i=>r.Hn(i.sequenceNumber)).next(()=>this.Zn.er(e,i=>r.Hn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Zn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Zn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(F("LruGarbageCollector","Garbage collection skipped; disabled"),M.resolve(uO)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(F("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),uO):this.tr(e,t))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,t){let r,i,o,s,a,l,c,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(F("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,s=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(o=h,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(c=Date.now(),tl()<=bn.DEBUG&&F("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-d}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),M.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:h})))}};function k1(n,e){return new aD(n,e)}var lD=class{constructor(e,t){this.db=e,this.garbageCollector=k1(this,t)}Xn(e){let t=this.nr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}nr(e){let t=0;return this.er(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}er(e,t){return this.rr(e,(r,i)=>t(i))}addReference(e,t,r){return Ig(e,r)}removeReference(e,t,r){return Ig(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Ig(e,t)}ir(e,t){return function(i,o){let s=!1;return P1(i).Y(a=>N1(i,a,o).next(l=>(l&&(s=!0),M.resolve(!l)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.rr(e,(s,a)=>{if(a<=t){let l=this.ir(e,s).next(c=>{if(!c)return o++,r.getEntry(e,s).next(()=>(r.removeEntry(s,X.min()),zi(e).delete(function(h){return[0,Ut(h.path)]}(s))))});i.push(l)}}).next(()=>M.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Ig(e,t)}rr(e,t){let r=zi(e),i,o=Cn.oe;return r.J({index:"documentTargetsIndex"},([s,a],{path:l,sequenceNumber:c})=>{s===0?(o!==Cn.oe&&t(new q(Ir(i)),o),o=c,i=l):o=Cn.oe}).next(()=>{o!==Cn.oe&&t(new q(Ir(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Ig(n,e){return zi(n).put(function(r,i){return{targetId:0,path:Ut(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var em=class{constructor(){this.changes=new tr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,pt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?M.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var uD=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return is(e).put(r)}removeEntry(e,t,r){return is(e).delete(function(o,s){let a=o.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Wg(s),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.sr(e,r)))}getEntry(e,t){let r=pt.newInvalidDocument(t);return is(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(nd(t))},(i,o)=>{r=this._r(t,o)}).next(()=>r)}ar(e,t){let r={size:0,document:pt.newInvalidDocument(t)};return is(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(nd(t))},(i,o)=>{r={document:this._r(t,o),size:Zg(o)}}).next(()=>r)}getEntries(e,t){let r=un();return this.ur(e,t,(i,o)=>{let s=this._r(i,o);r=r.insert(i,s)}).next(()=>r)}cr(e,t){let r=un(),i=new We(q.comparator);return this.ur(e,t,(o,s)=>{let a=this._r(o,s);r=r.insert(o,a),i=i.insert(o,Zg(s))}).next(()=>({documents:r,lr:i}))}ur(e,t,r){if(t.isEmpty())return M.resolve();let i=new Ve(pO);t.forEach(l=>i=i.add(l));let o=IDBKeyRange.bound(nd(i.first()),nd(i.last())),s=i.getIterator(),a=s.getNext();return is(e).J({index:"documentKeyIndex",range:o},(l,c,d)=>{let h=q.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&pO(a,h)<0;)r(a,null),a=s.getNext();a&&a.isEqual(h)&&(r(a,c),a=s.hasNext()?s.getNext():null),a?d.$(nd(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,o){let s=t.path,a=[s.popLast().toArray(),s.lastSegment(),Wg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return is(e).U(IDBKeyRange.bound(a,l,!0)).next(c=>{o?.incrementDocumentReadCount(c.length);let d=un();for(let h of c){let g=this._r(q.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);g.isFoundDocument()&&(Fd(t,g)||i.has(g.key))&&(d=d.insert(g.key,g))}return d})}getAllFromCollectionGroup(e,t,r,i){let o=un(),s=fO(t,r),a=fO(t,jn.max());return is(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,a,!0)},(l,c,d)=>{let h=this._r(q.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);o=o.insert(h.key,h),o.size===i&&d.done()}).next(()=>o)}newChangeBuffer(e){return new cD(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return hO(e).get("remoteDocumentGlobalKey").next(t=>(Y(!!t),t))}sr(e,t){return hO(e).put("remoteDocumentGlobalKey",t)}_r(e,t){if(t){let r=T9(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(X.min())))return r}return pt.newInvalidDocument(e)}};function O1(n){return new uD(n)}var cD=class extends em{constructor(e,t){super(),this.hr=e,this.trackRemovals=t,this.Pr=new tr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Ve((o,s)=>le(o.canonicalString(),s.canonicalString()));return this.changes.forEach((o,s)=>{let a=this.Pr.get(o);if(t.push(this.hr.removeEntry(e,o,a.readTime)),s.isValidDocument()){let l=Xk(this.hr.serializer,s);i=i.add(o.path.popLast());let c=Zg(l);r+=c-a.size,t.push(this.hr.addEntry(e,o,l))}else if(r-=a.size,this.trackRemovals){let l=Xk(this.hr.serializer,s.convertToNoDocument(X.min()));t.push(this.hr.addEntry(e,o,l))}}),i.forEach(o=>{t.push(this.hr.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.hr.updateMetadata(e,r)),M.waitFor(t)}getFromCache(e,t){return this.hr.ar(e,t).next(r=>(this.Pr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.hr.cr(e,t).next(({documents:r,lr:i})=>(i.forEach((o,s)=>{this.Pr.set(o,{size:s,readTime:r.get(o).readTime})}),r))}};function hO(n){return wt(n,"remoteDocumentGlobal")}function is(n){return wt(n,"remoteDocumentsV14")}function nd(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function fO(n,e){let t=e.documentKey.path.toArray();return[n,Wg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function pO(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let o=0;o<t.length-2&&o<r.length-2;++o)if(i=le(t[o],r[o]),i)return i;return i=le(t.length,r.length),i||(i=le(t[t.length-2],r[r.length-2]),i||le(t[t.length-1],r[r.length-1]))}var dD=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var tm=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&ld(r.mutation,i,Dn.empty(),Je.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,fe()).next(()=>r))}getLocalViewOfDocuments(e,t,r=fe()){let i=Cr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let s=id();return o.forEach((a,l)=>{s=s.insert(a,l.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let r=Cr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,fe()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,r,i){let o=un(),s=ad(),a=function(){return ad()}();return t.forEach((l,c)=>{let d=r.get(c.key);i.has(c.key)&&(d===void 0||d.mutation instanceof nr)?o=o.insert(c.key,c):d!==void 0?(s.set(c.key,d.mutation.getFieldMask()),ld(d.mutation,c,d.mutation.getFieldMask(),Je.now())):s.set(c.key,Dn.empty())}),this.recalculateAndSaveOverlays(e,o).next(l=>(l.forEach((c,d)=>s.set(c,d)),t.forEach((c,d)=>{var h;return a.set(c,new dD(d,(h=s.get(c))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){let r=ad(),i=new We((s,a)=>s-a),o=fe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(l=>{let c=t.get(l);if(c===null)return;let d=r.get(l)||Dn.empty();d=a.applyToLocalView(c,d),r.set(l,d);let h=(i.get(a.batchId)||fe()).add(l);i=i.insert(a.batchId,h)})}).next(()=>{let s=[],a=i.getReverseIterator();for(;a.hasNext();){let l=a.getNext(),c=l.key,d=l.value,h=i1();d.forEach(g=>{if(!o.has(g)){let m=d1(t.get(g),r.get(g));m!==null&&h.set(g,m),o=o.add(g)}}),s.push(this.documentOverlayCache.saveOverlays(e,c,h))}return M.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(s){return q.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):mT(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):M.resolve(Cr()),a=-1,l=o;return s.next(c=>M.forEach(c,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),o.get(d)?M.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{l=l.insert(d,g)}))).next(()=>this.populateOverlays(e,c,o)).next(()=>this.computeViews(e,l,c,fe())).next(d=>({batchId:a,changes:r1(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new q(t)).next(r=>{let i=id();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,s=id();return this.indexManager.getCollectionParents(e,o).next(a=>M.forEach(a,l=>{let c=function(h,g){return new er(g,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,l.child(o));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(d=>{d.forEach((h,g)=>{s=s.insert(h,g)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(s=>{o.forEach((l,c)=>{let d=c.getKey();s.get(d)===null&&(s=s.insert(d,pt.newInvalidDocument(d)))});let a=id();return s.forEach((l,c)=>{let d=o.get(l);d!==void 0&&ld(d.mutation,c,Dn.empty(),Je.now()),Fd(t,c)&&(a=a.insert(l,c))}),a})}};var hD=class{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,t){return M.resolve(this.Tr.get(t))}saveBundleMetadata(e,t){return this.Tr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:at(i.createTime)}}(t)),M.resolve()}getNamedQuery(e,t){return M.resolve(this.Ir.get(t))}saveNamedQuery(e,t){return this.Ir.set(t.name,function(i){return{name:i.name,query:wT(i.bundledQuery),readTime:at(i.readTime)}}(t)),M.resolve()}};var fD=class{constructor(){this.overlays=new We(q.comparator),this.dr=new Map}getOverlay(e,t){return M.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Cr();return M.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.Tt(e,t,o)}),M.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.dr.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.dr.delete(r)),M.resolve()}getOverlaysForCollection(e,t,r){let i=Cr(),o=t.length+1,s=new q(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===o&&l.largestBatchId>r&&i.set(l.getKey(),l)}return M.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new We((c,d)=>c-d),s=this.overlays.getIterator();for(;s.hasNext();){let c=s.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let d=o.get(c.largestBatchId);d===null&&(d=Cr(),o=o.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}let a=Cr(),l=o.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=i)););return M.resolve(a)}Tt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let s=this.dr.get(i.largestBatchId).delete(r.key);this.dr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new vd(t,r));let o=this.dr.get(t);o===void 0&&(o=fe(),this.dr.set(t,o)),this.dr.set(t,o.add(r.key))}};var pD=class{constructor(){this.sessionToken=lt.EMPTY_BYTE_STRING}getSessionToken(e){return M.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,M.resolve()}};var Td=class{constructor(){this.Er=new Ve(ht.Ar),this.Rr=new Ve(ht.Vr)}isEmpty(){return this.Er.isEmpty()}addReference(e,t){let r=new ht(e,t);this.Er=this.Er.add(r),this.Rr=this.Rr.add(r)}mr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.gr(new ht(e,t))}pr(e,t){e.forEach(r=>this.removeReference(r,t))}yr(e){let t=new q(new Me([])),r=new ht(t,e),i=new ht(t,e+1),o=[];return this.Rr.forEachInRange([r,i],s=>{this.gr(s),o.push(s.key)}),o}wr(){this.Er.forEach(e=>this.gr(e))}gr(e){this.Er=this.Er.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){let t=new q(new Me([])),r=new ht(t,e),i=new ht(t,e+1),o=fe();return this.Rr.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new ht(e,0),r=this.Er.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},ht=class{constructor(e,t){this.key=e,this.br=t}static Ar(e,t){return q.comparator(e.key,t.key)||le(e.br,t.br)}static Vr(e,t){return le(e.br,t.br)||q.comparator(e.key,t.key)}};var gD=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Dr=1,this.vr=new Ve(ht.Ar)}checkEmpty(e){return M.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new _d(o,t,r,i);this.mutationQueue.push(s);for(let a of i)this.vr=this.vr.add(new ht(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return M.resolve(s)}lookupMutationBatch(e,t){return M.resolve(this.Cr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Fr(r),o=i<0?0:i;return M.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return M.resolve(this.mutationQueue.length===0?-1:this.Dr-1)}getAllMutationBatches(e){return M.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new ht(t,0),i=new ht(t,Number.POSITIVE_INFINITY),o=[];return this.vr.forEachInRange([r,i],s=>{let a=this.Cr(s.br);o.push(a)}),M.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ve(le);return t.forEach(i=>{let o=new ht(i,0),s=new ht(i,Number.POSITIVE_INFINITY);this.vr.forEachInRange([o,s],a=>{r=r.add(a.br)})}),M.resolve(this.Mr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;q.isDocumentKey(o)||(o=o.child(""));let s=new ht(new q(o),0),a=new Ve(le);return this.vr.forEachWhile(l=>{let c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.br)),!0)},s),M.resolve(this.Mr(a))}Mr(e){let t=[];return e.forEach(r=>{let i=this.Cr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Y(this.Or(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.vr;return M.forEach(t.mutations,i=>{let o=new ht(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.vr=r})}Bn(e){}containsKey(e,t){let r=new ht(t,0),i=this.vr.firstAfterOrEqual(r);return M.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,M.resolve()}Or(e,t){return this.Fr(e)}Fr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Cr(e){let t=this.Fr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var mD=class{constructor(e){this.Nr=e,this.docs=function(){return new We(q.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.Nr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return M.resolve(r?r.document.mutableCopy():pt.newInvalidDocument(t))}getEntries(e,t){let r=un();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():pt.newInvalidDocument(i))}),M.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=un(),s=t.path,a=new q(s.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){let{key:c,value:{document:d}}=l.getNext();if(!s.isPrefixOf(c.path))break;c.path.length>s.length+1||hT(kO(d),r)<=0||(i.has(d.key)||Fd(t,d))&&(o=o.insert(d.key,d.mutableCopy()))}return M.resolve(o)}getAllFromCollectionGroup(e,t,r,i){W()}Br(e,t){return M.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new yD(this)}getSize(e){return M.resolve(this.size)}},yD=class extends em{constructor(e){super(),this.hr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.hr.addEntry(e,i)):this.hr.removeEntry(r)}),M.waitFor(t)}getFromCache(e,t){return this.hr.getEntry(e,t)}getAllFromCache(e,t){return this.hr.getEntries(e,t)}};var _D=class{constructor(e){this.persistence=e,this.Lr=new tr(t=>ps(t),kd),this.lastRemoteSnapshotVersion=X.min(),this.highestTargetId=0,this.kr=0,this.qr=new Td,this.targetCount=0,this.Qr=_l.qn()}forEachTarget(e,t){return this.Lr.forEach((r,i)=>t(i)),M.resolve()}getLastRemoteSnapshotVersion(e){return M.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return M.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),M.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.kr&&(this.kr=t),M.resolve()}Un(e){this.Lr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Qr=new _l(t),this.highestTargetId=t),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,t){return this.Un(t),this.targetCount+=1,M.resolve()}updateTargetData(e,t){return this.Un(t),M.resolve()}removeTargetData(e,t){return this.Lr.delete(t.target),this.qr.yr(t.targetId),this.targetCount-=1,M.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Lr.forEach((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Lr.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),M.waitFor(o).next(()=>i)}getTargetCount(e){return M.resolve(this.targetCount)}getTargetData(e,t){let r=this.Lr.get(t)||null;return M.resolve(r)}addMatchingKeys(e,t,r){return this.qr.mr(t,r),M.resolve()}removeMatchingKeys(e,t,r){this.qr.pr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),M.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.qr.yr(t),M.resolve()}getMatchingKeysForTargetId(e,t){let r=this.qr.Sr(t);return M.resolve(r)}containsKey(e,t){return M.resolve(this.qr.containsKey(t))}};var bd=class{constructor(e,t){this.Kr={},this.overlays={},this.$r=new Cn(0),this.Ur=!1,this.Ur=!0,this.Wr=new pD,this.referenceDelegate=e(this),this.Gr=new _D(this),this.indexManager=new rD,this.remoteDocumentCache=function(i){return new mD(i)}(r=>this.referenceDelegate.zr(r)),this.serializer=new zg(t),this.jr=new hD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new fD,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Kr[e.toKey()];return r||(r=new gD(t,this.referenceDelegate),this.Kr[e.toKey()]=r),r}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,t,r){F("MemoryPersistence","Starting transaction:",e);let i=new vD(this.$r.next());return this.referenceDelegate.Hr(),r(i).next(o=>this.referenceDelegate.Jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Yr(e,t){return M.or(Object.values(this.Kr).map(r=>()=>r.containsKey(e,t)))}},vD=class extends kg{constructor(e){super(),this.currentSequenceNumber=e}},nm=class n{constructor(e){this.persistence=e,this.Zr=new Td,this.Xr=null}static ei(e){return new n(e)}get ti(){if(this.Xr)return this.Xr;throw W()}addReference(e,t,r){return this.Zr.addReference(r,t),this.ti.delete(r.toString()),M.resolve()}removeReference(e,t,r){return this.Zr.removeReference(r,t),this.ti.add(r.toString()),M.resolve()}markPotentiallyOrphaned(e,t){return this.ti.add(t.toString()),M.resolve()}removeTarget(e,t){this.Zr.yr(t.targetId).forEach(i=>this.ti.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.ti.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}Hr(){this.Xr=new Set}Jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return M.forEach(this.ti,r=>{let i=q.fromPath(r);return this.ni(e,i).next(o=>{o||t.removeEntry(i,X.min())})}).next(()=>(this.Xr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ni(e,t).next(r=>{r?this.ti.delete(t.toString()):this.ti.add(t.toString())})}zr(e){return 0}ni(e,t){return M.or([()=>M.resolve(this.Zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Yr(e,t)])}},rm=class n{constructor(e,t){this.persistence=e,this.ri=new tr(r=>Ut(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=k1(this,t)}static ei(e,t){return new n(e,t)}Hr(){}Jr(e){return M.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Xn(e){let t=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}nr(e){let t=0;return this.er(e,r=>{t++}).next(()=>t)}er(e,t){return M.forEach(this.ri,(r,i)=>this.ir(e,r,i).next(o=>o?M.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.Br(e,s=>this.ir(e,s,t).next(a=>{a||(r++,o.removeEntry(s,X.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.ri.set(t,e.currentSequenceNumber),M.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.ri.set(r,e.currentSequenceNumber),M.resolve()}removeReference(e,t,r){return this.ri.set(r,e.currentSequenceNumber),M.resolve()}updateLimboDocument(e,t){return this.ri.set(t,e.currentSequenceNumber),M.resolve()}zr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Sg(e.data.value)),t}ir(e,t,r){return M.or([()=>this.persistence.Yr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.ri.get(t);return M.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var wD=class{constructor(e){this.serializer=e}O(e,t,r,i){let o=new Og("createOrUpgrade",t);r<1&&i>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",xk,{unique:!0}),l.createObjectStore("documentMutations")}(e),gO(e),function(l){l.createObjectStore("remoteDocuments")}(e));let s=M.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),gO(e)),s=s.next(()=>function(l){let c=l.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:X.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",d)}(o))),r<4&&i>=4&&(r!==0&&(s=s.next(()=>function(l,c){return c.store("mutations").U().next(d=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",xk,{unique:!0});let h=c.store("mutations"),g=d.map(m=>h.put(m));return M.waitFor(g)})}(e,o))),s=s.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(s=s.next(()=>this.ii(o))),r<6&&i>=6&&(s=s.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.si(o)))),r<7&&i>=7&&(s=s.next(()=>this.oi(o))),r<8&&i>=8&&(s=s.next(()=>this._i(e,o))),r<9&&i>=9&&(s=s.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(s=s.next(()=>this.ai(o))),r<11&&i>=11&&(s=s.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(s=s.next(()=>{(function(l){let c=l.createObjectStore("documentOverlays",{keyPath:G3});c.createIndex("collectionPathOverlayIndex",z3,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",W3,{unique:!1})})(e)})),r<13&&i>=13&&(s=s.next(()=>function(l){let c=l.createObjectStore("remoteDocumentsV14",{keyPath:k3});c.createIndex("documentKeyIndex",O3),c.createIndex("collectionGroupIndex",F3)}(e)).next(()=>this.ui(e,o)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(s=s.next(()=>this.ci(e,o))),r<15&&i>=15&&(s=s.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:U3}).createIndex("sequenceNumberIndex",$3,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:H3}).createIndex("documentKeyIndex",q3,{unique:!1})}(e))),r<16&&i>=16&&(s=s.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(s=s.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),s}si(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=Zg(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ii(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>M.forEach(i,o=>{let s=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",s).next(a=>M.forEach(a,l=>{Y(l.userId===o.userId);let c=as(this.serializer,l);return x1(e,o.userId,c).next(()=>{})}))}))}oi(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let o=[];return r.J((s,a)=>{let l=new Me(s),c=function(h){return[0,Ut(h)]}(l);o.push(t.get(c).next(d=>d?M.resolve():(h=>t.put({targetId:0,path:Ut(h),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>M.waitFor(o))})}_i(e,t){e.createObjectStore("collectionParents",{keyPath:B3});let r=t.store("collectionParents"),i=new Dd,o=s=>{if(i.add(s)){let a=s.lastSegment(),l=s.popLast();return r.put({collectionId:a,parent:Ut(l)})}};return t.store("remoteDocuments").J({H:!0},(s,a)=>{let l=new Me(s);return o(l.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([s,a,l],c)=>{let d=Ir(a);return o(d.popLast())}))}ai(e){let t=e.store("targets");return t.J((r,i)=>{let o=od(i),s=A1(this.serializer,o);return t.put(s)})}ui(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((o,s)=>{let a=t.store("remoteDocumentsV14"),l=function(h){return h.document?new q(Me.fromString(h.document.name).popFirst(5)):h.noDocument?q.fromSegments(h.noDocument.path):h.unknownDocument?q.fromSegments(h.unknownDocument.path):W()}(s).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:s.readTime||[0,0],unknownDocument:s.unknownDocument,noDocument:s.noDocument,document:s.document,hasCommittedMutations:!!s.hasCommittedMutations};i.push(a.put(c))}).next(()=>M.waitFor(i))}ci(e,t){let r=t.store("mutations"),i=O1(this.serializer),o=new bd(nm.ei,this.serializer.ht);return r.U().next(s=>{let a=new Map;return s.forEach(l=>{var c;let d=(c=a.get(l.userId))!==null&&c!==void 0?c:fe();as(this.serializer,l).keys().forEach(h=>d=d.add(h)),a.set(l.userId,d)}),M.forEach(a,(l,c)=>{let d=new ft(c),h=Kg.Pt(this.serializer,d),g=o.getIndexManager(d),m=Jg.Pt(d,this.serializer,g,o.referenceDelegate);return new tm(i,m,h,g).recalculateAndSaveOverlaysForDocumentKeys(new fd(t,Cn.oe),l).next()})})}};function gO(n){n.createObjectStore("targetDocuments",{keyPath:L3}).createIndex("documentTargetsIndex",j3,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",V3,{unique:!0}),n.createObjectStore("targetGlobal")}var uC="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ED=class n{constructor(e,t,r,i,o,s,a,l,c,d,h=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.li=o,this.window=s,this.document=a,this.hi=c,this.Pi=d,this.Ti=h,this.$r=null,this.Ur=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ii=null,this.inForeground=!1,this.di=null,this.Ei=null,this.Ai=Number.NEGATIVE_INFINITY,this.Ri=g=>Promise.resolve(),!n.p())throw new k(N.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new lD(this,i),this.Vi=t+"main",this.serializer=new zg(l),this.mi=new Zi(this.Vi,this.Ti,new wD(this.serializer)),this.Wr=new YC,this.Gr=new oD(this.referenceDelegate,this.serializer),this.remoteDocumentCache=O1(this.serializer),this.jr=new QC,this.window&&this.window.localStorage?this.fi=this.window.localStorage:(this.fi=null,d===!1&&ot("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new k(N.FAILED_PRECONDITION,uC);return this.pi(),this.yi(),this.wi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Gr.getHighestSequenceNumber(e))}).then(e=>{this.$r=new Cn(e,this.hi)}).then(()=>{this.Ur=!0}).catch(e=>(this.mi&&this.mi.close(),Promise.reject(e)))}Si(e){return this.Ri=t=>x(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.mi.B(t=>x(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.li.enqueueAndForget(()=>x(this,null,function*(){this.started&&(yield this.gi())})))}gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Cg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.bi(e).next(t=>{t||(this.isPrimary=!1,this.li.enqueueRetryable(()=>this.Ri(!1)))})}).next(()=>this.Di(e)).next(t=>this.isPrimary&&!t?this.vi(e).next(()=>!1):!!t&&this.Ci(e).next(()=>!0))).catch(e=>{if(ao(e))return F("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return F("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.li.enqueueRetryable(()=>this.Ri(e)),this.isPrimary=e})}bi(e){return rd(e).get("owner").next(t=>M.resolve(this.Fi(t)))}Mi(e){return Cg(e).delete(this.clientId)}xi(){return x(this,null,function*(){if(this.isPrimary&&!this.Oi(this.Ai,18e5)){this.Ai=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=wt(t,"clientMetadata");return r.U().next(i=>{let o=this.Ni(i,18e5),s=i.filter(a=>o.indexOf(a)===-1);return M.forEach(s,a=>r.delete(a.clientId)).next(()=>s)})}).catch(()=>[]);if(this.fi)for(let t of e)this.fi.removeItem(this.Bi(t.clientId))}})}wi(){this.Ei=this.li.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.gi().then(()=>this.xi()).then(()=>this.wi()))}Fi(e){return!!e&&e.ownerId===this.clientId}Di(e){return this.Pi?M.resolve(!0):rd(e).get("owner").next(t=>{if(t!==null&&this.Oi(t.leaseTimestampMs,5e3)&&!this.Li(t.ownerId)){if(this.Fi(t)&&this.networkEnabled)return!0;if(!this.Fi(t)){if(!t.allowTabSynchronization)throw new k(N.FAILED_PRECONDITION,uC);return!1}}return!(!this.networkEnabled||!this.inForeground)||Cg(e).U().next(r=>this.Ni(r,5e3).find(i=>{if(this.clientId!==i.clientId){let o=!this.networkEnabled&&i.networkEnabled,s=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(o||s&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&F("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return x(this,null,function*(){this.Ur=!1,this.ki(),this.Ei&&(this.Ei.cancel(),this.Ei=null),this.qi(),this.Qi(),yield this.mi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new fd(e,Cn.oe);return this.vi(t).next(()=>this.Mi(t))}),this.mi.close(),this.Ki()})}Ni(e,t){return e.filter(r=>this.Oi(r.updateTimeMs,t)&&!this.Li(r.clientId))}$i(){return this.runTransaction("getActiveClients","readonly",e=>Cg(e).U().next(t=>this.Ni(t,18e5).map(r=>r.clientId)))}get started(){return this.Ur}getGlobalsCache(){return this.Wr}getMutationQueue(e,t){return Jg.Pt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new iD(e,this.serializer.ht.databaseId)}getDocumentOverlayCache(e){return Kg.Pt(this.serializer,e)}getBundleCache(){return this.jr}runTransaction(e,t,r){F("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",o=function(l){return l===17?Y3:l===16?Q3:l===15?pT:l===14?UO:l===13?BO:l===12?K3:l===11?jO:void W()}(this.Ti),s;return this.mi.runTransaction(e,i,o,a=>(s=new fd(a,this.$r?this.$r.next():Cn.oe),t==="readwrite-primary"?this.bi(s).next(l=>!!l||this.Di(s)).next(l=>{if(!l)throw ot(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.li.enqueueRetryable(()=>this.Ri(!1)),new k(N.FAILED_PRECONDITION,OO);return r(s)}).next(l=>this.Ci(s).next(()=>l)):this.Ui(s).next(()=>r(s)))).then(a=>(s.raiseOnCommittedEvent(),a))}Ui(e){return rd(e).get("owner").next(t=>{if(t!==null&&this.Oi(t.leaseTimestampMs,5e3)&&!this.Li(t.ownerId)&&!this.Fi(t)&&!(this.Pi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new k(N.FAILED_PRECONDITION,uC)})}Ci(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return rd(e).put("owner",t)}static p(){return Zi.p()}vi(e){let t=rd(e);return t.get("owner").next(r=>this.Fi(r)?(F("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):M.resolve())}Oi(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(ot(`Detected an update time that is in the future: ${e} > ${r}`),!1))}pi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.di=()=>{this.li.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.gi()))},this.document.addEventListener("visibilitychange",this.di),this.inForeground=this.document.visibilityState==="visible")}qi(){this.di&&(this.document.removeEventListener("visibilitychange",this.di),this.di=null)}yi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Ii=()=>{this.ki();let t=/(?:Version|Mobile)\/1[456]/;vy()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.li.enterRestrictedMode(!0),this.li.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ii))}Qi(){this.Ii&&(this.window.removeEventListener("pagehide",this.Ii),this.Ii=null)}Li(e){var t;try{let r=((t=this.fi)===null||t===void 0?void 0:t.getItem(this.Bi(e)))!==null;return F("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ot("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}ki(){if(this.fi)try{this.fi.setItem(this.Bi(this.clientId),String(Date.now()))}catch(e){ot("Failed to set zombie client id.",e)}}Ki(){if(this.fi)try{this.fi.removeItem(this.Bi(this.clientId))}catch{}}Bi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function rd(n){return wt(n,"owner")}function Cg(n){return wt(n,"clientMetadata")}function IT(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var ID=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Wi=r,this.Gi=i}static zi(e,t){let r=fe(),i=fe();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var CD=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var im=class{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=function(){return vy()?8:FO(nu())>0?6:4}()}initialize(e,t){this.Zi=e,this.indexManager=t,this.ji=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Xi(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.es(e,t,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new CD;return this.ts(e,t,s).next(a=>{if(o.result=a,this.Hi)return this.ns(e,t,s,a.size)})}).next(()=>o.result)}ns(e,t,r,i){return r.documentReadCount<this.Ji?(tl()<=bn.DEBUG&&F("QueryEngine","SDK will not create cache indexes for query:",nl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),M.resolve()):(tl()<=bn.DEBUG&&F("QueryEngine","Query:",nl(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Yi*i?(tl()<=bn.DEBUG&&F("QueryEngine","The SDK decides to create cache indexes for query:",nl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Xt(t))):M.resolve())}Xi(e,t){if(Hk(t))return M.resolve(null);let r=Xt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=$g(t,null,"F"),r=Xt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let s=fe(...o);return this.Zi.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{let c=this.rs(t,a);return this.ss(t,c,s,l.readTime)?this.Xi(e,$g(t,null,"F")):this.os(e,c,t,l)}))})))}es(e,t,r,i){return Hk(t)||i.isEqual(X.min())?M.resolve(null):this.Zi.getDocuments(e,r).next(o=>{let s=this.rs(t,o);return this.ss(t,s,r,i)?M.resolve(null):(tl()<=bn.DEBUG&&F("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),nl(t)),this.os(e,s,t,PO(i,-1)).next(a=>a))})}rs(e,t){let r=new Ve(t1(e));return t.forEach((i,o)=>{Fd(e,o)&&(r=r.add(o))}),r}ss(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ts(e,t,r){return tl()<=bn.DEBUG&&F("QueryEngine","Using full collection scan to execute query:",nl(t)),this.Zi.getDocumentsMatchingQuery(e,t,jn.min(),r)}os(e,t,r,i){return this.Zi.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var DD=class{constructor(e,t,r,i){this.persistence=e,this._s=t,this.serializer=i,this.us=new We(le),this.cs=new tr(o=>ps(o),kd),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(r)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tm(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.us))}};function F1(n,e,t,r){return new DD(n,e,t,r)}function V1(n,e){return x(this,null,function*(){let t=H(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.Ps(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let s=[],a=[],l=fe();for(let c of i){s.push(c.batchId);for(let d of c.mutations)l=l.add(d.key)}for(let c of o){a.push(c.batchId);for(let d of c.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(r,l).next(c=>({Ts:c,removedBatchIds:s,addedBatchIds:a}))})})})}function A9(n,e){let t=H(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.hs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,d){let h=c.batch,g=h.keys(),m=M.resolve();return g.forEach(v=>{m=m.next(()=>d.getEntry(l,v)).next(D=>{let S=c.docVersions.get(v);Y(S!==null),D.version.compareTo(S)<0&&(h.applyToRemoteDocument(D,c),D.isValidDocument()&&(D.setReadTime(c.commitVersion),d.addEntry(D)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,h))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=fe();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function L1(n){let e=H(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Gr.getLastRemoteSnapshotVersion(t))}function M9(n,e){let t=H(n),r=e.snapshotVersion,i=t.us;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.hs.newChangeBuffer({trackRemovals:!0});i=t.us;let a=[];e.targetChanges.forEach((d,h)=>{let g=i.get(h);if(!g)return;a.push(t.Gr.removeMatchingKeys(o,d.removedDocuments,h).next(()=>t.Gr.addMatchingKeys(o,d.addedDocuments,h)));let m=g.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(lt.EMPTY_BYTE_STRING,X.min()).withLastLimboFreeSnapshotVersion(X.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,r)),i=i.insert(h,m),function(D,S,P){return D.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=3e8?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0}(g,m,d)&&a.push(t.Gr.updateTargetData(o,m))});let l=un(),c=fe();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,d))}),a.push(j1(o,s,e.documentUpdates).next(d=>{l=d.Is,c=d.ds})),!r.isEqual(X.min())){let d=t.Gr.getLastRemoteSnapshotVersion(o).next(h=>t.Gr.setTargetsMetadata(o,o.currentSequenceNumber,r));a.push(d)}return M.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,l,c)).next(()=>l)}).then(o=>(t.us=i,o))}function j1(n,e,t){let r=fe(),i=fe();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let s=un();return t.forEach((a,l)=>{let c=o.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(X.min())?(e.removeEntry(a,l.readTime),s=s.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),s=s.insert(a,l)):F("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Is:s,ds:i}})}function R9(n,e){let t=H(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function vl(n,e){let t=H(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Gr.getTargetData(r,e).next(o=>o?(i=o,M.resolve(i)):t.Gr.allocateTargetId(r).next(s=>(i=new yl(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.Gr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.us.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.us=t.us.insert(r.targetId,r),t.cs.set(e,r.targetId)),r})}function wl(n,e,t){return x(this,null,function*(){let r=H(n),i=r.us.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!ao(s))throw s;F("LocalStore",`Failed to update sequence numbers for target ${e}: ${s}`)}r.us=r.us.remove(e),r.cs.delete(i.target)})}function om(n,e,t){let r=H(n),i=X.min(),o=fe();return r.persistence.runTransaction("Execute query","readwrite",s=>function(l,c,d){let h=H(l),g=h.cs.get(d);return g!==void 0?M.resolve(h.us.get(g)):h.Gr.getTargetData(c,d)}(r,s,Xt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Gr.getMatchingKeysForTargetId(s,a.targetId).next(l=>{o=l})}).next(()=>r._s.getDocumentsMatchingQuery(s,e,t?i:X.min(),t?o:fe())).next(a=>($1(r,e1(e),a),{documents:a,Es:o})))}function B1(n,e){let t=H(n),r=H(t.Gr),i=t.us.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",o=>r.ut(o,e).next(s=>s?s.target:null))}function U1(n,e){let t=H(n),r=t.ls.get(e)||X.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.hs.getAllFromCollectionGroup(i,e,PO(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>($1(t,e,i),i))}function $1(n,e,t){let r=n.ls.get(e)||X.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.ls.set(e,r)}function x9(n,e,t,r){return x(this,null,function*(){let i=H(n),o=fe(),s=un();for(let c of t){let d=e.As(c.metadata.name);c.document&&(o=o.add(d));let h=e.Rs(c);h.setReadTime(e.Vs(c.metadata.readTime)),s=s.insert(d,h)}let a=i.hs.newChangeBuffer({trackRemovals:!0}),l=yield vl(i,function(d){return Xt(Al(Me.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",c=>j1(c,a,s).next(d=>(a.apply(c),d)).next(d=>i.Gr.removeMatchingKeysForTargetId(c,l.targetId).next(()=>i.Gr.addMatchingKeys(c,o,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(c,d.Is,d.ds)).next(()=>d.Is)))})}function N9(r,i){return x(this,arguments,function*(n,e,t=fe()){let o=yield vl(n,Xt(wT(e.bundledQuery))),s=H(n);return s.persistence.runTransaction("Save named query","readwrite",a=>{let l=at(e.readTime);if(o.snapshotVersion.compareTo(l)>=0)return s.jr.saveNamedQuery(a,e);let c=o.withResumeToken(lt.EMPTY_BYTE_STRING,l);return s.us=s.us.insert(c.targetId,c),s.Gr.updateTargetData(a,c).next(()=>s.Gr.removeMatchingKeysForTargetId(a,o.targetId)).next(()=>s.Gr.addMatchingKeys(a,t,o.targetId)).next(()=>s.jr.saveNamedQuery(a,e))})})}function mO(n,e){return`firestore_clients_${n}_${e}`}function yO(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function cC(n,e){return`firestore_targets_${n}_${e}`}var sm=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static fs(e,t,r){let i=JSON.parse(r),o,s=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(o=new k(i.error.code,i.error.message))),s?new n(e,t,i.state,o):(ot("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}gs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},ud=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static fs(e,t){let r=JSON.parse(t),i,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new k(r.error.code,r.error.message))),o?new n(e,r.state,i):(ot("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}gs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},am=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static fs(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=yT();for(let s=0;i&&s<r.activeTargetIds.length;++s)i=VO(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new n(e,o):(ot("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},TD=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static fs(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(ot("SharedClientState",`Failed to parse online state: ${e}`),null)}},Sd=class{constructor(){this.activeTargetIds=yT()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},cd=class{constructor(e,t,r,i,o){this.window=e,this.li=t,this.persistenceKey=r,this.ws=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ss=this.bs.bind(this),this.Ds=new We(le),this.started=!1,this.vs=[];let s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Cs=mO(this.persistenceKey,this.ws),this.Fs=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Ds=this.Ds.insert(this.ws,new Sd),this.Ms=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.xs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Os=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.Ns=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.Bs=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.Ss)}static p(e){return!(!e||!e.localStorage)}start(){return x(this,null,function*(){let e=yield this.syncEngine.$i();for(let r of e){if(r===this.ws)continue;let i=this.getItem(mO(this.persistenceKey,r));if(i){let o=am.fs(r,i);o&&(this.Ds=this.Ds.insert(o.clientId,o))}}this.Ls();let t=this.storage.getItem(this.Ns);if(t){let r=this.ks(t);r&&this.qs(r)}for(let r of this.vs)this.bs(r);this.vs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Fs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Qs(this.Ds)}isActiveQueryTarget(e){let t=!1;return this.Ds.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ks(e,"pending")}updateMutationState(e,t,r){this.Ks(e,t,r),this.$s(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let i=this.storage.getItem(cC(this.persistenceKey,e));if(i){let o=ud.fs(e,i);o&&(r=o.state)}}return t&&this.Us.ps(e),this.Ls(),r}removeLocalQueryTarget(e){this.Us.ys(e),this.Ls()}isLocalQueryTarget(e){return this.Us.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(cC(this.persistenceKey,e))}updateQueryState(e,t,r){this.Ws(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.$s(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Gs(e)}notifyBundleLoaded(e){this.zs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Ss),this.removeItem(this.Cs),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return F("SharedClientState","READ",e,t),t}setItem(e,t){F("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){F("SharedClientState","REMOVE",e),this.storage.removeItem(e)}bs(e){let t=e;if(t.storageArea===this.storage){if(F("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Cs)return void ot("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.li.enqueueRetryable(()=>x(this,null,function*(){if(this.started){if(t.key!==null){if(this.Ms.test(t.key)){if(t.newValue==null){let r=this.js(t.key);return this.Hs(r,null)}{let r=this.Js(t.key,t.newValue);if(r)return this.Hs(r.clientId,r)}}else if(this.xs.test(t.key)){if(t.newValue!==null){let r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(this.Os.test(t.key)){if(t.newValue!==null){let r=this.Xs(t.key,t.newValue);if(r)return this.eo(r)}}else if(t.key===this.Ns){if(t.newValue!==null){let r=this.ks(t.newValue);if(r)return this.qs(r)}}else if(t.key===this.Fs){let r=function(o){let s=Cn.oe;if(o!=null)try{let a=JSON.parse(o);Y(typeof a=="number"),s=a}catch(a){ot("SharedClientState","Failed to read sequence number from WebStorage",a)}return s}(t.newValue);r!==Cn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Bs){let r=this.no(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.ro(i)))}}}else this.vs.push(t)}))}}get Us(){return this.Ds.get(this.ws)}Ls(){this.setItem(this.Cs,this.Us.gs())}Ks(e,t,r){let i=new sm(this.currentUser,e,t,r),o=yO(this.persistenceKey,this.currentUser,e);this.setItem(o,i.gs())}$s(e){let t=yO(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Gs(e){let t={clientId:this.ws,onlineState:e};this.storage.setItem(this.Ns,JSON.stringify(t))}Ws(e,t,r){let i=cC(this.persistenceKey,e),o=new ud(e,t,r);this.setItem(i,o.gs())}zs(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Bs,t)}js(e){let t=this.Ms.exec(e);return t?t[1]:null}Js(e,t){let r=this.js(e);return am.fs(r,t)}Ys(e,t){let r=this.xs.exec(e),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return sm.fs(new ft(o),i,t)}Xs(e,t){let r=this.Os.exec(e),i=Number(r[1]);return ud.fs(i,t)}ks(e){return TD.fs(e)}no(e){return JSON.parse(e)}Zs(e){return x(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.io(e.batchId,e.state,e.error);F("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}eo(e){return this.syncEngine.so(e.targetId,e.state,e.error)}Hs(e,t){let r=t?this.Ds.insert(e,t):this.Ds.remove(e),i=this.Qs(this.Ds),o=this.Qs(r),s=[],a=[];return o.forEach(l=>{i.has(l)||s.push(l)}),i.forEach(l=>{o.has(l)||a.push(l)}),this.syncEngine.oo(s,a).then(()=>{this.Ds=r})}qs(e){this.Ds.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Qs(e){let t=yT();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},lm=class{constructor(){this._o=new Sd,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,t,r){this.ao[e]=t}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new Sd,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var bD=class{uo(e){}shutdown(){}};var um=class{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){F("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.To)e(0)}Po(){F("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.To)e(1)}static p(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Dg=null;function dC(){return Dg===null?Dg=function(){return 268435456+Math.round(2147483648*Math.random())}():Dg++,"0x"+Dg.toString(16)}var P9={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var SD=class{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}};var jt="WebChannelConnection",AD=class extends class{get Co(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Fo=r+"://"+t.host,this.Mo=`projects/${i}/databases/${o}`,this.xo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}Oo(t,r,i,o,s){let a=dC(),l=this.No(t,r.toUriEncodedString());F("RestConnection",`Sending RPC '${t}' ${a}:`,l,i);let c={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Bo(c,o,s),this.Lo(t,l,c,i).then(d=>(F("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Xn("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",l,"request:",i),d})}ko(t,r,i,o,s,a){return this.Oo(t,r,i,o,s)}Bo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Sl}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,s)=>t[s]=o),i&&i.headers.forEach((o,s)=>t[s]=o)}No(t,r){let i=P9[t];return`${this.Fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Lo(e,t,r,i){let o=dC();return new Promise((s,a)=>{let l=new rC;l.setWithCredentials(!0),l.listenOnce(iC.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Xc.NO_ERROR:let d=l.getResponseJson();F(jt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(d)),s(d);break;case Xc.TIMEOUT:F(jt,`RPC '${e}' ${o} timed out`),a(new k(N.DEADLINE_EXCEEDED,"Request time out"));break;case Xc.HTTP_ERROR:let h=l.getStatus();if(F(jt,`RPC '${e}' ${o} failed with status:`,h,"response text:",l.getResponseText()),h>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);let m=g?.error;if(m&&m.status&&m.message){let v=function(S){let P=S.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(P)>=0?P:N.UNKNOWN}(m.status);a(new k(v,m.message))}else a(new k(N.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new k(N.UNAVAILABLE,"Connection failed."));break;default:W()}}finally{F(jt,`RPC '${e}' ${o} completed.`)}});let c=JSON.stringify(i);F(jt,`RPC '${e}' ${o} sending request:`,i),l.send(t,"POST",c,r,15)})}qo(e,t,r){let i=dC(),o=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=aC(),a=sC(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Bo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;let d=o.join("");F(jt,`Creating RPC '${e}' stream ${i}: ${d}`,l);let h=s.createWebChannel(d,l),g=!1,m=!1,v=new SD({Eo:S=>{m?F(jt,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(g||(F(jt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),g=!0),F(jt,`RPC '${e}' stream ${i} sending:`,S),h.send(S))},Ao:()=>h.close()}),D=(S,P,j)=>{S.listen(P,O=>{try{j(O)}catch(K){setTimeout(()=>{throw K},0)}})};return D(h,Ya.EventType.OPEN,()=>{m||(F(jt,`RPC '${e}' stream ${i} transport opened.`),v.So())}),D(h,Ya.EventType.CLOSE,()=>{m||(m=!0,F(jt,`RPC '${e}' stream ${i} transport closed`),v.Do())}),D(h,Ya.EventType.ERROR,S=>{m||(m=!0,Xn(jt,`RPC '${e}' stream ${i} transport errored:`,S),v.Do(new k(N.UNAVAILABLE,"The operation could not be completed")))}),D(h,Ya.EventType.MESSAGE,S=>{var P;if(!m){let j=S.data[0];Y(!!j);let O=j,K=O?.error||((P=O[0])===null||P===void 0?void 0:P.error);if(K){F(jt,`RPC '${e}' stream ${i} received error:`,K);let ie=K.status,ee=function(E){let C=dt[E];if(C!==void 0)return p1(C)}(ie),I=K.message;ee===void 0&&(ee=N.INTERNAL,I="Unknown error status: "+ie+" with message "+K.message),m=!0,v.Do(new k(ee,I)),h.close()}else F(jt,`RPC '${e}' stream ${i} received:`,j),v.vo(j)}}),D(a,oC.STAT_EVENT,S=>{S.stat===vg.PROXY?F(jt,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===vg.NOPROXY&&F(jt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.bo()},0),v}};function H1(){return typeof window<"u"?window:null}function Rg(){return typeof document<"u"?document:null}function Vd(n){return new qC(n,!0)}var Ad=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.li=e,this.timerId=t,this.Qo=r,this.Ko=i,this.$o=o,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();let t=Math.floor(this.Uo+this.Ho()),r=Math.max(0,Date.now()-this.Go),i=Math.max(0,t-r);i>0&&F("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Uo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,i,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}};var cm=class{constructor(e,t,r,i,o,s,a,l){this.li=e,this.Yo=r,this.Zo=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new Ad(e,t)}i_(){return this.state===1||this.state===5||this.s_()}s_(){return this.state===2||this.state===3}start(){this.n_=0,this.state!==4?this.auth():this.o_()}stop(){return x(this,null,function*(){this.i_()&&(yield this.close(0))})}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&this.e_===null&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,()=>this.u_()))}c_(e){this.l_(),this.stream.send(e)}u_(){return x(this,null,function*(){if(this.s_())return this.close(0)})}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}close(e,t){return x(this,null,function*(){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,e!==4?this.r_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(ot(t.toString()),ot("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.po(t)})}P_(){}auth(){this.state=1;let e=this.T_(this.Xo),t=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Xo===t&&this.I_(r,i)},r=>{e(()=>{let i=new k(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.d_(i)})})}I_(e,t){let r=this.T_(this.Xo);this.stream=this.E_(e,t),this.stream.Ro(()=>{r(()=>this.listener.Ro())}),this.stream.mo(()=>{r(()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,()=>(this.s_()&&(this.state=3),Promise.resolve())),this.listener.mo()))}),this.stream.po(i=>{r(()=>this.d_(i))}),this.stream.onMessage(i=>{r(()=>++this.n_==1?this.A_(i):this.onNext(i))})}o_(){this.state=5,this.r_.jo(()=>x(this,null,function*(){this.state=0,this.start()}))}d_(e){return F("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}T_(e){return t=>{this.li.enqueueAndForget(()=>this.Xo===e?t():(F("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},MD=class extends cm{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}E_(e,t){return this.connection.qo("Listen",e,t)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();let t=_9(this.serializer,e),r=function(o){if(!("targetChange"in o))return X.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?X.min():s.readTime?at(s.readTime):X.min()}(e);return this.listener.R_(t,r)}V_(e){let t={};t.database=WC(this.serializer),t.addTarget=function(o,s){let a,l=s.target;if(a=Bg(l)?{documents:I1(o,l)}:{query:C1(o,l).ct},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=m1(o,s.resumeToken);let c=GC(o,s.expectedCount);c!==null&&(a.expectedCount=c)}else if(s.snapshotVersion.compareTo(X.min())>0){a.readTime=ml(o,s.snapshotVersion.toTimestamp());let c=GC(o,s.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);let r=w9(this.serializer,e);r&&(t.labels=r),this.c_(t)}m_(e){let t={};t.database=WC(this.serializer),t.removeTarget=e,this.c_(t)}},RD=class extends cm{constructor(e,t,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}E_(e,t){return this.connection.qo("Write",e,t)}A_(e){return Y(!!e.streamToken),this.lastStreamToken=e.streamToken,Y(!e.writeResults||e.writeResults.length===0),this.listener.p_()}onNext(e){Y(!!e.streamToken),this.lastStreamToken=e.streamToken,this.r_.reset();let t=v9(e.writeResults,e.commitTime),r=at(e.commitTime);return this.listener.y_(r,t)}w_(){let e={};e.database=WC(this.serializer),this.c_(e)}g_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Cd(this.serializer,r))};this.c_(t)}};var xD=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.S_=!1}b_(){if(this.S_)throw new k(N.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,t,r,i){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Oo(e,zC(t,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new k(N.UNKNOWN,o.toString())})}ko(e,t,r,i,o){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.ko(e,zC(t,r),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new k(N.UNKNOWN,s.toString())})}terminate(){this.S_=!0,this.connection.terminate()}},ND=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){this.D_===0&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve())))}O_(e){this.state==="Online"?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.M_("Offline")))}set(e){this.N_(),this.D_=0,e==="Online"&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(ot(t),this.C_=!1):F("OnlineStateTracker",t)}N_(){this.v_!==null&&(this.v_.cancel(),this.v_=null)}};var PD=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.B_=[],this.L_=new Map,this.k_=new Set,this.q_=[],this.Q_=o,this.Q_.uo(s=>{r.enqueueAndForget(()=>x(this,null,function*(){uo(this)&&(F("RemoteStore","Restarting streams for network reachability change."),yield function(l){return x(this,null,function*(){let c=H(l);c.k_.add(4),yield Ml(c),c.K_.set("Unknown"),c.k_.delete(4),yield Ld(c)})}(this))}))}),this.K_=new ND(r,i)}};function Ld(n){return x(this,null,function*(){if(uo(n))for(let e of n.q_)yield e(!0)})}function Ml(n){return x(this,null,function*(){for(let e of n.q_)yield e(!1)})}function Nm(n,e){let t=H(n);t.L_.has(e.targetId)||(t.L_.set(e.targetId,e),TT(t)?DT(t):xl(t).s_()&&CT(t,e))}function El(n,e){let t=H(n),r=xl(t);t.L_.delete(e),r.s_()&&q1(t,e),t.L_.size===0&&(r.s_()?r.a_():uo(t)&&t.K_.set("Unknown"))}function CT(n,e){if(n.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(X.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}xl(n).V_(e)}function q1(n,e){n.U_.xe(e),xl(n).m_(e)}function DT(n){n.U_=new HC({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>n.L_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),xl(n).start(),n.K_.F_()}function TT(n){return uo(n)&&!xl(n).i_()&&n.L_.size>0}function uo(n){return H(n).k_.size===0}function G1(n){n.U_=void 0}function k9(n){return x(this,null,function*(){n.K_.set("Online")})}function O9(n){return x(this,null,function*(){n.L_.forEach((e,t)=>{CT(n,e)})})}function F9(n,e){return x(this,null,function*(){G1(n),TT(n)?(n.K_.O_(e),DT(n)):n.K_.set("Unknown")})}function V9(n,e,t){return x(this,null,function*(){if(n.K_.set("Online"),e instanceof qg&&e.state===2&&e.cause)try{yield function(i,o){return x(this,null,function*(){let s=o.cause;for(let a of o.targetIds)i.L_.has(a)&&(yield i.remoteSyncer.rejectListen(a,s),i.L_.delete(a),i.U_.removeTarget(a))})}(n,e)}catch(r){F("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield dm(n,r)}else if(e instanceof ul?n.U_.$e(e):e instanceof Hg?n.U_.Je(e):n.U_.Ge(e),!t.isEqual(X.min()))try{let r=yield L1(n.localStore);t.compareTo(r)>=0&&(yield function(o,s){let a=o.U_.it(s);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){let d=o.L_.get(c);d&&o.L_.set(c,d.withResumeToken(l.resumeToken,s))}}),a.targetMismatches.forEach((l,c)=>{let d=o.L_.get(l);if(!d)return;o.L_.set(l,d.withResumeToken(lt.EMPTY_BYTE_STRING,d.snapshotVersion)),q1(o,l);let h=new yl(d.target,l,c,d.sequenceNumber);CT(o,h)}),o.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){F("RemoteStore","Failed to raise snapshot:",r),yield dm(n,r)}})}function dm(n,e,t){return x(this,null,function*(){if(!ao(e))throw e;n.k_.add(1),yield Ml(n),n.K_.set("Offline"),t||(t=()=>L1(n.localStore)),n.asyncQueue.enqueueRetryable(()=>x(this,null,function*(){F("RemoteStore","Retrying IndexedDB access"),yield t(),n.k_.delete(1),yield Ld(n)}))})}function z1(n,e){return e().catch(t=>dm(n,t,e))}function Rl(n){return x(this,null,function*(){let e=H(n),t=oo(e),r=e.B_.length>0?e.B_[e.B_.length-1].batchId:-1;for(;L9(e);)try{let i=yield R9(e.localStore,r);if(i===null){e.B_.length===0&&t.a_();break}r=i.batchId,j9(e,i)}catch(i){yield dm(e,i)}W1(e)&&K1(e)})}function L9(n){return uo(n)&&n.B_.length<10}function j9(n,e){n.B_.push(e);let t=oo(n);t.s_()&&t.f_&&t.g_(e.mutations)}function W1(n){return uo(n)&&!oo(n).i_()&&n.B_.length>0}function K1(n){oo(n).start()}function B9(n){return x(this,null,function*(){oo(n).w_()})}function U9(n){return x(this,null,function*(){let e=oo(n);for(let t of n.B_)e.g_(t.mutations)})}function $9(n,e,t){return x(this,null,function*(){let r=n.B_.shift(),i=BC.from(r,e,t);yield z1(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Rl(n)})}function H9(n,e){return x(this,null,function*(){e&&oo(n).f_&&(yield function(r,i){return x(this,null,function*(){if(function(s){return f1(s)&&s!==N.ABORTED}(i.code)){let o=r.B_.shift();oo(r).__(),yield z1(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield Rl(r)}})}(n,e)),W1(n)&&K1(n)})}function _O(n,e){return x(this,null,function*(){let t=H(n);t.asyncQueue.verifyOperationInProgress(),F("RemoteStore","RemoteStore received new credentials");let r=uo(t);t.k_.add(3),yield Ml(t),r&&t.K_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.k_.delete(3),yield Ld(t)})}function kD(n,e){return x(this,null,function*(){let t=H(n);e?(t.k_.delete(2),yield Ld(t)):e||(t.k_.add(2),yield Ml(t),t.K_.set("Unknown"))})}function xl(n){return n.W_||(n.W_=function(t,r,i){let o=H(t);return o.b_(),new MD(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Ro:k9.bind(null,n),mo:O9.bind(null,n),po:F9.bind(null,n),R_:V9.bind(null,n)}),n.q_.push(e=>x(this,null,function*(){e?(n.W_.__(),TT(n)?DT(n):n.K_.set("Unknown")):(yield n.W_.stop(),G1(n))}))),n.W_}function oo(n){return n.G_||(n.G_=function(t,r,i){let o=H(t);return o.b_(),new RD(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Ro:()=>Promise.resolve(),mo:B9.bind(null,n),po:H9.bind(null,n),p_:U9.bind(null,n),y_:$9.bind(null,n)}),n.q_.push(e=>x(this,null,function*(){e?(n.G_.__(),yield Rl(n)):(yield n.G_.stop(),n.B_.length>0&&(F("RemoteStore",`Stopping write stream with ${n.B_.length} pending writes`),n.B_=[]))}))),n.G_}var OD=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new vt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let s=Date.now()+r,a=new n(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new k(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Nl(n,e){if(ot("AsyncQueue",`${e}: ${n}`),ao(n))return new k(N.UNAVAILABLE,`${e}: ${n}`);throw n}var hm=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||q.comparator(t.key,r.key):(t,r)=>q.comparator(t.key,r.key),this.keyedMap=id(),this.sortedSet=new We(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var fm=class{constructor(){this.z_=new We(q.comparator)}track(e){let t=e.doc.key,r=this.z_.get(t);r?e.type!==0&&r.type===3?this.z_=this.z_.insert(t,e):e.type===3&&r.type!==1?this.z_=this.z_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.z_=this.z_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.z_=this.z_.remove(t):e.type===1&&r.type===2?this.z_=this.z_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):W():this.z_=this.z_.insert(t,e)}j_(){let e=[];return this.z_.inorderTraversal((t,r)=>{e.push(r)}),e}},Il=class n{constructor(e,t,r,i,o,s,a,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,i,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,hm.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Od(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var FD=class{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some(e=>e.Z_())}},VD=class{constructor(){this.queries=vO(),this.onlineState="Unknown",this.X_=new Set}terminate(){(function(t,r){let i=H(t),o=i.queries;i.queries=vO(),o.forEach((s,a)=>{for(let l of a.J_)l.onError(r)})})(this,new k(N.ABORTED,"Firestore shutting down"))}};function vO(){return new tr(n=>XO(n),Od)}function bT(n,e){return x(this,null,function*(){let t=H(n),r=3,i=e.query,o=t.queries.get(i);o?!o.Y_()&&e.Z_()&&(r=2):(o=new FD,r=e.Z_()?0:1);try{switch(r){case 0:o.H_=yield t.onListen(i,!0);break;case 1:o.H_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(s){let a=Nl(s,`Initialization of query '${nl(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.J_.push(e),e.ea(t.onlineState),o.H_&&e.ta(o.H_)&&AT(t)})}function ST(n,e){return x(this,null,function*(){let t=H(n),r=e.query,i=3,o=t.queries.get(r);if(o){let s=o.J_.indexOf(e);s>=0&&(o.J_.splice(s,1),o.J_.length===0?i=e.Z_()?0:1:!o.Y_()&&e.Z_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function q9(n,e){let t=H(n),r=!1;for(let i of e){let o=i.query,s=t.queries.get(o);if(s){for(let a of s.J_)a.ta(i)&&(r=!0);s.H_=i}}r&&AT(t)}function G9(n,e,t){let r=H(n),i=r.queries.get(e);if(i)for(let o of i.J_)o.onError(t);r.queries.delete(e)}function AT(n){n.X_.forEach(e=>{e.next()})}var LD,wO;(wO=LD||(LD={})).na="default",wO.Cache="cache";var Md=class{constructor(e,t,r){this.query=e,this.ra=t,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=r||{}}ta(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Il(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ia?this.oa(e)&&(this.ra.next(e),t=!0):this._a(e,this.onlineState)&&(this.aa(e),t=!0),this.sa=e,t}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let t=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),t=!0),t}_a(e,t){if(!e.fromCache||!this.Z_())return!0;let r=t!=="Offline";return(!this.options.ua||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}oa(e){if(e.docChanges.length>0)return!0;let t=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}aa(e){e=Il.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==LD.Cache}};var jD=class{constructor(e,t){this.ca=e,this.byteLength=t}la(){return"metadata"in this.ca}};var pm=class{constructor(e){this.serializer=e}As(e){return Tr(this.serializer,e)}Rs(e){return e.metadata.exists?E1(this.serializer,e.document,!1):pt.newNoDocument(this.As(e.metadata.name),this.Vs(e.metadata.readTime))}Vs(e){return at(e)}},BD=class{constructor(e,t,r){this.ha=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Q1(e)}Pa(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ca.namedQuery)this.queries.push(e.ca.namedQuery);else if(e.ca.documentMetadata){this.documents.push({metadata:e.ca.documentMetadata}),e.ca.documentMetadata.exists||++t;let r=Me.fromString(e.ca.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ca.document&&(this.documents[this.documents.length-1].document=e.ca.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Ta(e){let t=new Map,r=new pm(this.serializer);for(let i of e)if(i.metadata.queries){let o=r.As(i.metadata.name);for(let s of i.metadata.queries){let a=(t.get(s)||fe()).add(o);t.set(s,a)}}return t}complete(){return x(this,null,function*(){let e=yield x9(this.localStore,new pm(this.serializer),this.documents,this.ha.id),t=this.Ta(this.documents);for(let r of this.queries)yield N9(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Ia:this.collectionGroups,da:e}})}};function Q1(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var gm=class{constructor(e){this.key=e}},mm=class{constructor(e){this.key=e}},ym=class{constructor(e,t){this.query=e,this.Ea=t,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=fe(),this.mutatedKeys=fe(),this.Va=t1(e),this.ma=new hm(this.Va)}get fa(){return this.Ea}ga(e,t){let r=t?t.pa:new fm,i=t?t.ma:this.ma,o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1,l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{let g=i.get(d),m=Fd(this.query,h)?h:null,v=!!g&&this.mutatedKeys.has(g.key),D=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations),S=!1;g&&m?g.data.isEqual(m.data)?v!==D&&(r.track({type:3,doc:m}),S=!0):this.ya(g,m)||(r.track({type:2,doc:m}),S=!0,(l&&this.Va(m,l)>0||c&&this.Va(m,c)<0)&&(a=!0)):!g&&m?(r.track({type:0,doc:m}),S=!0):g&&!m&&(r.track({type:1,doc:g}),S=!0,(l||c)&&(a=!0)),S&&(m?(s=s.add(m),o=D?o.add(d):o.delete(d)):(s=s.delete(d),o=o.delete(d)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let d=this.query.limitType==="F"?s.last():s.first();s=s.delete(d.key),o=o.delete(d.key),r.track({type:1,doc:d})}return{ma:s,pa:r,ss:a,mutatedKeys:o}}ya(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;let s=e.pa.j_();s.sort((d,h)=>function(m,v){let D=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return W()}};return D(m)-D(v)}(d.type,h.type)||this.Va(d.doc,h.doc)),this.wa(r),i=i!=null&&i;let a=t&&!i?this.Sa():[],l=this.Ra.size===0&&this.current&&!i?1:0,c=l!==this.Aa;return this.Aa=l,s.length!==0||c?{snapshot:new Il(this.query,e.ma,o,s,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),ba:a}:{ba:a}}ea(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ma:this.ma,pa:new fm,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.Ea.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach(t=>this.Ea=this.Ea.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ea=this.Ea.delete(t)),this.current=e.current)}Sa(){if(!this.current)return[];let e=this.Ra;this.Ra=fe(),this.ma.forEach(r=>{this.Da(r.key)&&(this.Ra=this.Ra.add(r.key))});let t=[];return e.forEach(r=>{this.Ra.has(r)||t.push(new mm(r))}),this.Ra.forEach(r=>{e.has(r)||t.push(new gm(r))}),t}va(e){this.Ea=e.Es,this.Ra=fe();let t=this.ga(e.documents);return this.applyChanges(t,!0)}Ca(){return Il.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,this.Aa===0,this.hasCachedResults)}},UD=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},$D=class{constructor(e){this.key=e,this.Fa=!1}},HD=class{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Ma={},this.xa=new tr(a=>XO(a),Od),this.Oa=new Map,this.Na=new Set,this.Ba=new We(q.comparator),this.La=new Map,this.ka=new Td,this.qa={},this.Qa=new Map,this.Ka=_l.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return this.$a===!0}};function z9(n,e,t=!0){return x(this,null,function*(){let r=Pm(n),i,o=r.xa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Ca()):i=yield Y1(r,e,t,!0),i})}function W9(n,e){return x(this,null,function*(){let t=Pm(n);yield Y1(t,e,!0,!1)})}function Y1(n,e,t,r){return x(this,null,function*(){let i=yield vl(n.localStore,Xt(e)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return r&&(a=yield MT(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&Nm(n.remoteStore,i),a})}function MT(n,e,t,r,i){return x(this,null,function*(){n.Ua=(h,g,m)=>function(D,S,P,j){return x(this,null,function*(){let O=S.view.ga(P);O.ss&&(O=yield om(D.localStore,S.query,!1).then(({documents:I})=>S.view.ga(I,O)));let K=j&&j.targetChanges.get(S.targetId),ie=j&&j.targetMismatches.get(S.targetId)!=null,ee=S.view.applyChanges(O,D.isPrimaryClient,K,ie);return qD(D,S.targetId,ee.ba),ee.snapshot})}(n,h,g,m);let o=yield om(n.localStore,e,!0),s=new ym(e,o.Es),a=s.ga(o.documents),l=Ed.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),c=s.applyChanges(a,n.isPrimaryClient,l);qD(n,t,c.ba);let d=new UD(e,t,s);return n.xa.set(e,d),n.Oa.has(t)?n.Oa.get(t).push(e):n.Oa.set(t,[e]),c.snapshot})}function K9(n,e,t){return x(this,null,function*(){let r=H(n),i=r.xa.get(e),o=r.Oa.get(i.targetId);if(o.length>1)return r.Oa.set(i.targetId,o.filter(s=>!Od(s,e))),void r.xa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield wl(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&El(r.remoteStore,i.targetId),Cl(r,i.targetId)}).catch(so))):(Cl(r,i.targetId),yield wl(r.localStore,i.targetId,!0))})}function Q9(n,e){return x(this,null,function*(){let t=H(n),r=t.xa.get(e),i=t.Oa.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),El(t.remoteStore,r.targetId))})}function Y9(n,e,t){return x(this,null,function*(){let r=PT(n);try{let i=yield function(s,a){let l=H(s),c=Je.now(),d=a.reduce((m,v)=>m.add(v.key),fe()),h,g;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let v=un(),D=fe();return l.hs.getEntries(m,d).next(S=>{v=S,v.forEach((P,j)=>{j.isValidDocument()||(D=D.add(P))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,v)).next(S=>{h=S;let P=[];for(let j of a){let O=d9(j,h.get(j.key).overlayedDocument);O!=null&&P.push(new nr(j.key,O,zO(O.value.mapValue),rt.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,P,a)}).next(S=>{g=S;let P=S.applyToLocalDocumentSet(h,D);return l.documentOverlayCache.saveOverlays(m,S.batchId,P)})}).then(()=>({batchId:g.batchId,changes:r1(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,a,l){let c=s.qa[s.currentUser.toKey()];c||(c=new We(le)),c=c.insert(a,l),s.qa[s.currentUser.toKey()]=c}(r,i.batchId,t),yield ui(r,i.changes),yield Rl(r.remoteStore)}catch(i){let o=Nl(i,"Failed to persist write");t.reject(o)}})}function Z1(n,e){return x(this,null,function*(){let t=H(n);try{let r=yield M9(t.localStore,e);e.targetChanges.forEach((i,o)=>{let s=t.La.get(o);s&&(Y(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.Fa=!0:i.modifiedDocuments.size>0?Y(s.Fa):i.removedDocuments.size>0&&(Y(s.Fa),s.Fa=!1))}),yield ui(t,r,e)}catch(r){yield so(r)}})}function EO(n,e,t){let r=H(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.xa.forEach((o,s)=>{let a=s.view.ea(e);a.snapshot&&i.push(a.snapshot)}),function(s,a){let l=H(s);l.onlineState=a;let c=!1;l.queries.forEach((d,h)=>{for(let g of h.J_)g.ea(a)&&(c=!0)}),c&&AT(l)}(r.eventManager,e),i.length&&r.Ma.R_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Z9(n,e,t){return x(this,null,function*(){let r=H(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.La.get(e),o=i&&i.key;if(o){let s=new We(q.comparator);s=s.insert(o,pt.newNoDocument(o,X.min()));let a=fe().add(o),l=new wd(X.min(),new Map,new We(le),s,a);yield Z1(r,l),r.Ba=r.Ba.remove(o),r.La.delete(e),NT(r)}else yield wl(r.localStore,e,!1).then(()=>Cl(r,e,t)).catch(so)})}function J9(n,e){return x(this,null,function*(){let t=H(n),r=e.batch.batchId;try{let i=yield A9(t.localStore,e);xT(t,r,null),RT(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield ui(t,i)}catch(i){yield so(i)}})}function X9(n,e,t){return x(this,null,function*(){let r=H(n);try{let i=yield function(s,a){let l=H(s);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(Y(h!==null),d=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(r.localStore,e);xT(r,e,t),RT(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield ui(r,i)}catch(i){yield so(i)}})}function e8(n,e){return x(this,null,function*(){let t=H(n);uo(t.remoteStore)||F("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(s){let a=H(s);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(t.localStore);if(r===-1)return void e.resolve();let i=t.Qa.get(r)||[];i.push(e),t.Qa.set(r,i)}catch(r){let i=Nl(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function RT(n,e){(n.Qa.get(e)||[]).forEach(t=>{t.resolve()}),n.Qa.delete(e)}function xT(n,e,t){let r=H(n),i=r.qa[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.qa[r.currentUser.toKey()]=i}}function Cl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Oa.get(e))n.xa.delete(r),t&&n.Ma.Wa(r,t);n.Oa.delete(e),n.isPrimaryClient&&n.ka.yr(e).forEach(r=>{n.ka.containsKey(r)||J1(n,r)})}function J1(n,e){n.Na.delete(e.path.canonicalString());let t=n.Ba.get(e);t!==null&&(El(n.remoteStore,t),n.Ba=n.Ba.remove(e),n.La.delete(t),NT(n))}function qD(n,e,t){for(let r of t)r instanceof gm?(n.ka.addReference(r.key,e),t8(n,r)):r instanceof mm?(F("SyncEngine","Document no longer in limbo: "+r.key),n.ka.removeReference(r.key,e),n.ka.containsKey(r.key)||J1(n,r.key)):W()}function t8(n,e){let t=e.key,r=t.path.canonicalString();n.Ba.get(t)||n.Na.has(r)||(F("SyncEngine","New document in limbo: "+t),n.Na.add(r),NT(n))}function NT(n){for(;n.Na.size>0&&n.Ba.size<n.maxConcurrentLimboResolutions;){let e=n.Na.values().next().value;n.Na.delete(e);let t=new q(Me.fromString(e)),r=n.Ka.next();n.La.set(r,new $D(t)),n.Ba=n.Ba.insert(t,r),Nm(n.remoteStore,new yl(Xt(Al(t.path)),r,"TargetPurposeLimboResolution",Cn.oe))}}function ui(n,e,t){return x(this,null,function*(){let r=H(n),i=[],o=[],s=[];r.xa.isEmpty()||(r.xa.forEach((a,l)=>{s.push(r.Ua(l,e,t).then(c=>{var d;if((c||t)&&r.isPrimaryClient){let h=c?!c.fromCache:(d=t?.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);let h=ID.zi(l.targetId,c);o.push(h)}}))}),yield Promise.all(s),r.Ma.R_(i),yield function(l,c){return x(this,null,function*(){let d=H(l);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>M.forEach(c,g=>M.forEach(g.Wi,m=>d.persistence.referenceDelegate.addReference(h,g.targetId,m)).next(()=>M.forEach(g.Gi,m=>d.persistence.referenceDelegate.removeReference(h,g.targetId,m)))))}catch(h){if(!ao(h))throw h;F("LocalStore","Failed to update sequence numbers: "+h)}for(let h of c){let g=h.targetId;if(!h.fromCache){let m=d.us.get(g),v=m.snapshotVersion,D=m.withLastLimboFreeSnapshotVersion(v);d.us=d.us.insert(g,D)}}})}(r.localStore,o))})}function n8(n,e){return x(this,null,function*(){let t=H(n);if(!t.currentUser.isEqual(e)){F("SyncEngine","User change. New user:",e.toKey());let r=yield V1(t.localStore,e);t.currentUser=e,function(o,s){o.Qa.forEach(a=>{a.forEach(l=>{l.reject(new k(N.CANCELLED,s))})}),o.Qa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ui(t,r.Ts)}})}function r8(n,e){let t=H(n),r=t.La.get(e);if(r&&r.Fa)return fe().add(r.key);{let i=fe(),o=t.Oa.get(e);if(!o)return i;for(let s of o){let a=t.xa.get(s);i=i.unionWith(a.view.fa)}return i}}function i8(n,e){return x(this,null,function*(){let t=H(n),r=yield om(t.localStore,e.query,!0),i=e.view.va(r);return t.isPrimaryClient&&qD(t,e.targetId,i.ba),i})}function o8(n,e){return x(this,null,function*(){let t=H(n);return U1(t.localStore,e).then(r=>ui(t,r))})}function s8(n,e,t,r){return x(this,null,function*(){let i=H(n),o=yield function(a,l){let c=H(a),d=H(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",h=>d.On(h,l).next(g=>g?c.localDocuments.getDocuments(h,g):M.resolve(null)))}(i.localStore,e);o!==null?(t==="pending"?yield Rl(i.remoteStore):t==="acknowledged"||t==="rejected"?(xT(i,e,r||null),RT(i,e),function(a,l){H(H(a).mutationQueue).Bn(l)}(i.localStore,e)):W(),yield ui(i,o)):F("SyncEngine","Cannot apply mutation batch with id: "+e)})}function a8(n,e){return x(this,null,function*(){let t=H(n);if(Pm(t),PT(t),e===!0&&t.$a!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield IO(t,r.toArray());t.$a=!0,yield kD(t.remoteStore,!0);for(let o of i)Nm(t.remoteStore,o)}else if(e===!1&&t.$a!==!1){let r=[],i=Promise.resolve();t.Oa.forEach((o,s)=>{t.sharedClientState.isLocalQueryTarget(s)?r.push(s):i=i.then(()=>(Cl(t,s),wl(t.localStore,s,!0))),El(t.remoteStore,s)}),yield i,yield IO(t,r),function(s){let a=H(s);a.La.forEach((l,c)=>{El(a.remoteStore,c)}),a.ka.wr(),a.La=new Map,a.Ba=new We(q.comparator)}(t),t.$a=!1,yield kD(t.remoteStore,!1)}})}function IO(n,e,t){return x(this,null,function*(){let r=H(n),i=[],o=[];for(let s of e){let a,l=r.Oa.get(s);if(l&&l.length!==0){a=yield vl(r.localStore,Xt(l[0]));for(let c of l){let d=r.xa.get(c),h=yield i8(r,d);h.snapshot&&o.push(h.snapshot)}}else{let c=yield B1(r.localStore,s);a=yield vl(r.localStore,c),yield MT(r,X1(c),s,!1,a.resumeToken)}i.push(a)}return r.Ma.R_(o),i})}function X1(n){return JO(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function l8(n){return function(t){return H(H(t).persistence).$i()}(H(n).localStore)}function u8(n,e,t,r){return x(this,null,function*(){let i=H(n);if(i.$a)return void F("SyncEngine","Ignoring unexpected query state notification.");let o=i.Oa.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{let s=yield U1(i.localStore,e1(o[0])),a=wd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",lt.EMPTY_BYTE_STRING);yield ui(i,s,a);break}case"rejected":yield wl(i.localStore,e,!0),Cl(i,e,r);break;default:W()}})}function c8(n,e,t){return x(this,null,function*(){let r=Pm(n);if(r.$a){for(let i of e){if(r.Oa.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){F("SyncEngine","Adding an already active target "+i);continue}let o=yield B1(r.localStore,i),s=yield vl(r.localStore,o);yield MT(r,X1(o),s.targetId,!1,s.resumeToken),Nm(r.remoteStore,s)}for(let i of t)r.Oa.has(i)&&(yield wl(r.localStore,i,!1).then(()=>{El(r.remoteStore,i),Cl(r,i)}).catch(so))}})}function Pm(n){let e=H(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Z1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=r8.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Z9.bind(null,e),e.Ma.R_=q9.bind(null,e.eventManager),e.Ma.Wa=G9.bind(null,e.eventManager),e}function PT(n){let e=H(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=J9.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=X9.bind(null,e),e}function d8(n,e,t){let r=H(n);(function(o,s,a){return x(this,null,function*(){try{let l=yield s.getMetadata();if(yield function(m,v){let D=H(m),S=at(v.createTime);return D.persistence.runTransaction("hasNewerBundle","readonly",P=>D.jr.getBundleMetadata(P,v.id)).then(P=>!!P&&P.createTime.compareTo(S)>=0)}(o.localStore,l))return yield s.close(),a._completeWith(function(m){return{taskState:"Success",documentsLoaded:m.totalDocuments,bytesLoaded:m.totalBytes,totalDocuments:m.totalDocuments,totalBytes:m.totalBytes}}(l)),Promise.resolve(new Set);a._updateProgress(Q1(l));let c=new BD(l,o.localStore,s.serializer),d=yield s.Ga();for(;d;){let g=yield c.Pa(d);g&&a._updateProgress(g),d=yield s.Ga()}let h=yield c.complete();return yield ui(o,h.da,void 0),yield function(m,v){let D=H(m);return D.persistence.runTransaction("Save bundle","readwrite",S=>D.jr.saveBundleMetadata(S,v))}(o.localStore,l),a._completeWith(h.progress),Promise.resolve(h.Ia)}catch(l){return Xn("SyncEngine",`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var kT=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return x(this,null,function*(){this.serializer=Vd(t.databaseInfo.databaseId),this.sharedClientState=this.za(t),this.persistence=this.ja(t),yield this.persistence.start(),this.localStore=this.Ha(t),this.gcScheduler=this.Ja(t,this.localStore),this.indexBackfillerScheduler=this.Ya(t,this.localStore)})}Ja(t,r){return null}Ya(t,r){return null}Ha(t){return F1(this.persistence,new im,t.initialUser,this.serializer)}ja(t){return new bd(nm.ei,this.serializer)}za(t){return new lm}terminate(){return x(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),GD=class extends kT{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,t){Y(this.persistence.referenceDelegate instanceof rm);let r=this.persistence.referenceDelegate.garbageCollector;return new Xg(r,e.asyncQueue,t)}ja(e){let t=this.cacheSizeBytes!==void 0?ln.withCacheSize(this.cacheSizeBytes):ln.DEFAULT;return new bd(r=>rm.ei(r,t),this.serializer)}},_m=class n extends kT{constructor(e,t,r){super(),this.Za=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return x(this,null,function*(){yield yy(n.prototype,this,"initialize").call(this,e),yield this.Za.initialize(this,e),yield PT(this.Za.syncEngine),yield Rl(this.Za.remoteStore),yield this.persistence.Si(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}Ha(e){return F1(this.persistence,new im,e.initialUser,this.serializer)}Ja(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new Xg(r,e.asyncQueue,t)}Ya(e,t){let r=new DC(t,this.persistence);return new CC(e.asyncQueue,r)}ja(e){let t=IT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?ln.withCacheSize(this.cacheSizeBytes):ln.DEFAULT;return new ED(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,H1(),Rg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}za(e){return new lm}},zD=class n extends _m{constructor(e,t){super(e,t,!1),this.Za=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return x(this,null,function*(){yield yy(n.prototype,this,"initialize").call(this,e);let t=this.Za.syncEngine;this.sharedClientState instanceof cd&&(this.sharedClientState.syncEngine={io:s8.bind(null,t),so:u8.bind(null,t),oo:c8.bind(null,t),$i:l8.bind(null,t),ro:o8.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.Si(r=>x(this,null,function*(){yield a8(this.Za.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}za(e){let t=H1();if(!cd.p(t))throw new k(N.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=IT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new cd(t,e.asyncQueue,r,e.clientId,e.initialUser)}},OT=(()=>{class n{initialize(t,r){return x(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>EO(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=n8.bind(null,this.syncEngine),yield kD(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new VD}()}createDatastore(t){let r=Vd(t.databaseInfo.databaseId),i=function(s){return new AD(s)}(t.databaseInfo);return function(s,a,l,c){return new xD(s,a,l,c)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,o,s,a,l){return new PD(i,o,s,a,l)}(this.localStore,this.datastore,t.asyncQueue,r=>EO(this.syncEngine,r,0),function(){return um.p()?new um:new bD}())}createSyncEngine(t,r){return function(o,s,a,l,c,d,h){let g=new HD(o,s,a,l,c,d);return h&&(g.$a=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return x(this,null,function*(){var t,r;yield function(o){return x(this,null,function*(){let s=H(o);F("RemoteStore","RemoteStore shutting down."),s.k_.add(5),yield Ml(s),s.Q_.shutdown(),s.K_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();function CO(n,e=10240){let t=0;return{read(){return x(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return x(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Dl=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):ot("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var WD=class{constructor(e,t){this.tu=e,this.serializer=t,this.metadata=new vt,this.buffer=new Uint8Array,this.nu=function(){return new TextDecoder("utf-8")}(),this.ru().then(r=>{r&&r.la()?this.metadata.resolve(r.ca.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.ca)}`))},r=>this.metadata.reject(r))}close(){return this.tu.cancel()}getMetadata(){return x(this,null,function*(){return this.metadata.promise})}Ga(){return x(this,null,function*(){return yield this.getMetadata(),this.ru()})}ru(){return x(this,null,function*(){let e=yield this.iu();if(e===null)return null;let t=this.nu.decode(e),r=Number(t);isNaN(r)&&this.su(`length string (${t}) is not valid number`);let i=yield this.ou(r);return new jD(JSON.parse(i),e.length+r)})}_u(){return this.buffer.findIndex(e=>e===123)}iu(){return x(this,null,function*(){for(;this._u()<0&&!(yield this.au()););if(this.buffer.length===0)return null;let e=this._u();e<0&&this.su("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}ou(e){return x(this,null,function*(){for(;this.buffer.length<e;)(yield this.au())&&this.su("Reached the end of bundle when more is expected.");let t=this.nu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}su(e){throw this.tu.cancel(),new Error(`Invalid bundle format: ${e}`)}au(){return x(this,null,function*(){let e=yield this.tu.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var KD=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return x(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new k(N.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,o){return x(this,null,function*(){let s=H(i),a={documents:o.map(h=>Id(s.serializer,h))},l=yield s.ko("BatchGetDocuments",s.serializer.databaseId,Me.emptyPath(),a,o.length),c=new Map;l.forEach(h=>{let g=y9(s.serializer,h);c.set(g.key.toString(),g)});let d=[];return o.forEach(h=>{let g=c.get(h.toString());Y(!!g),d.push(g)}),d})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new io(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return x(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=q.fromPath(r);this.mutations.push(new yd(i,this.precondition(i)))}),yield function(r,i){return x(this,null,function*(){let o=H(r),s={writes:i.map(a=>Cd(o.serializer,a))};yield o.Oo("Commit",o.serializer.databaseId,Me.emptyPath(),s)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw W();t=X.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new k(N.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(X.min())?rt.exists(!1):rt.updateTime(t):rt.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(X.min()))throw new k(N.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return rt.updateTime(t)}return rt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var QD=class{constructor(e,t,r,i,o){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=o,this.uu=r.maxAttempts,this.r_=new Ad(this.asyncQueue,"transaction_retry")}cu(){this.uu-=1,this.lu()}lu(){this.r_.jo(()=>x(this,null,function*(){let e=new KD(this.datastore),t=this.hu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Pu(i)}))}).catch(r=>{this.Pu(r)})}))}hu(e){try{let t=this.updateFunction(e);return!Pd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Pu(e){this.uu>0&&this.Tu(e)?(this.uu-=1,this.asyncQueue.enqueueAndForget(()=>(this.lu(),Promise.resolve()))):this.deferred.reject(e)}Tu(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!f1(t)}return!1}};var YD=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ft.UNAUTHENTICATED,this.clientId=Ng.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,s=>x(this,null,function*(){F("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(F("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new vt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>x(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Nl(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function hC(n,e){return x(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),F("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>x(this,null,function*(){r.isEqual(i)||(yield V1(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function DO(n,e){return x(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield FT(n);F("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>_O(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>_O(e.remoteStore,i)),n._onlineComponents=e})}function FT(n){return x(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){F("FirestoreClient","Using user provided OfflineComponentProvider");try{yield hC(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===N.FAILED_PRECONDITION||i.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Xn("Error using user provided cache. Falling back to memory cache: "+t),yield hC(n,new kT)}}else F("FirestoreClient","Using default OfflineComponentProvider"),yield hC(n,new GD(void 0));return n._offlineComponents})}function km(n){return x(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(F("FirestoreClient","Using user provided OnlineComponentProvider"),yield DO(n,n._uninitializedComponentsProvider._online)):(F("FirestoreClient","Using default OnlineComponentProvider"),yield DO(n,new OT))),n._onlineComponents})}function eF(n){return FT(n).then(e=>e.persistence)}function VT(n){return FT(n).then(e=>e.localStore)}function tF(n){return km(n).then(e=>e.remoteStore)}function LT(n){return km(n).then(e=>e.syncEngine)}function h8(n){return km(n).then(e=>e.datastore)}function Tl(n){return x(this,null,function*(){let e=yield km(n),t=e.eventManager;return t.onListen=z9.bind(null,e.syncEngine),t.onUnlisten=K9.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=W9.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Q9.bind(null,e.syncEngine),t})}function f8(n){return n.asyncQueue.enqueue(()=>x(this,null,function*(){let e=yield eF(n),t=yield tF(n);return e.setNetworkEnabled(!0),function(i){let o=H(i);return o.k_.delete(0),Ld(o)}(t)}))}function p8(n){return n.asyncQueue.enqueue(()=>x(this,null,function*(){let e=yield eF(n),t=yield tF(n);return e.setNetworkEnabled(!1),function(i){return x(this,null,function*(){let o=H(i);o.k_.add(0),yield Ml(o),o.K_.set("Offline")})}(t)}))}function g8(n,e){let t=new vt;return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,o,s){return x(this,null,function*(){try{let a=yield function(c,d){let h=H(c);return h.persistence.runTransaction("read document","readonly",g=>h.localDocuments.getDocument(g,d))}(i,o);a.isFoundDocument()?s.resolve(a):a.isNoDocument()?s.resolve(null):s.reject(new k(N.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let l=Nl(a,`Failed to get document '${o} from cache`);s.reject(l)}})}(yield VT(n),e,t)})),t.promise}function nF(n,e,t={}){let r=new vt;return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(o,s,a,l,c){let d=new Dl({next:g=>{d.eu(),s.enqueueAndForget(()=>ST(o,h));let m=g.docs.has(a);!m&&g.fromCache?c.reject(new k(N.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&g.fromCache&&l&&l.source==="server"?c.reject(new k(N.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(g)},error:g=>c.reject(g)}),h=new Md(Al(a.path),d,{includeMetadataChanges:!0,ua:!0});return bT(o,h)}(yield Tl(n),n.asyncQueue,e,t,r)})),r.promise}function m8(n,e){let t=new vt;return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,o,s){return x(this,null,function*(){try{let a=yield om(i,o,!0),l=new ym(o,a.Es),c=l.ga(a.documents),d=l.applyChanges(c,!1);s.resolve(d.snapshot)}catch(a){let l=Nl(a,`Failed to execute query '${o} against cache`);s.reject(l)}})}(yield VT(n),e,t)})),t.promise}function rF(n,e,t={}){let r=new vt;return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(o,s,a,l,c){let d=new Dl({next:g=>{d.eu(),s.enqueueAndForget(()=>ST(o,h)),g.fromCache&&l.source==="server"?c.reject(new k(N.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(g)},error:g=>c.reject(g)}),h=new Md(a,d,{includeMetadataChanges:!0,ua:!0});return bT(o,h)}(yield Tl(n),n.asyncQueue,e,t,r)})),r.promise}function y8(n,e){let t=new Dl(e);return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,o){H(i).X_.add(o),o.next()}(yield Tl(n),t)})),()=>{t.eu(),n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,o){H(i).X_.delete(o)}(yield Tl(n),t)}))}}function _8(n,e,t,r){let i=function(s,a){let l;return l=typeof s=="string"?g1().encode(s):s,function(d,h){return new WD(d,h)}(function(d,h){if(d instanceof Uint8Array)return CO(d,h);if(d instanceof ArrayBuffer)return CO(new Uint8Array(d),h);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),a)}(t,Vd(e));n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){d8(yield LT(n),i,r)}))}function v8(n,e){return n.asyncQueue.enqueue(()=>x(this,null,function*(){return function(r,i){let o=H(r);return o.persistence.runTransaction("Get named query","readonly",s=>o.jr.getNamedQuery(s,i))}(yield VT(n),e)}))}function iF(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var TO=new Map;function jT(n,e,t){if(!t)throw new k(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function BT(n,e,t,r){if(e===!0&&r===!0)throw new k(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function bO(n){if(!q.isDocumentKey(n))throw new k(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function SO(n){if(q.isDocumentKey(n))throw new k(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Om(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":W()}function Re(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new k(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Om(n);throw new k(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function oF(n,e){if(e<=0)throw new k(N.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var vm=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new k(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new k(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}BT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=iF((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new k(N.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new k(N.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new k(N.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},_s=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new vm({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new k(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new k(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new vm(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new fC;switch(r.type){case"firstParty":return new yC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new k(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return x(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=TO.get(t);r&&(F("ComponentProvider","Removing Datastore"),TO.delete(t),r.terminate())}(this),Promise.resolve()}};function sF(n,e,t,r={}){var i;let o=(n=Re(n,_s))._getSettings(),s=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==s&&Xn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=ft.MOCK_USER;else{a=sh(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new k(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new ft(c)}n._authCredentials=new pC(new xg(a,l))}}var xt=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},qe=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new br(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},br=class n extends xt{constructor(e,t,r){super(e,t,Al(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new qe(this.firestore,null,new q(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function UT(n,e,...t){if(n=we(n),jT("collection","path",e),n instanceof _s){let r=Me.fromString(e,...t);return SO(r),new br(n,null,r)}{if(!(n instanceof qe||n instanceof br))throw new k(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Me.fromString(e,...t));return SO(r),new br(n.firestore,null,r)}}function aF(n,e){if(n=Re(n,_s),jT("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new k(N.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new xt(n,null,function(r){return new er(Me.emptyPath(),r)}(e))}function jd(n,e,...t){if(n=we(n),arguments.length===1&&(e=Ng.newId()),jT("doc","path",e),n instanceof _s){let r=Me.fromString(e,...t);return bO(r),new qe(n,null,new q(r))}{if(!(n instanceof qe||n instanceof br))throw new k(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Me.fromString(e,...t));return bO(r),new qe(n.firestore,n instanceof br?n.converter:null,new q(r))}}function $T(n,e){return n=we(n),e=we(e),(n instanceof qe||n instanceof br)&&(e instanceof qe||e instanceof br)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function HT(n,e){return n=we(n),e=we(e),n instanceof xt&&e instanceof xt&&n.firestore===e.firestore&&Od(n._query,e._query)&&n.converter===e.converter}var wm=class{constructor(e=Promise.resolve()){this.Iu=[],this.du=!1,this.Eu=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new Ad(this,"async_queue_retry"),this.fu=()=>{let r=Rg();r&&F("AsyncQueue","Visibility state changed to "+r.visibilityState),this.r_.Jo()},this.gu=e;let t=Rg();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.du}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.du){this.du=!0,this.Vu=e||!1;let t=Rg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.du)return new Promise(()=>{});let t=new vt;return this.yu(()=>this.du&&this.Vu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}wu(){return x(this,null,function*(){if(this.Iu.length!==0){try{yield this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!ao(e))throw e;F("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}})}yu(e){let t=this.gu.then(()=>(this.Ru=!0,e().catch(r=>{this.Au=r,this.Ru=!1;let i=function(s){let a=s.message||"";return s.stack&&(a=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),a}(r);throw ot("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Ru=!1,r))));return this.gu=t,t}enqueueAfterDelay(e,t,r){this.pu(),this.mu.indexOf(e)>-1&&(t=0);let i=OD.createAndSchedule(this,e,t,r,o=>this.Su(o));return this.Eu.push(i),i}pu(){this.Au&&W()}verifyOperationInProgress(){}bu(){return x(this,null,function*(){let e;do e=this.gu,yield e;while(e!==this.gu)})}Du(e){for(let t of this.Eu)if(t.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.Eu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Eu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){let t=this.Eu.indexOf(e);this.Eu.splice(t,1)}};function ZD(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var JD=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new vt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var lF=-1,Xe=class extends _s{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new wm,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return x(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new wm(e),this._firestoreClient=void 0,yield e}})}};function Nt(n){if(n._terminated)throw new k(N.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||uF(n),n._firestoreClient}function uF(n){var e,t,r;let i=n._freezeSettings(),o=function(a,l,c,d){return new TC(a,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,iF(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new YD(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(a){let l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}}(n._componentsProvider))}function cF(n,e){Xn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return hF(n,OT.provider,{build:r=>new _m(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function dF(n){return x(this,null,function*(){Xn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();hF(n,OT.provider,{build:t=>new zD(t,e.cacheSizeBytes)})})}function hF(n,e,t){if((n=Re(n,Xe))._firestoreClient||n._terminated)throw new k(N.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new k(N.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},uF(n)}function fF(n){if(n._initialized&&!n._terminated)throw new k(N.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new vt;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>x(this,null,function*(){try{yield function(r){return x(this,null,function*(){if(!Zi.p())return Promise.resolve();let i=r+"main";yield Zi.delete(i)})}(IT(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function pF(n){return function(t){let r=new vt;return t.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return e8(yield LT(t),r)})),r.promise}(Nt(n=Re(n,Xe)))}function gF(n){return f8(Nt(n=Re(n,Xe)))}function mF(n){return p8(Nt(n=Re(n,Xe)))}function yF(n,e){let t=Nt(n=Re(n,Xe)),r=new JD;return _8(t,n._databaseId,e,r),r}function _F(n,e){return v8(Nt(n=Re(n,Xe)),e).then(t=>t?new xt(n,null,t.query):null)}var Mr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(lt.fromBase64String(e))}catch(t){throw new k(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(lt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var rr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new k(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new st(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ai=class{constructor(e){this._methodName=e}};var vs=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new k(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new k(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return le(this._lat,e._lat)||le(this._long,e._long)}};var Rd=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var w8=/^__.*__$/,XD=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new nr(e,this.data,this.fieldMask,t,this.fieldTransforms):new ro(e,this.data,t,this.fieldTransforms)}},Em=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new nr(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function vF(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W()}}var Im=class n{constructor(e,t,r,i,o,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.Fu(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.xu({path:r,Nu:!1});return i.Bu(e),i}Lu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.xu({path:r,Nu:!1});return i.Fu(),i}ku(e){return this.xu({path:void 0,Nu:!0})}qu(e){return Cm(e,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Fu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Bu(this.path.get(e))}Bu(e){if(e.length===0)throw this.qu("Document fields must not be empty");if(vF(this.Mu)&&w8.test(e))throw this.qu('Document fields cannot begin and end with "__"')}},eT=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Vd(e)}$u(e,t,r,i=!1){return new Im({Mu:e,methodName:t,Ku:r,path:st.emptyPath(),Nu:!1,Qu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Is(n){let e=n._freezeSettings(),t=Vd(n._databaseId);return new eT(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Fm(n,e,t,r,i,o={}){let s=n.$u(o.merge||o.mergeFields?2:0,e,t,i);zT("Data must be an object, but it was:",s,r);let a=IF(r,s),l,c;if(o.merge)l=new Dn(s.fieldMask),c=s.fieldTransforms;else if(o.mergeFields){let d=[];for(let h of o.mergeFields){let g=oT(e,h,t);if(!s.contains(g))throw new k(N.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);DF(d,g)||d.push(g)}l=new Dn(d),c=s.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=s.fieldTransforms;return new XD(new Bt(a),l,c)}var xd=class n extends ai{_toFieldTransform(e){if(e.Mu!==2)throw e.Mu===1?e.qu(`${this._methodName}() can only appear at the top level of your update data`):e.qu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function wF(n,e,t){return new Im({Mu:3,Ku:e.settings.Ku,methodName:n._methodName,Nu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var tT=class n extends ai{_toFieldTransform(e){return new gs(e.path,new to)}isEqual(e){return e instanceof n}},nT=class n extends ai{constructor(e,t){super(e),this.Uu=t}_toFieldTransform(e){let t=wF(this,e,!0),r=this.Uu.map(o=>Cs(o,t)),i=new oi(r);return new gs(e.path,i)}isEqual(e){return e instanceof n&&wy(this.Uu,e.Uu)}},rT=class n extends ai{constructor(e,t){super(e),this.Uu=t}_toFieldTransform(e){let t=wF(this,e,!0),r=this.Uu.map(o=>Cs(o,t)),i=new si(r);return new gs(e.path,i)}isEqual(e){return e instanceof n&&wy(this.Uu,e.Uu)}},iT=class n extends ai{constructor(e,t){super(e),this.Wu=t}_toFieldTransform(e){let t=new no(e.serializer,s1(e.serializer,this.Wu));return new gs(e.path,t)}isEqual(e){return e instanceof n&&this.Wu===e.Wu}};function qT(n,e,t,r){let i=n.$u(1,e,t);zT("Data must be an object, but it was:",i,r);let o=[],s=Bt.empty();lo(r,(l,c)=>{let d=WT(e,l,t);c=we(c);let h=i.Lu(d);if(c instanceof xd)o.push(d);else{let g=Cs(c,h);g!=null&&(o.push(d),s.set(d,g))}});let a=new Dn(o);return new Em(s,a,i.fieldTransforms)}function GT(n,e,t,r,i,o){let s=n.$u(1,e,t),a=[oT(e,r,t)],l=[i];if(o.length%2!=0)throw new k(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<o.length;g+=2)a.push(oT(e,o[g])),l.push(o[g+1]);let c=[],d=Bt.empty();for(let g=a.length-1;g>=0;--g)if(!DF(c,a[g])){let m=a[g],v=l[g];v=we(v);let D=s.Lu(m);if(v instanceof xd)c.push(m);else{let S=Cs(v,D);S!=null&&(c.push(m),d.set(m,S))}}let h=new Dn(c);return new Em(d,h,s.fieldTransforms)}function EF(n,e,t,r=!1){return Cs(t,n.$u(r?4:3,e))}function Cs(n,e){if(CF(n=we(n)))return zT("Unsupported field value:",e,n),IF(n,e);if(n instanceof ai)return function(r,i){if(!vF(i.Mu))throw i.qu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.qu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Nu&&e.Mu!==4)throw e.qu("Nested arrays are not supported");return function(r,i){let o=[],s=0;for(let a of r){let l=Cs(a,i.ku(s));l==null&&(l={nullValue:"NULL_VALUE"}),o.push(l),s++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=we(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return s1(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=Je.fromDate(r);return{timestampValue:ml(i.serializer,o)}}if(r instanceof Je){let o=new Je(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ml(i.serializer,o)}}if(r instanceof vs)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Mr)return{bytesValue:m1(i.serializer,r._byteString)};if(r instanceof qe){let o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.qu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:vT(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Rd)return function(s,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:s.toArray().map(l=>{if(typeof l!="number")throw a.qu("VectorValues must only contain numeric values.");return _T(a.serializer,l)})}}}}}}(r,i);throw i.qu(`Unsupported field value: ${Om(r)}`)}(n,e)}function IF(n,e){let t={};return $O(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lo(n,(r,i)=>{let o=Cs(i,e.Ou(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function CF(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Je||n instanceof vs||n instanceof Mr||n instanceof qe||n instanceof ai||n instanceof Rd)}function zT(n,e,t){if(!CF(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Om(t);throw r==="an object"?e.qu(n+" a custom object"):e.qu(n+" "+r)}}function oT(n,e,t){if((e=we(e))instanceof rr)return e._internalPath;if(typeof e=="string")return WT(n,e);throw Cm("Field path arguments must be of type string or ",n,!1,void 0,t)}var E8=new RegExp("[~\\*/\\[\\]]");function WT(n,e,t){if(e.search(E8)>=0)throw Cm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new rr(...e.split("."))._internalPath}catch{throw Cm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Cm(n,e,t,r,i){let o=r&&!r.isEmpty(),s=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(o||s)&&(l+=" (found",o&&(l+=` in field ${r}`),s&&(l+=` in document ${i}`),l+=")"),new k(N.INVALID_ARGUMENT,a+n+l)}function DF(n,e){return n.some(t=>t.isEqual(e))}var ws=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new qe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new sT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Vm("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},sT=class extends ws{data(){return super.data()}};function Vm(n,e){return typeof e=="string"?WT(n,e):e instanceof rr?e._internalPath:e._delegate._internalPath}function TF(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new k(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Nd=class{},Es=class extends Nd{};function ci(n,e,...t){let r=[];e instanceof Nd&&r.push(e),r=r.concat(t),function(o){let s=o.filter(l=>l instanceof aT).length,a=o.filter(l=>l instanceof Dm).length;if(s>1||s>0&&a>0)throw new k(N.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Dm=class n extends Es{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return OF(e._query,t),new xt(e.firestore,e.converter,LC(e._query,t))}_parse(e){let t=Is(e.firestore);return function(o,s,a,l,c,d,h){let g;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new k(N.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){MO(h,d);let m=[];for(let v of h)m.push(AO(l,o,v));g={arrayValue:{values:m}}}else g=AO(l,o,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||MO(h,d),g=EF(a,s,h,d==="in"||d==="not-in");return Ie.create(c,d,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function bF(n,e,t){let r=e,i=Vm("where",n);return Dm._create(i,r,t)}var aT=class n extends Nd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Fe.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let s=i,a=o.getFlattenedFilters();for(let l of a)OF(s,l),s=LC(s,l)}(e._query,t),new xt(e.firestore,e.converter,LC(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var lT=class n extends Es{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,o,s){if(i.startAt!==null)throw new k(N.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new k(N.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new fs(o,s)}(e._query,this._field,this._direction);return new xt(e.firestore,e.converter,function(i,o){let s=i.explicitOrderBy.concat([o]);return new er(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function SF(n,e="asc"){let t=e,r=Vm("orderBy",n);return lT._create(r,t)}var Tm=class n extends Es{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new xt(e.firestore,e.converter,$g(e._query,this._limit,this._limitType))}};function AF(n){return oF("limit",n),Tm._create("limit",n,"F")}function MF(n){return oF("limitToLast",n),Tm._create("limitToLast",n,"L")}var bm=class n extends Es{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=kF(e,this.type,this._docOrFields,this._inclusive);return new xt(e.firestore,e.converter,function(i,o){return new er(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)}(e._query,t))}};function RF(...n){return bm._create("startAt",n,!0)}function xF(...n){return bm._create("startAfter",n,!1)}var Sm=class n extends Es{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=kF(e,this.type,this._docOrFields,this._inclusive);return new xt(e.firestore,e.converter,function(i,o){return new er(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,o)}(e._query,t))}};function NF(...n){return Sm._create("endBefore",n,!1)}function PF(...n){return Sm._create("endAt",n,!0)}function kF(n,e,t,r){if(t[0]=we(t[0]),t[0]instanceof ws)return function(o,s,a,l,c){if(!l)throw new k(N.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of ll(o))if(h.field.isKeyField())d.push(hs(s,l.key));else{let g=l.data.field(h.field);if(Mm(g))throw new k(N.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){let m=h.field.canonicalString();throw new k(N.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${m}' (used as the orderBy) does not exist.`)}d.push(g)}return new Ar(d,c)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=Is(n.firestore);return function(s,a,l,c,d,h){let g=s.explicitOrderBy;if(d.length>g.length)throw new k(N.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let m=[];for(let v=0;v<d.length;v++){let D=d[v];if(g[v].field.isKeyField()){if(typeof D!="string")throw new k(N.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof D}`);if(!mT(s)&&D.indexOf("/")!==-1)throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${D}' contains a slash.`);let S=s.path.child(Me.fromString(D));if(!q.isDocumentKey(S))throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${S}' is not because it contains an odd number of segments.`);let P=new q(S);m.push(hs(a,P))}else{let S=EF(l,c,D);m.push(S)}}return new Ar(m,h)}(n._query,n.firestore._databaseId,i,e,t,r)}}function AO(n,e,t){if(typeof(t=we(t))=="string"){if(t==="")throw new k(N.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!mT(e)&&t.indexOf("/")!==-1)throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(Me.fromString(t));if(!q.isDocumentKey(r))throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return hs(n,new q(r))}if(t instanceof qe)return hs(n,t._key);throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Om(t)}.`)}function MO(n,e){if(!Array.isArray(n)||n.length===0)throw new k(N.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function OF(n,e){let t=function(i,o){for(let s of i)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new k(N.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new k(N.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var bl=class{convertValue(e,t="none"){switch(Xi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Qe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ii(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw W()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return lo(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(s=>Qe(s.doubleValue));return new Rd(o)}convertGeoPoint(e){return new vs(Qe(e.latitude),Qe(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Rm(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(pd(e));default:return null}}convertTimestamp(e){let t=ri(e);return new Je(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Me.fromString(e);Y(S1(r));let i=new Ji(r.get(1),r.get(3)),o=new q(r.popFirst(5));return i.isEqual(t)||ot(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function Lm(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var uT=class extends bl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new qe(this.firestore,null,t)}};var ni=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Bn=class extends ws{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Qi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Vm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Qi=class extends Bn{data(e={}){return super.data(e)}},ir=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new ni(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Qi(this._firestore,this._userDataWriter,r.key,r,new ni(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new k(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{let l=new Qi(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ni(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let l=new Qi(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ni(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),c=-1,d=-1;return a.type!==0&&(c=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),d=s.indexOf(a.doc.key)),{type:I8(a.type),doc:l,oldIndex:c,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function I8(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return W()}}function KT(n,e){return n instanceof Bn&&e instanceof Bn?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof ir&&e instanceof ir&&n._firestore===e._firestore&&HT(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function FF(n){n=Re(n,qe);let e=Re(n.firestore,Xe);return nF(Nt(e),n._key).then(t=>JT(e,n,t))}var li=class extends bl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new qe(this.firestore,null,t)}};function VF(n){n=Re(n,qe);let e=Re(n.firestore,Xe),t=Nt(e),r=new li(e);return g8(t,n._key).then(i=>new Bn(e,r,n._key,i,new ni(i!==null&&i.hasLocalMutations,!0),n.converter))}function LF(n){n=Re(n,qe);let e=Re(n.firestore,Xe);return nF(Nt(e),n._key,{source:"server"}).then(t=>JT(e,n,t))}function jF(n){n=Re(n,xt);let e=Re(n.firestore,Xe),t=Nt(e),r=new li(e);return TF(n._query),rF(t,n._query).then(i=>new ir(e,r,n,i))}function BF(n){n=Re(n,xt);let e=Re(n.firestore,Xe),t=Nt(e),r=new li(e);return m8(t,n._query).then(i=>new ir(e,r,n,i))}function UF(n){n=Re(n,xt);let e=Re(n.firestore,Xe),t=Nt(e),r=new li(e);return rF(t,n._query,{source:"server"}).then(i=>new ir(e,r,n,i))}function QT(n,e,t){n=Re(n,qe);let r=Re(n.firestore,Xe),i=Lm(n.converter,e,t);return Pl(r,[Fm(Is(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,rt.none())])}function YT(n,e,t,...r){n=Re(n,qe);let i=Re(n.firestore,Xe),o=Is(i),s;return s=typeof(e=we(e))=="string"||e instanceof rr?GT(o,"updateDoc",n._key,e,t,r):qT(o,"updateDoc",n._key,e),Pl(i,[s.toMutation(n._key,rt.exists(!0))])}function $F(n){return Pl(Re(n.firestore,Xe),[new io(n._key,rt.none())])}function HF(n,e){let t=Re(n.firestore,Xe),r=jd(n),i=Lm(n.converter,e);return Pl(t,[Fm(Is(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,rt.exists(!1))]).then(()=>r)}function ZT(n,...e){var t,r,i;n=we(n);let o={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||ZD(e[s])||(o=e[s],s++);let a={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(ZD(e[s])){let h=e[s];e[s]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[s+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[s+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let l,c,d;if(n instanceof qe)c=Re(n.firestore,Xe),d=Al(n._key.path),l={next:h=>{e[s]&&e[s](JT(c,n,h))},error:e[s+1],complete:e[s+2]};else{let h=Re(n,xt);c=Re(h.firestore,Xe),d=h._query;let g=new li(c);l={next:m=>{e[s]&&e[s](new ir(c,g,h,m))},error:e[s+1],complete:e[s+2]},TF(n._query)}return function(g,m,v,D){let S=new Dl(D),P=new Md(m,S,v);return g.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return bT(yield Tl(g),P)})),()=>{S.eu(),g.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return ST(yield Tl(g),P)}))}}(Nt(c),d,a,l)}function qF(n,e){return y8(Nt(n=Re(n,Xe)),ZD(e)?e:{next:e})}function Pl(n,e){return function(r,i){let o=new vt;return r.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return Y9(yield LT(r),i,o)})),o.promise}(Nt(n),e)}function JT(n,e,t){let r=t.docs.get(e._key),i=new li(n);return new Bn(n,i,e._key,r,new ni(t.hasPendingWrites,t.fromCache),e.converter)}var C8={maxAttempts:5};var Am=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Is(e)}set(e,t,r){this._verifyNotCommitted();let i=Wi(e,this._firestore),o=Lm(i.converter,t,r),s=Fm(this._dataReader,"WriteBatch.set",i._key,o,i.converter!==null,r);return this._mutations.push(s.toMutation(i._key,rt.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let o=Wi(e,this._firestore),s;return s=typeof(t=we(t))=="string"||t instanceof rr?GT(this._dataReader,"WriteBatch.update",o._key,t,r,i):qT(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(s.toMutation(o._key,rt.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Wi(e,this._firestore);return this._mutations=this._mutations.concat(new io(t._key,rt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new k(N.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Wi(n,e){if((n=we(n)).firestore!==e)throw new k(N.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var cT=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Is(t)}get(t){let r=Wi(t,this._firestore),i=new uT(this._firestore);return this._transaction.lookup([r._key]).then(o=>{if(!o||o.length!==1)return W();let s=o[0];if(s.isFoundDocument())return new ws(this._firestore,i,s.key,s,r.converter);if(s.isNoDocument())return new ws(this._firestore,i,r._key,null,r.converter);throw W()})}set(t,r,i){let o=Wi(t,this._firestore),s=Lm(o.converter,r,i),a=Fm(this._dataReader,"Transaction.set",o._key,s,o.converter!==null,i);return this._transaction.set(o._key,a),this}update(t,r,i,...o){let s=Wi(t,this._firestore),a;return a=typeof(r=we(r))=="string"||r instanceof rr?GT(this._dataReader,"Transaction.update",s._key,r,i,o):qT(this._dataReader,"Transaction.update",s._key,r),this._transaction.update(s._key,a),this}delete(t){let r=Wi(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Wi(e,this._firestore),r=new li(this._firestore);return super.get(e).then(i=>new Bn(this._firestore,r,t._key,i._document,new ni(!1,!1),t.converter))}};function GF(n,e,t){n=Re(n,Xe);let r=Object.assign(Object.assign({},C8),t);return function(o){if(o.maxAttempts<1)throw new k(N.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(o,s,a){let l=new vt;return o.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){let c=yield h8(o);new QD(o.asyncQueue,c,a,s,l).cu()})),l.promise}(Nt(n),i=>e(new cT(n,i)),r)}function zF(){return new xd("deleteField")}function WF(){return new tT("serverTimestamp")}function KF(...n){return new nT("arrayUnion",n)}function QF(...n){return new rT("arrayRemove",n)}function YF(n){return new iT("increment",n)}(function(e,t=!0){(function(i){Sl=i})(dh),go(new dn("firestore",(r,{instanceIdentifier:i,options:o})=>{let s=r.getProvider("app").getImmediate(),a=new Xe(new gC(r.getProvider("auth-internal")),new vC(r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new k(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ji(c.options.projectId,d)}(s,i),s);return o=Object.assign({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),$n(Ak,"4.7.6",e),$n(Ak,"4.7.6","esm2017")})();var D8="@firebase/firestore-compat",T8="0.3.41";function ib(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new k("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function ZF(){if(typeof Uint8Array>"u")throw new k("unimplemented","Uint8Arrays are not available in this environment.")}function JF(){if(!HO())throw new k("unimplemented","Blobs are unavailable in Firestore in this environment.")}var jm=class n{constructor(e){this._delegate=e}static fromBase64String(e){return JF(),new n(Mr.fromBase64String(e))}static fromUint8Array(e){return ZF(),new n(Mr.fromUint8Array(e))}toBase64(){return JF(),this._delegate.toBase64()}toUint8Array(){return ZF(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function XT(n){return b8(n,["next","error","complete"])}function b8(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var eb=class{enableIndexedDbPersistence(e,t){return cF(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return dF(e._delegate)}clearIndexedDbPersistence(e){return fF(e._delegate)}},Bm=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Ji||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Xn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){sF(this._delegate,e,t,r)}enableNetwork(){return gF(this._delegate)}disableNetwork(){return mF(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,BT("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return pF(this._delegate)}onSnapshotsInSync(e){return qF(this._delegate,e)}get app(){if(!this._appCompat)throw new k("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Fl(this,UT(this._delegate,e))}catch(t){throw en(t,"collection()","Firestore.collection()")}}doc(e){try{return new Rr(this,jd(this._delegate,e))}catch(t){throw en(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Ss(this,aF(this._delegate,e))}catch(t){throw en(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return GF(this._delegate,t=>e(new Um(this,t)))}batch(){return Nt(this._delegate),new $m(new Am(this._delegate,e=>Pl(this._delegate,e)))}loadBundle(e){return yF(this._delegate,e)}namedQuery(e){return _F(this._delegate,e).then(t=>t?new Ss(this,t):null)}},kl=class extends bl{constructor(e){super(),this.firestore=e}convertBytes(e){return new jm(new Mr(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Rr.forKey(t,this.firestore,null)}};function S8(n){RO(n)}var Um=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new kl(e)}get(e){let t=Ds(e);return this._delegate.get(t).then(r=>new Ts(this._firestore,new Bn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=Ds(e);return r?(ib("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let o=Ds(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){let t=Ds(e);return this._delegate.delete(t),this}},$m=class{constructor(e){this._delegate=e}set(e,t,r){let i=Ds(e);return r?(ib("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let o=Ds(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){let t=Ds(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Ol=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new Qi(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new bs(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let o=i.get(t);return o||(o=new n(e,new kl(e),t),i.set(t,o)),o}};Ol.INSTANCES=new WeakMap;var Rr=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new kl(e)}static forPath(e,t,r){if(e.length%2!==0)throw new k("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new qe(t._delegate,r,new q(e)))}static forKey(e,t,r){return new n(t,new qe(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Fl(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Fl(this.firestore,UT(this._delegate,e))}catch(t){throw en(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=we(e),e instanceof qe?$T(this._delegate,e):!1}set(e,t){t=ib("DocumentReference.set",t);try{return t?QT(this._delegate,e,t):QT(this._delegate,e)}catch(r){throw en(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?YT(this._delegate,e):YT(this._delegate,e,t,...r)}catch(i){throw en(i,"updateDoc()","DocumentReference.update()")}}delete(){return $F(this._delegate)}onSnapshot(...e){let t=XF(e),r=eV(e,i=>new Ts(this.firestore,new Bn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return ZT(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=VF(this._delegate):e?.source==="server"?t=LF(this._delegate):t=FF(this._delegate),t.then(r=>new Ts(this.firestore,new Bn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ol.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function en(n,e,t){return n.message=n.message.replace(e,t),n}function XF(n){for(let e of n)if(typeof e=="object"&&!XT(e))return e;return{}}function eV(n,e){var t,r;let i;return XT(n[0])?i=n[0]:XT(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:o=>{i.next&&i.next(e(o))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Ts=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Rr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return KT(this._delegate,e._delegate)}},bs=class extends Ts{data(e){let t=this._delegate.data(e);return this._delegate._converter||xO(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Ss=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new kl(e)}where(e,t,r){try{return new n(this.firestore,ci(this._delegate,bF(e,t,r)))}catch(i){throw en(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,ci(this._delegate,SF(e,t)))}catch(r){throw en(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,ci(this._delegate,AF(e)))}catch(t){throw en(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,ci(this._delegate,MF(e)))}catch(t){throw en(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,ci(this._delegate,RF(...e)))}catch(t){throw en(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,ci(this._delegate,xF(...e)))}catch(t){throw en(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,ci(this._delegate,NF(...e)))}catch(t){throw en(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,ci(this._delegate,PF(...e)))}catch(t){throw en(t,"endAt()","Query.endAt()")}}isEqual(e){return HT(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=BF(this._delegate):e?.source==="server"?t=UF(this._delegate):t=jF(this._delegate),t.then(r=>new Bd(this.firestore,new ir(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=XF(e),r=eV(e,i=>new Bd(this.firestore,new ir(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return ZT(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ol.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},tb=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new bs(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Bd=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Ss(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new bs(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new tb(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new bs(this._firestore,r))})}isEqual(e){return KT(this._delegate,e._delegate)}},Fl=class n extends Ss{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Rr(this.firestore,e):null}doc(e){try{return e===void 0?new Rr(this.firestore,jd(this._delegate)):new Rr(this.firestore,jd(this._delegate,e))}catch(t){throw en(t,"doc()","CollectionReference.doc()")}}add(e){return HF(this._delegate,e).then(t=>new Rr(this.firestore,t))}isEqual(e){return $T(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ol.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Ds(n){return Re(n,qe)}var nb=class n{constructor(...e){this._delegate=new rr(...e)}static documentId(){return new n(st.keyField().canonicalString())}isEqual(e){return e=we(e),e instanceof rr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var rb=class n{static serverTimestamp(){let e=WF();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=zF();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=KF(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=QF(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=YF(e);return t._methodName="FieldValue.increment",new n(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}};var A8={Firestore:Bm,GeoPoint:vs,Timestamp:Je,Blob:jm,Transaction:Um,WriteBatch:$m,DocumentReference:Rr,DocumentSnapshot:Ts,Query:Ss,QueryDocumentSnapshot:bs,QuerySnapshot:Bd,CollectionReference:Fl,FieldPath:nb,FieldValue:rb,setLogLevel:S8,CACHE_SIZE_UNLIMITED:lF};function M8(n,e){n.INTERNAL.registerComponent(new dn("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},A8)))}function R8(n){M8(n,(e,t)=>new Bm(e,t,new eb)),n.registerVersion(D8,T8)}R8(Tt);function x8(n,e=wo){return new de(t=>{let r;return e!=null?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}function tV(n,e){return x8(n,e)}function N8(n,e){return tV(n,e).pipe(Eo(void 0),fu(),J(t=>{let[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function ab(n,e){return tV(n,e).pipe(J(t=>({payload:t,type:"query"})))}var Hm=class{ref;afs;injector=V(it);constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let r=this.ref.collection(e),{ref:i,query:o}=iV(r,t);return new Gm(i,o,this.afs)}snapshotChanges(){return N8(this.ref,this.afs.schedulers.outsideAngular).pipe(nt(this.injector))}valueChanges(e={}){return this.snapshotChanges().pipe(J(({payload:t})=>e.idField?pe($({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return ke(this.ref.get(e)).pipe(nt(this.injector))}};function qm(n,e){return ab(n,e).pipe(Eo(void 0),fu(),J(t=>{let[r,i]=t,o=i.payload.docChanges(),s=o.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,l)=>{let c=o.find(h=>h.doc.ref.isEqual(a.ref)),d=r?.payload.docs.find(h=>h.ref.isEqual(a.ref));c&&JSON.stringify(c.doc.metadata)===JSON.stringify(a.metadata)||!c&&d&&JSON.stringify(d.metadata)===JSON.stringify(a.metadata)||s.push({type:"modified",payload:{oldIndex:l,newIndex:l,type:"modified",doc:a}})}),s}))}function nV(n,e,t){return qm(n,t).pipe(lr((r,i)=>P8(r,i.map(o=>o.payload),e),[]),du(),J(r=>r.map(i=>({type:i.type,payload:i}))))}function P8(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=k8(n,r))}),n}function ob(n,e,t,...r){let i=n.slice();return i.splice(e,t,...r),i}function k8(n,e){switch(e.type){case"added":if(!n[e.newIndex]?.doc.ref.isEqual(e.doc.ref))return ob(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return ob(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]?.doc.ref.isEqual(e.doc.ref))return ob(n,e.oldIndex,1);break}return n}function rV(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var Gm=class{ref;query;afs;injector=V(it);constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=qm(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(J(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(Eo(void 0),fu(),Vt(([r,i])=>i.length>0||!r),J(([,r])=>r),nt(this.injector))}auditTrail(e){return this.stateChanges(e).pipe(lr((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=rV(e);return nV(this.query,t,this.afs.schedulers.outsideAngular).pipe(nt(this.injector))}valueChanges(e={}){return ab(this.query,this.afs.schedulers.outsideAngular).pipe(J(t=>t.payload.docs.map(r=>e.idField?pe($({},r.data()),{[e.idField]:r.id}):r.data())),nt(this.injector))}get(e){return ke(this.query.get(e)).pipe(nt(this.injector))}add(e){return this.ref.add(e)}doc(e){return new Hm(this.ref.doc(e),this.afs)}},sb=class{query;afs;injector=V(it);constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?qm(this.query,this.afs.schedulers.outsideAngular).pipe(nt(this.injector)):qm(this.query,this.afs.schedulers.outsideAngular).pipe(J(t=>t.filter(r=>e.indexOf(r.type)>-1)),Vt(t=>t.length>0),nt(this.injector))}auditTrail(e){return this.stateChanges(e).pipe(lr((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=rV(e);return nV(this.query,t,this.afs.schedulers.outsideAngular).pipe(nt(this.injector))}valueChanges(e={}){return ab(this.query,this.afs.schedulers.outsideAngular).pipe(J(r=>r.payload.docs.map(i=>e.idField?$({[e.idField]:i.id},i.data()):i.data())),nt(this.injector))}get(e){return ke(this.query.get(e)).pipe(nt(this.injector))}},O8=new Q("angularfire2.enableFirestorePersistence"),F8=new Q("angularfire2.firestore.persistenceSettings"),V8=new Q("angularfire2.firestore.settings"),L8=new Q("angularfire2.firestore.use-emulator");function iV(n,e=t=>t){return{query:e(n),ref:n}}var oV=(()=>{class n{schedulers;firestore;persistenceEnabled$;ngZone=V(Se);constructor(t,r,i,o,s,a,l,c,d,h,g,m,v,D,S,P,j){this.schedulers=l;let O=Ko(t,a,r),K=d;h&&_c(O,a,g,v,D,S,m,P),[this.firestore,this.persistenceEnabled$]=Na(`${O.name}.firestore`,"AngularFirestore",O.name,()=>{let ie=a.runOutsideAngular(()=>O.firestore());if(o&&ie.settings(o),K&&ie.useEmulator(...K),i&&!$o(s)){let ee=()=>{try{return ke(ie.enablePersistence(c||void 0).then(()=>!0,()=>!1))}catch(I){return typeof console<"u"&&console.warn(I),re(!1)}};return[ie,a.runOutsideAngular(ee)]}else return[ie,re(!1)]},[o,K,i])}collection(t,r){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:o,query:s}=iV(i,r),a=this.ngZone.run(()=>o);return new Gm(a,s,this)}collectionGroup(t,r){let i=r||(s=>s),o=this.firestore.collectionGroup(t);return new sb(i(o),this)}doc(t){let r;typeof t=="string"?r=this.firestore.doc(t):r=t;let i=this.ngZone.run(()=>r);return new Hm(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)(B(Pi),B(ki,8),B(O8,8),B(V8,8),B(sn),B(Se),B(Wo),B(F8,8),B(L8,8),B(vc,8),B(hc,8),B(fc,8),B(pc,8),B(gc,8),B(mc,8),B(yc,8),B(Ni,8))};static \u0275prov=te({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var sV={apiKey:"AIzaSyAgzLE6J3CGJM-PgSRFhp5hFsvnY8mymug",authDomain:"iot-multiparameter.firebaseapp.com",databaseURL:"https://iot-multiparameter-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"iot-multiparameter",storageBucket:"iot-multiparameter.appspot.com",messagingSenderId:"773940000383",appId:"1:773940000383:web:0be13598bc82c0d522f14a",measurementId:"G-DSZ9883T5H"};var aV={providers:[lx(Tk),ov([Jx.initializeApp(sV),Xx,yg,oV])]};var lV=(()=>{class n{constructor(){this.title="electrical-load-Monitoring"}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=ga({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(r,i){r&1&&Fo(0,"router-outlet")},dependencies:[Vu,jw],encapsulation:2})}}return n})();DR(lV,aV).catch(n=>console.error(n));
